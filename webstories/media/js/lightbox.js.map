{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./packages/stories-lightbox/src/index.js","webpack:///./packages/stories-lightbox/src/web-stories-lightbox.js","webpack:///external [\"wp\",\"domReady\"]"],"names":["domReady","initializeWebStoryLightbox","Lightbox","constructor","wrapperDiv","lightboxInitialized","instanceId","dataset","id","lightboxElement","document","querySelector","player","isReady","initializeLightbox","addEventListener","rewind","pause","mute","classList","toggle","body","stories","getStories","bindStoryClickListeners","cards","querySelectorAll","forEach","card","event","preventDefault","storyObject","find","story","href","show","play","webStoryBlocks","getElementsByClassName","Array","from","webStoryBlock"],"mappings":"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","file":"lightbox.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"../media/com_webstories/js/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./packages/stories-lightbox/src/index.js\");\n","/*\n * Copyright 2021 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * WordPress dependencies\n */\nimport domReady from '@wordpress/dom-ready';\n\n/**\n * Internal dependencies\n */\nimport initializeWebStoryLightbox from './web-stories-lightbox';\n\ndomReady(() => {\n  initializeWebStoryLightbox();\n});\n","/*\n * Copyright 2021 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Handles the 'amp-story-player' lightbox.\n *\n * Displays the story that user interacted with in a lightbox.\n */\nclass Lightbox {\n  constructor(wrapperDiv) {\n    if ('undefined' === typeof wrapperDiv) {\n      return;\n    }\n\n    this.lightboxInitialized = false;\n    this.wrapperDiv = wrapperDiv;\n    this.instanceId = this.wrapperDiv.dataset.id;\n    this.lightboxElement = document.querySelector(\n      `.ws-lightbox-${this.instanceId} .web-stories-list__lightbox`\n    );\n    this.player = this.lightboxElement.querySelector('amp-story-player');\n\n    if (\n      'undefined' === typeof this.player ||\n      'undefined' === typeof this.lightboxElement\n    ) {\n      return;\n    }\n\n    if (this.player.isReady && !this.lightboxInitialized) {\n      this.initializeLightbox();\n    }\n\n    this.player.addEventListener('ready', () => {\n      if (!this.lightboxInitialized) {\n        this.initializeLightbox();\n      }\n    });\n\n    // Event triggered when user clicks on close (X) button.\n    this.player.addEventListener('amp-story-player-close', () => {\n      // Rewind the story and pause there upon closing the lightbox.\n      this.player.rewind();\n      this.player.pause();\n      this.player.mute();\n      this.lightboxElement.classList.toggle('show');\n      document.body.classList.toggle('web-stories-lightbox-open');\n    });\n  }\n\n  initializeLightbox() {\n    this.stories = this.player.getStories();\n    this.bindStoryClickListeners();\n    this.lightboxInitialized = true;\n  }\n\n  bindStoryClickListeners() {\n    const cards = this.wrapperDiv.querySelectorAll('.web-stories-list__story');\n\n    cards.forEach((card) => {\n      card.addEventListener('click', (event) => {\n        event.preventDefault();\n        const storyObject = this.stories.find(\n          (story) => story.href === card.querySelector('a').href\n        );\n        this.player.show(storyObject.href);\n        this.player.play();\n        this.lightboxElement.classList.toggle('show');\n        document.body.classList.toggle('web-stories-lightbox-open');\n      });\n    });\n  }\n}\n\nexport default function initializeWebStoryLightbox() {\n  const webStoryBlocks = document.getElementsByClassName('web-stories-list');\n  if ('undefined' !== typeof webStoryBlocks) {\n    Array.from(webStoryBlocks).forEach((webStoryBlock) => {\n      /* eslint-disable-next-line no-new -- we do not store the object as no further computation required. */\n      new Lightbox(webStoryBlock);\n    });\n  }\n}\n","(function() { module.exports = window[\"wp\"][\"domReady\"]; }());"],"sourceRoot":""}