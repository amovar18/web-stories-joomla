"use strict";(globalThis.webpackChunkweb_stories_joomla=globalThis.webpackChunkweb_stories_joomla||[]).push([[851,4e3],{61592:(e,t,a)=>{a.d(t,{default:()=>OutputStory});var n=a(67294),r=(a(46345),a(800)),o=a(65248),i=a(95330),l=a(65668),s=a(4707),u=a(15873);function OutputStory(e){let{story:{featuredMedia:t,link:a,title:c,autoAdvance:d,defaultPageDuration:m,backgroundAudio:p,publisherLogo:f},pages:g,metadata:{publisher:h},flags:E}=e;const _=(0,r.default)(g),b=(0,u.default)(g),T=t?.url||"",S=f?.url||"";return n.createElement("html",{amp:"",lang:"en"},n.createElement("head",null,n.createElement("meta",{charSet:"utf-8"}),n.createElement("meta",{name:"viewport",content:"width=device-width,minimum-scale=1,initial-scale=1"}),_.map((e=>{let{name:t,src:a}=e;return n.createElement("script",{key:a,async:"async",src:a,"custom-element":t})})),n.createElement(l.default,{pages:g}),b.map((e=>{let{url:t,type:a}=e;return n.createElement("link",{key:t,href:t,rel:"preload",as:a})})),n.createElement(o.default,null),n.createElement(i.default,null),n.createElement("meta",{name:"web-stories-replace-head-start"}),n.createElement("title",null,c),a&&n.createElement("link",{rel:"canonical",href:a}),n.createElement("meta",{name:"web-stories-replace-head-end"})),n.createElement("body",null,n.createElement("amp-story",{standalone:"",publisher:h,"publisher-logo-src":S,title:c,"poster-portrait-src":T,"background-audio":p?.resource?.src??void 0},g.map((e=>n.createElement(s.default,{key:e.id,page:e,autoAdvance:d,defaultPageDuration:m,flags:E}))))))}},60520:(e,t,a)=>{a.d(t,{default:()=>i});var n=a(67294),r=a(35343),o=a(61592);function i(e,t,a){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return(0,r.renderToStaticMarkup)(n.createElement(o.default,{story:e,pages:t,metadata:a,flags:i}))}},2380:(e,t,a)=>{a.d(t,{default:()=>APIProvider});var n=a(67294),r=a(35343),o=a(54e3),i=(a(28377),a(97506)),l=a(40823);function APIProvider(e){let{children:t}=e;const{apiCallbacks:a,cdnURL:s}=(0,i.default)(),u=(0,r.useRef)({base:[]});return a.getPageTemplates=(0,r.useCallback)((async()=>(0===u.current.base.length&&(u.current.base=await(0,o.getAllTemplates)({cdnURL:s})),u.current.base)),[s]),n.createElement(l.default.Provider,{value:{actions:a}},t)}},52054:(e,t,a)=>{a.d(t,{default:()=>ConfigProvider});var n=a(67294),r=a(28377);function ConfigProvider(e){let{config:t,children:a}=e;return n.createElement(r.default.Provider,{value:t},a)}},20653:(e,t,a)=>{a.d(t,{default:()=>CurrentUserProvider});var n=a(67294),r=a(35343),o=(a(54e3),a(28377),a(40823),a(47390)),i=a(7377);function CurrentUserProvider(e){let{children:t}=e;const[a,l]=(0,r.useState)({}),{actions:{getCurrentUser:s,updateCurrentUser:u}}=(0,o.default)();(0,r.useEffect)((()=>{let e=!0;return s&&!Object.keys(a).length&&s().then((t=>{e&&l(t)})),()=>{e=!1}}),[a,s]);const c=(0,r.useCallback)((e=>u?u(e).then(l):null),[u]),d=(0,r.useCallback)((()=>c({mediaOptimization:!a.mediaOptimization})),[a,c]),m={state:{currentUser:a},actions:{toggleWebStoriesMediaOptimization:d,updateCurrentUser:c}};return n.createElement(i.default.Provider,{value:m},t)}},94645:(e,t,a)=>{a.d(t,{default:()=>o});var n=a(35343),r=a(7377);function o(e){return(0,n.useContextSelector)(r.default,e??n.identity)}},46340:(e,t,a)=>{a.d(t,{default:()=>s});var n=a(35343),r=a(52154),o=a(92041),i=a(19040),l=a(7328);function s(){const e=(0,n.useCallback)((async e=>{const{family:t,service:a,variants:n,url:s}=e,u=`web-stories-${(0,l.default)(t)}-font-css`;if(!document.getElementById(u))switch(a){case"fonts.google.com":await(0,i.loadStylesheet)((0,r.default)([{family:t,variants:n}],"auto"),u);break;case"custom":await(0,i.loadInlineStylesheet)(u,(0,o.default)(t,s));break;default:return}}),[]);return{maybeEnqueueFontStyle:(0,n.useCallback)((t=>Promise.allSettled(t.map((async t=>{let{font:a,fontWeight:n,fontStyle:r,content:o}=t;const{family:l,service:s}=a;if(!l||"system"===s)return null;const u=`\n              ${r||""} ${n||""} 0 '${l}'\n            `.trim();return await e(a),(0,i.ensureFontLoaded)(u,o)})))),[e]),maybeLoadFont:e}}},67651:(e,t,a)=>{a.d(t,{styles:()=>r});var n=a(37070);a(35343),a(96426),a(67294),a(89157),a(29184),a(70746),a(60211),a(13851),a(46345),a(76129),a(11606),a(54e3),a(28377),a(40823),a(40169),a(89703),a(37890),a(30738),a(50067),a(28410),a(24763),a(21303),a(34639),a(60811),a(6687),a(9730);const r={OUTLINE:n.OUTLINE,FLASH:n.FLASH}},96548:(e,t,a)=>{a.d(t,{default:()=>o});var n=a(35343),r=a(16243);function o(e){return(0,n.useContextSelector)(r.default,e??n.identity)}},40884:(e,t,a)=>{a.d(t,{default:()=>o});var n=a(35343),r=a(32696);function o(e){return(0,n.useContextSelector)(r.default,e??n.identity)}},93902:(e,t,a)=>{a.d(t,{default:()=>StoryProvider});var n=a(67294),r=a(35343),o=a(51517),i=a(76129),l=a(76728),s=a(37890),u=a(95276),c=a(71877),d=a(47121),m=a(50067),p=a(19321),f=a(24763);a(21303),a(34639);function StoryProvider(e){let{storyId:t,initialEdits:a,children:g}=e;const[h,E]=(0,u.default)("page",null),{state:_,api:b,internal:{restore:T}}=(0,m.default)({current:h}),{pages:S,current:y,selection:C,story:I,animationState:w,capabilities:v,copiedElementState:P}=_;(0,r.useEffect)((()=>E(y)),[y,E]);let A=null,k=null,L=null,N=null;y&&(A=y,k=S.findIndex((e=>{let{id:t}=e;return t===y})),L=k+1,N=S[k]);const x=(0,r.useMemo)((()=>C.length>0?C:o.STABLE_ARRAY),[C]),O=!N,M=N?.elements,R=(0,r.useMemo)((()=>{if(O)return o.STABLE_ARRAY;const e=M.filter((e=>{let{id:t}=e;return C.includes(t)}));return e.length>0?e:o.STABLE_ARRAY}),[O,M,C]),B=N?.animations,D=(0,r.useMemo)((()=>{if(O)return o.STABLE_ARRAY;const e=(B||[]).reduce(((e,t)=>{let{targets:a,...n}=t;return a.some((e=>C.includes(e)))?[...e,{targets:a,...n}]:e}),[]);return e.length>0?e:o.STABLE_ARRAY}),[O,C,B]),H=R.length>0,U=0===S.length;(0,l.default)({restore:T,shouldLoad:U,storyId:t,story:a?.story}),(0,c.default)({pages:S,current:y,selection:C,story:I,capabilities:v}),(0,d.default)({restore:T});const{updateStory:Y}=b,{saveStory:F,isSaving:G,isFreshlyPublished:j}=(0,s.default)({storyId:t,pages:S,story:I,updateStory:Y}),{autoSave:z,isAutoSaving:V}=(0,p.default)({storyId:t,pages:S,story:I}),W=(0,r.useMemo)((()=>({pages:S,currentPage:N,currentPageId:A,currentPageIndex:k,currentPageNumber:L,selectedElementIds:x,selectedElements:R,selectedElementAnimations:D,hasSelection:H,story:I,animationState:w,capabilities:v,meta:{isSaving:G||V,isSavingStory:G,isAutoSavingStory:V,isFreshlyPublished:j},copiedElementState:P})),[S,N,A,k,L,x,R,D,H,I,w,v,G,V,j,P]),X={state:W,actions:{...b,autoSave:z,saveStory:F},internal:{reducerState:_,restore:T}};return n.createElement(i.default.Provider,{value:X},n.createElement(f.StoryTriggersProvider,{story:W},g))}},97472:(e,t,a)=>{a.d(t,{useStoryTriggerListener:()=>s,useStoryTriggers:()=>o,useStoryTriggersDispatch:()=>u});var n=a(35343),r=a(24763);function o(e){return(0,n.useContextSelector)(r.Context,e??n.identity)}function i(e){return e[0]}function l(e){return e[1]}function s(e,t){const a=(0,n.useContextSelector)(r.Context,i);(0,n.useEffect)((()=>a(e,t)),[e,t,a])}function u(){return(0,n.useContextSelector)(r.Context,l)}},90694:(e,t,a)=>{a.d(t,{default:()=>r});var n=a(98108);function r(e,t){let{animations:a}=t;if(!Array.isArray(a))return e;const r=e.pages.findIndex((t=>{let{id:a}=t;return a===e.current})),o=e.pages[r],i=o.animations||[],l=(0,n.exclusion)(i,a);if(0===l.length)return e;const s={...o,animations:[...i,...l]},u=[...e.pages.slice(0,r),s,...e.pages.slice(r+1)];return{...e,pages:u}}},54850:(e,t,a)=>{a.d(t,{default:()=>r});var n=a(98108);function r(e,t){let{elements:a}=t;if(!Array.isArray(a))return e;const r=e.pages.findIndex((t=>{let{id:a}=t;return a===e.current})),o=e.pages[r],i=(0,n.exclusion)(o.elements,a);if(0===i.length)return e;const l={...o,elements:[...o.elements,...i]},s=[...e.pages.slice(0,r),l,...e.pages.slice(r+1)],u=i.map((e=>{let{id:t}=e;return t}));return{...e,pages:s,selection:u}}},21377:(e,t,a)=>{a.d(t,{default:()=>r});var n=a(98108);function r(e,t){let{page:a,position:r}=t;const o=null!==r&&(0,n.isInsideRange)(r,0,e.pages.length-1),i=e.pages.findIndex((t=>{let{id:a}=t;return a===e.current})),l=o?r:i+1,{id:s}=a;return a.elements?.length?{...e,pages:[...e.pages.slice(0,l),a,...e.pages.slice(l)],current:s,selection:[a.elements[0].id]}:e}},60702:(e,t,a)=>{a.d(t,{default:()=>r});var n=a(98108);function r(e,t){let{elementId:a,position:r}=t;if(null===a&&1!==e.selection.length)return e;const o=null!==a?a:e.selection[0],i=e.pages.findIndex((t=>{let{id:a}=t;return a===e.current})),l=e.pages[i];if(l.elements.length<3)return e;const s=l.elements.findIndex((e=>{let{id:t}=e;return t===o}));if(-1===s||l.elements[0].id===o)return e;const u=l.elements.length-1,c=(0,n.getAbsolutePosition)({currentPosition:s,minPosition:1,maxPosition:u,desiredPosition:r});if(s===c)return e;const d=(0,n.moveArrayElement)(l.elements,s,c),m=[...e.pages.slice(0,i),{...l,elements:d},...e.pages.slice(i+1)];return{...e,pages:m}}},6707:(e,t,a)=>{a.d(t,{default:()=>r});var n=a(98108);function r(e,t){let{pageId:a,position:r}=t;if(e.pages.length<2)return e;const o=e.pages.findIndex((e=>{let{id:t}=e;return t===a})),i=(0,n.isInsideRange)(r,0,e.pages.length-1);if(-1===o||!i||o===r)return e;const l=(0,n.moveArrayElement)(e.pages,o,r);return{...e,pages:l}}},54234:(e,t,a)=>{a.d(t,{default:()=>u});var n=a(44586),r=a(60211),o=a(13851),i=a(31982),l=a(21429),s=a(98108);function u(e,t){let{firstElement:a,secondId:u,shouldRetainAnimations:c=!0}=t;if(!a||!u)return e;const d=a.id,m=a,p=e.pages.findIndex((t=>{let{id:a}=t;return a===e.current})),f=e.pages[p],g=f.elements.findIndex((e=>{let{id:t}=e;return t===u})),h=f.elements[g];if(!m||!m.resource||!h)return e;const E=h.isDefaultBackground?{defaultBackgroundElement:{...h,id:(0,n.default)()}}:{},_=["alt","type","resource","scale","focalX","focalY","tracks","poster"];h.isBackground?(_.push("flip"),_.push("overlay")):(_.push("link"),(0,r.canMaskHaveBorder)(h)&&(_.push("border"),(0,r.canSupportMultiBorder)(h)&&_.push("borderRadius")));const b=(0,i.default)(m,_),T=(0,i.default)(m,["width","height","x","y"]),S={...(0,l.default)(h,["isDefaultBackground"]),...o.DEFAULT_ATTRIBUTES_FOR_MEDIA,...b,...h.isBackground?T:{}},y=f.elements.filter((e=>{let{id:t}=e;return t!==d})).map((e=>e.id===u?S:e)),C=(0,s.removeAnimationsWithElementIds)(f.animations,c?[d]:[d,u]),I={...f,elements:y,...E,animations:C},w=[...e.pages.slice(0,p),I,...e.pages.slice(p+1)];return{...e,pages:w,selection:[u]}}},80612:(e,t,a)=>{a.d(t,{default:()=>r});var n=a(98108);function r(e,t){let{elementIds:a}=t;const r=null===a?e.selection:a;if(0===r.length)return e;const o=e.pages.findIndex((t=>{let{id:a}=t;return a===e.current})),i=e.pages[o],l=i.elements.map((e=>{let{id:t}=e;return t})),s=i.elements[0],u=r.some((e=>e===s.id)),c=s.isDefaultBackground,d=u&&c?r.filter((e=>e!==s.id)):r;if(!((0,n.intersect)(l,d).length>0))return e;let m=i.elements.filter((e=>!d.includes(e.id)));u&&!c&&(m=[i.defaultBackgroundElement,...m]);const p=i.animations||[],f=p.filter((e=>e.targets.some((e=>!d.includes(e))))),g={...i,elements:m,...p.length>0?{animations:f}:{}},h=[...e.pages.slice(0,o),g,...e.pages.slice(o+1)],E=(0,n.intersect)(e.selection,d).length>0?e.selection.filter((e=>!d.includes(e))):e.selection;return{...e,pages:h,selection:E}}},7481:(e,t,a)=>{a.d(t,{default:()=>r});var n=a(46345);function r(e,t){let{elementIds:a}=t;if(!Array.isArray(a))return e;const r=e.pages.findIndex((t=>{let{id:a}=t;return a===e.current})),o=e.pages[r],i={...o},l=[];if(a.forEach((e=>{const t=i.elements.findIndex((t=>{let{id:a}=t;return a===e}));if(t<0)return;const a=i.elements[t];if(a.isBackground)return;const{element:r,elementAnimations:s}=(0,n.duplicateElement)({element:a,animations:o.animations,existingElements:o.elements});l.push(r.id),i.animations=[...i.animations||[],...s],i.elements=[...i.elements.slice(0,t),a,r,...i.elements.slice(t+1)]})),!l.length)return e;const s=[...e.pages.slice(0,r),i,...e.pages.slice(r+1)];return{...e,pages:s,selection:l}}},44459:(e,t,a)=>{a.d(t,{default:()=>o});var n=a(21429),r=a(98108);function o(e,t){let{elementId:a}=t;const o=e.pages.findIndex((t=>{let{id:a}=t;return a===e.current})),i=e.pages[o],l=i.elements[0];let s,u=e.selection;if(null===a){if(l.isDefaultBackground)return e;const t=i.defaultBackgroundElement,a=i.elements.map((e=>e.isBackground?(0,n.default)(e,["isBackground"]):e));s={...i,elements:[t,...a]},u=[t.id]}else{const t=i.elements.findIndex((e=>{let{id:t}=e;return t===a})),n=0===t;if(-1===t||n)return e;const o=l.isDefaultBackground?l:i.defaultBackgroundElement,c=i.elements.slice(1),d=t-1;e.selection.includes(l.id)&&(u=e.selection.filter((e=>e!==l.id)));const m=(0,r.moveArrayElement)(c,d,0).map((e=>e.id===a?{...e,isBackground:!0,...Object.prototype.hasOwnProperty.call(e,"opacity")&&{opacity:100}}:e));e.selection.includes(a)&&e.selection.length>1&&(u=e.selection.filter((e=>e!==a))),s={...i,defaultBackgroundElement:o,elements:m}}const c=i.elements.find((e=>e.isBackground)),d=(0,r.removeAnimationsWithElementIds)(i.animations,[a,c.id]),m=[...e.pages.slice(0,o),{...s,animations:d||[]},...e.pages.slice(o+1)];return{...e,pages:m,selection:u}}},62109:(e,t,a)=>{a.d(t,{default:()=>o});var n=a(70746),r=a(98108);function o(e,t){let{elementIds:a}=t;const o="function"==typeof a?a(e.selection):a;if(!Array.isArray(o))return e;const i=[...new Set(o)];if(e.selection.length===i.length&&(0,r.intersect)(e.selection,i).length===e.selection.length)return e;const l=e.pages.find((t=>{let{id:a}=t;return a===e.current})),s=i.length>1?i.filter((e=>(e=>l.elements[0].id!==e)(e)&&(e=>{const t=l.elements.find((t=>t.id===e))?.resource?.isPlaceholder;return!t})(e))):i;return{...e,animationState:n.STORY_ANIMATION_STATE.RESET,selection:s}}},35443:(e,t,a)=>{a.d(t,{default:()=>o});var n=a(2775),r=a(62109);function o(e,t){let{elementId:a,metaKey:o,shiftKey:i}=t;if(o)return(0,n.default)(e,{elementId:a});if(e.selection.length<=0||!i)return(0,r.default)(e,{elementIds:[a]});const l=e.selection[0],s=e.pages.find((t=>{let{id:a}=t;return a===e.current})).elements.map((e=>e.id)),u=s.findIndex((e=>e===l)),c=s.findIndex((e=>e===a)),d=Math.min(u,c),m=Math.max(u,c),p=s.slice(d,m+1);return l!==p[0]&&p.reverse(),(0,r.default)(e,{elementIds:p})}},19941:(e,t,a)=>{a.d(t,{default:()=>o});var n=a(70746),r=a(98108);function o(e,t){let{elementIds:a,properties:o}=t;if([n.STORY_ANIMATION_STATE.PLAYING,n.STORY_ANIMATION_STATE.PLAYING_SELECTED,n.STORY_ANIMATION_STATE.SCRUBBING].includes(e.animationState))return e;const i=null===a?e.selection:a;if(0===i.length)return e;const l=e.pages.findIndex((t=>{let{id:a}=t;return a===e.current})),s=e.pages[l],u=s.elements.map((e=>{let{id:t}=e;return t}));if(!((0,r.intersect)(u,i).length>0))return e;const c=s.elements.reduce(((e,t)=>{if(!i.includes(t.id))return e;const{animation:a,...n}=(0,r.updateElementWithUpdater)(t,o),l=a?{[a.id]:{...a,targets:[n.id]}}:{};return{...e,...l}}),{}),d=s.elements.reduce(((e,t)=>{if(!i.includes(t.id))return[...e,t];const{animation:a,...n}=(0,r.updateElementWithUpdater)(t,o);return[...e,n]}),[]),m=Object.keys(c).length>0,p=m?(0,r.updateAnimations)(s.animations||[],c):s.animations,f=p&&{animations:p},g={elements:d},h={...s,...m?f:g},E=[...e.pages.slice(0,l),h,...e.pages.slice(l+1)];return{...e,pages:E}}},84476:(e,t,a)=>{a.d(t,{default:()=>r});var n=a(98108);function r(e,t){let{family:a,properties:r}=t;if(!a)return e;if(!e.pages.some((e=>e.elements.some((e=>"text"===e.type&&e?.font?.family===a)))))return e;const o=e.pages.map((e=>{const t=e.elements.map((e=>e?.font?.family===a?(0,n.updateElementWithUpdater)(e,r):e));return{...e,elements:t}}));return{...e,pages:o}}},71470:(e,t,a)=>{a.d(t,{default:()=>r});var n=a(98108);function r(e,t){let{id:a,properties:r}=t;if(!a)return e;if(!e.pages.some((e=>e.elements.some((e=>e.resource?.id===a)))))return e;const o=e.pages.map((e=>{const t=e.elements.map((e=>e.resource?.id===a?(0,n.updateElementWithUpdater)(e,r):e));return{...e,elements:t}}));return{...e,pages:o}}},8494:(e,t,a)=>{a.d(t,{default:()=>o});var n=a(95800),r=(a(89157),a(29184),a(21429));function o(e,t){let{pageId:a,properties:o}=t;const i=null===a?e.current:a,l=e.pages.findIndex((e=>{let{id:t}=e;return t===i}));if(-1===l)return e;const s=(0,r.default)(o,n.PAGE_RESERVED_PROPERTIES),u={...e.pages[l],...s},c=[...e.pages.slice(0,l),u,...e.pages.slice(l+1)];return{...e,pages:c}}},98108:(e,t,a)=>{a.d(t,{exclusion:()=>f,getAbsolutePosition:()=>u,intersect:()=>i,isInsideRange:()=>l,moveArrayElement:()=>s,removeAnimationsWithElementIds:()=>d,updateAnimations:()=>m,updateElementWithUpdater:()=>c});var n=a(51517),r=a(95800),o=a(21429);function i(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];return e&&a?.length?a.reduce(((e,t)=>e.filter((e=>t.includes(e)))),e):e}function l(e,t,a){return e>=t&&e<=a}function s(e,t,a){const n=e[t],r=[...e.slice(0,t),...e.slice(t+1)];return[...r.slice(0,a),n,...r.slice(a)]}function u(e){let{currentPosition:t,minPosition:a,maxPosition:r,desiredPosition:o}=e;if("number"==typeof o)return Math.min(r,Math.max(a,o));if("string"!=typeof o)return t;switch(o){case n.LAYER_DIRECTIONS.FRONT:return r;case n.LAYER_DIRECTIONS.BACK:return a;case n.LAYER_DIRECTIONS.FORWARD:return Math.min(r,t+1);case n.LAYER_DIRECTIONS.BACKWARD:return Math.max(a,t-1);default:return t}}function c(e,t){const a="function"==typeof t?t(e):t,n=(0,o.default)(a,r.ELEMENT_RESERVED_PROPERTIES);return 0===Object.keys(n).length?e:{...e,...n}}function d(e,t){return(e||[]).reduce(((e,a)=>t.some((e=>a.targets?.includes(e)))?e:[...e,a]),[])}function m(e,t){const a=e.reduce(((e,a)=>{const n=t[a.id];return delete t[a.id],n?.delete?e:n?[...e,n]:[...e,a]}),[]);return Object.values(t).forEach((e=>a.push(e))),a}function p(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object.values(Object.fromEntries(e.map((e=>[e.id,e]))))}function f(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const a=p(t),n=e.map((e=>{let{id:t}=e;return t}));return a.filter((e=>{let{id:t}=e;return!n.includes(t)}))}},83457:(e,t,a)=>{a.d(t,{default:()=>o});var n=a(28410),r=a(31982);function o(e){let{story:t,pages:a,metadata:o,flags:i}=e;const{terms:l,...s}=(0,r.default)(t,["title","status","author","date","modified","slug","excerpt","featuredMedia","password","currentStoryStyles","globalStoryStyles","autoAdvance","defaultPageDuration","backgroundAudio","terms"]);return{content:(0,n.getStoryMarkup)(t,a,o,i),pages:a,...s,...l,meta:{web_stories_publisher_logo:t.publisherLogo?.id}}}},34754:(e,t,a)=>{a.d(t,{AccessibilityChecks:()=>AccessibilityChecks});var n=a(67294),r=a(58167),o=a(84082),i=a(35466),l=a(96382),s=a(93841);function AccessibilityPanel(e){let{children:t,badgeCount:a,isOpen:o,onClick:i,maxHeight:u,title:c}=e;return(0,s.useIsChecklistMounted)()?n.createElement(l.StyledTablistPanel,{badgeCount:a,isExpanded:Boolean(a)&&o,onClick:i,maxHeight:u,title:c},n.createElement(l.PanelText,null,(0,r.__)("Make your Web Story accessible.","web-stories")),t):t}function AccessibilityChecks(e){return n.createElement(i.ChecklistCategoryProvider,{category:o.ISSUE_TYPES.ACCESSIBILITY},n.createElement(AccessibilityPanel,e,e.children))}},19843:(e,t,a)=>{a.d(t,{DesignChecks:()=>DesignChecks});var n=a(67294),r=a(58167),o=a(84082),i=a(35466),l=a(96382),s=a(93841);function DesignPanel(e){let{badgeCount:t=0,isOpen:a,maxHeight:o,onClick:i,title:u,children:c}=e;return(0,s.useIsChecklistMounted)()?n.createElement(l.StyledTablistPanel,{badgeCount:t,isExpanded:Boolean(t)&&a,onClick:i,maxHeight:o,title:u},n.createElement(l.PanelText,null,(0,r.__)("Follow best practices for Web Stories.","web-stories")),c):c}function DesignChecks(e){return n.createElement(i.ChecklistCategoryProvider,{category:o.ISSUE_TYPES.DESIGN},n.createElement(DesignPanel,e,e.children))}},35221:(e,t,a)=>{a.d(t,{PriorityChecks:()=>PriorityChecks});var n=a(67294),r=a(58167),o=a(35343),i=a(35185),l=(a(28249),a(84082)),s=a(35466),u=a(96382),c=a(72063),d=a(93841);function PriorityPanel(e){let{children:t,badgeCount:a=0,isOpen:o,onClick:l,maxHeight:s,title:c}=e;return(0,d.useIsChecklistMounted)()?n.createElement(u.StyledTablistPanel,{badgeCount:a,isExpanded:Boolean(a)&&o,onClick:l,maxHeight:s,status:i.PANEL_STATES.DANGER,title:c},n.createElement(u.PanelText,null,(0,r.__)("Make this Web Story easier to discover.","web-stories")),t):t}function PriorityChecks(e){const t=(0,s.useCategoryCount)(l.ISSUE_TYPES.PRIORITY),{updateHighPriorityCount:a}=(0,c.useCheckpoint)((e=>{let{actions:{updateHighPriorityCount:t}}=e;return{updateHighPriorityCount:t}}));return(0,o.useEffect)((()=>{a(t)}),[a,t]),n.createElement(s.ChecklistCategoryProvider,{category:l.ISSUE_TYPES.PRIORITY},n.createElement(PriorityPanel,e,e.children))}},24807:(e,t,a)=>{a.d(t,{default:()=>ChecklistProvider});var n=a(67294),r=a(35343),o=a(26613),i=a(52601);const ChecklistProvider=e=>{let{children:t}=e;const[a,l]=(0,r.useState)(!1),[s,u]=(0,r.useState)(!1),[c,d]=(0,r.useState)(),[m,p]=(0,r.useState)(!1),f=(0,r.useCallback)((e=>{d(e)}),[d]),g=(0,r.useCallback)((()=>{(0,o.trackEvent)("checklist_toggled",{status:a?"closed":"open"}),l((e=>!e))}),[a]),h=(0,r.useCallback)((()=>{(0,o.trackEvent)("checklist_toggled",{status:"closed"}),l(!1)}),[]),E=(0,r.useCallback)((()=>{(0,o.trackEvent)("checklist_toggled",{status:"open"}),l(!0),u(!0)}),[]),_=(0,r.useCallback)((()=>u(!1)),[]),b=(0,r.useMemo)((()=>({state:{checklistFocused:s,isOpen:a,isChecklistMounted:m,openPanel:c},actions:{toggle:g,close:h,open:E,resetChecklistFocused:_,setIsChecklistMounted:p,setOpenPanel:f}})),[s,h,c,a,E,_,g,f,p,m]);return n.createElement(i.default.Provider,{value:b},t)}},55394:(e,t,a)=>{a.d(t,{useChecklist:()=>o});var n=a(35343),r=a(52601);function o(e){return(0,n.useContextSelector)(r.default,e??n.identity)}},72063:(e,t,a)=>{a.d(t,{ChecklistCheckpointProvider:()=>ChecklistCheckpointProvider,CheckpointContext:()=>h,useCheckpoint:()=>E});var n=a(67294),r=a(35343),o=(a(55537),a(84296),a(17166),a(40169),a(89703),a(54e3),a(28377),a(40823),a(19040),a(89157),a(29184),a(73393),a(26613),a(70746),a(60211),a(13851),a(46345),a(76129),a(11606),a(37890),a(30738),a(50067),a(28410),a(97472)),i=(a(24763),a(21303),a(34639),a(79254)),l=a(84401),s=(a(93909),a(39751),a(9219),a(79074),a(12221),a(41657),a(249),a(32696),a(63594),a(16243),a(77850),a(697),a(65290),a(80951),a(73071),a(7377),a(55376),a(24355),a(62313),a(83859),a(84082));const u="story is no longer empty",c="publish button is pressed",d="story 'recommended' section enabled",m="story 'high priority' section enabled",p="story is published, regardless of recommendations",f={[s.PPC_CHECKPOINT_STATE.UNAVAILABLE]:{[u]:s.PPC_CHECKPOINT_STATE.ONLY_RECOMMENDED,[c]:s.PPC_CHECKPOINT_STATE.ALL,[p]:s.PPC_CHECKPOINT_STATE.ALL,[d]:s.PPC_CHECKPOINT_STATE.ONLY_RECOMMENDED},[s.PPC_CHECKPOINT_STATE.ONLY_RECOMMENDED]:{[m]:s.PPC_CHECKPOINT_STATE.ALL,[c]:s.PPC_CHECKPOINT_STATE.ALL,[p]:s.PPC_CHECKPOINT_STATE.ALL},[s.PPC_CHECKPOINT_STATE.ALL]:{}},g=(e,t)=>f[e][t]||e,h=(0,r.createContext)({state:{},actions:{}});function ChecklistCheckpointProvider(e){let{children:t}=e;const[a,f]=(0,r.useReducer)(g,s.PPC_CHECKPOINT_STATE.UNAVAILABLE),[E,_]=(0,r.useState)(),[b,T]=(0,r.useState)(),S=E>0,y=(0,l.default)((e=>{let{state:{story:t}}=e;return t.status}));(0,r.useEffect)((()=>{"publish"===y&&f(p)}),[y]),(0,o.useStoryTriggerListener)(i.STORY_EVENTS.onSecondPageAdded,(0,r.useCallback)((()=>{f(d)}),[])),(0,o.useStoryTriggerListener)(i.STORY_EVENTS.onFifthPageAdded,(0,r.useCallback)((()=>{f(m)}),[])),(0,o.useStoryTriggerListener)(i.STORY_EVENTS.onInitialElementAdded,(0,r.useCallback)((()=>{f(u)}),[]));const C=(0,r.useCallback)((e=>{_(e)}),[]),I=(0,r.useCallback)((()=>f(c)),[]),w=(0,r.useCallback)((()=>{T(!0)}),[]),v=(0,r.useCallback)((()=>{T(!1)}),[]),P=(0,r.useMemo)((()=>({state:{checkpoint:a,hasHighPriorityIssues:S,reviewChecklistRequested:b},actions:{updateHighPriorityCount:C,handleResetReviewChecklist:v,handleReviewChecklist:w,showPriorityIssues:I}})),[a,w,I,v,b,S,C]);return n.createElement(h.Provider,{value:P},t)}function E(e){return(0,r.useContextSelector)(h,e??r.identity)}},13688:(e,t,a)=>{a.d(t,{getPagesWithFailedContrast:()=>E});var n=a(41297),r=a(39187),o=a(59426),i=a(2462),l=a(69305),s=a(43040),u=a(45743),c=(a(19040),a(84082),a(90842)),d=(a(67294),a(65314),a(52563),a(89574),a(50014),a(46345),a(35343),a(54e3),a(28377),a(40823),a(55537),a(84296),a(17166),a(40169),a(89703),a(89157),a(29184),a(73393),a(26613),a(70746),a(60211),a(13851),a(76129),a(11606),a(37890),a(30738),a(50067),a(28410),a(24763),a(21303),a(34639),a(93909),a(40282));a(39751),a(9219),a(79074),a(12221),a(41657),a(249),a(32696),a(63594),a(16243),a(77850),a(697),a(65290),a(80951),a(73071),a(7377),a(55376),a(24355),a(62313),a(83859);function m(e,t){return e>=.3333333333333333*t}function p(e){let{background:t,text:a,page:u}=e;const{pageSize:c}=u,m=(c?.width/o.FULLBLEED_RATIO-c?.width/o.PAGE_RATIO)/2,p=(0,n.getBox)(a,c?.width,c?.height),g=(0,r.default)([p]),{resource:h,scale:E,focalX:_,focalY:b}=t,T=(0,n.getBox)(t,c?.width,c?.height),{width:S,height:y}=T,C=(0,i.default)(h,S,y,E,_,b);return async function(e){let{bgImage:t,bgBox:a,overlapBox:n}=e;const r=await(0,l.default)({src:t.src,width:t.width,height:t.height}),o=await function(e){return new Promise(((r,o)=>{try{const o=document.createElement("canvas");o.width=t.width,o.height=t.height;const i=o.getContext("2d");if(t.rotationAngle){const e=t.offsetX+a.width/2,n=t.offsetY+a.height/2;i.translate(e,n),i.rotate(t.rotationAngle*f),i.translate(-e,-n)}let l=0,s=0;const{flip:u}=t;(u.vertical||u.horizontal)&&(l=u.horizontal?-1*t.width:0,s=u.vertical?-1*t.height:0,i.scale(u.horizontal?-1:1,u.vertical?-1:1)),i.drawImage(e,l,s,t.width,t.height),r(i.getImageData(n.x,n.y,n.width,n.height))}catch(e){o(e)}}))}(r),i=document.createElement("canvas");i.width=n.width,i.height=n.height,i.getContext("2d").putImageData(o,0,0);const u=await(0,d.default)(i.toDataURL(),i.width,i.height),{color:{r:c,g:m,b:p}}=(0,s.default)(u);return{r:c,g:m,b:p}}({bgImage:{offsetX:C.offsetX,offsetY:C.offsetY,src:t.resource.src,width:C.width,height:C.height,rotationAngle:t.isBackground?void 0:t.rotationAngle,flip:t.flip},bgBox:T,overlapBox:{x:t.isBackground?C.offsetX+Math.abs(g.startX):C.offsetX+Math.abs(g.startX)-T.x,y:t.isBackground?C.offsetY+Math.abs(g.startY+m):C.offsetY+Math.abs(g.startY+m)-(T.y+m),width:g.width,height:g.height}}).catch((()=>{}))}const f=Math.PI/180;function g(e){let{background:t}=e;return t?.backgroundColor?.color}function h(e){switch(e.type){case"image":return p;case"shape":return g;default:return()=>{}}}async function E(e,t){const a=[];return(e||[]).forEach((e=>{const o=async function(e){const t=[];e.elements.forEach(((a,o)=>{if("text"===a.type&&"NONE"===a.backgroundTextMode){const i=function(e){const t=(0,c.getSpansFromContent)(e.content),a=t.map((e=>e.style?.color)).filter(Boolean),n=0===a.length&&0!==t.length,r=0!==e.content.length&&0===t.length;return(n||r)&&a.push("rgb(0, 0, 0)"),a}(a),l=e.elements.slice(0,o),s=function(e,t,a){const{pageSize:o}=a,i=(0,n.getBox)(e,o?.width,o?.height),l=(0,r.default)([i]),s=l.width*l.height,u=[...t].map(((e,t)=>{const i=(0,n.getBox)(e,o?.width,o?.height),s=(0,r.default)([i]),u=function(e,t){const a=Math.min(e.endX,t.endX)-Math.max(e.startX,t.startX),n=Math.min(e.endY,t.endY)-Math.max(e.startY,t.startY);return a>=0&&n>=0?a*n:0}(l,s);return{element:e.isBackground||e.isDefaultBackground?{...e,backgroundColor:a?.backgroundColor}:e,area:u,index:t}})).reverse();let c=s;const d=[];for(const e of u){if(!m(c,s))break;m(e.area,s)&&d.push(e.element),c-=e.area}return d}(a,l,e);for(const n of s){const r=h(n)({background:n,text:a,page:e}),o=e=>e&&{backgroundColor:e,textStyleColors:i,fontSize:a.fontSize,id:a.id,isBackgroundElement:n.isBackground},l=r instanceof Promise?r.then(o):o(r);t.push(l)}}}));const a=(await Promise.all(t)).map((e=>function(){let{backgroundColor:e,textStyleColors:t,fontSize:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!(!t||!e)&&t.some((t=>{if(!t)return!1;const n=(0,u.calculateLuminanceFromStyleColor)(t),r=(0,u.calculateLuminanceFromRGB)(e);return!(0,u.checkContrastFromLuminances)(n,r,a).WCAG_AA}))}(e)&&{id:e.id,isBackground:e.isBackgroundElement}));return a.filter((e=>{let{id:t}=e;return t}))}({...e,pageSize:t});o instanceof Promise?a.push(o.then((t=>({result:t,page:e})))):a.push(o)})),(await Promise.all(a)).filter((e=>e.result.some((e=>{let{id:t}=e;return t})))).map((e=>e))}},88858:(e,t,a)=>{a.d(t,{default:()=>ThumbnailWrapper});var n=a(67294),r=a(58804),o=a(90949),i=a(77904),l=a(1852),s=a(16087),u=a(35343),c=a(58167),d=(a(19040),a(84082));a(65314),a(52563),a(89574),a(50014),a(46345),a(54e3),a(28377),a(40823),a(55537),a(84296),a(17166),a(40169),a(89703),a(89157),a(29184),a(73393),a(26613),a(70746),a(60211),a(13851),a(76129),a(11606),a(37890),a(30738),a(50067),a(28410),a(24763),a(21303),a(34639),a(93909),a(39751),a(9219),a(79074),a(12221),a(41657),a(249),a(32696),a(63594),a(16243),a(77850),a(697),a(65290),a(80951),a(73071),a(7377),a(55376),a(24355),a(62313),a(83859);var m=a(89353),p=a(58965);function f(){return f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},f.apply(this,arguments)}const g=r.default.div.withConfig({displayName:"thumbnailWrapper__Wrapper",componentId:"sc-3oy0ss-0"})(["grid-area:thumbnail;transition:height ease-in-out 300ms;",""],(e=>{let{$isMultiple:t}=e;return t&&(0,r.css)(["display:grid;grid-gap:8px;grid-template-columns:repeat(4,52px);grid-template-rows:auto;"])})),h=(0,r.default)(o.Button).attrs({variant:i.BUTTON_VARIANTS.RECTANGLE,size:i.BUTTON_SIZES.SMALL,type:i.BUTTON_TYPES.TERTIARY}).withConfig({displayName:"thumbnailWrapper__StyledButton",componentId:"sc-3oy0ss-1"})(["grid-column:span 4;justify-content:center;height:32px;width:100%;margin:4px 0;",";"],(e=>{let{theme:t}=e;return s.focusableOutlineCSS(t.colors.border.focus,t.colors.bg.tertiary)})),E=r.default.div.withConfig({displayName:"thumbnailWrapper__IconContainer",componentId:"sc-3oy0ss-2"})(["height:18px;width:20px;svg{transform:",";transition:transform ease-in-out 300ms;}"],(e=>{let{$isExpanded:t}=e;return t&&"rotate(-180deg)"})),ToggleButton=e=>{let{children:t,isExpanded:a,...r}=e;return n.createElement(h,f({"aria-pressed":a},r),(0,c.__)(t||a?"Collapse":"Expand","web-stories"),n.createElement(E,{$isExpanded:a},n.createElement(l.default,null)))},ThumbnailWrapper=e=>{let{children:t,...a}=e;const[r,o]=(0,u.useState)(!1),i=Array.isArray(t)?t.length:1,l=i>0&&i>p.MAX_THUMBNAILS_DISPLAYED+1,s=r||i<=1?t:function(e){return e.length>d.THUMBNAIL_MAX?e.slice(0,d.THUMBNAIL_COUNT_FOR_OVERFLOW):e}(t),c=()=>o((e=>!e));return n.createElement(g,f({$isMultiple:i>1},a),s,l&&n.createElement(n.Fragment,null,!r&&n.createElement(m.StyledOverflowThumbnail,{overflowCount:i-p.MAX_THUMBNAILS_DISPLAYED,onClick:c}),n.createElement(ToggleButton,{isExpanded:r,onClick:c})))}},75671:(e,t,a)=>{a.d(t,{default:()=>VideoOptimization});var n=a(67294),r=a(58167),o=a(65197),i=a(58804),l=a(35343),s=a(90949),u=a(77904),c=a(55859),d=(a(89157),a(75134)),m=(a(29184),a(70746),a(60211),a(13851),a(46345),a(76129),a(11606),a(54e3),a(28377),a(40823),a(40169),a(89703),a(37890),a(30738),a(50067),a(28410),a(24763),a(21303),a(34639),a(84401)),p=(a(26613),a(93909),a(39751),a(9219),a(79074)),f=(a(12221),a(41657),a(249),a(32696),a(88476)),g=a(84082),h=a(89574),E=a(50097),_=(a(50014),a(80439)),b=a(89353),T=a(11209),S=a(58965),y=a(8236),C=a(99690),I=(a(37070),a(35917)),w=(a(96426),a(60811),a(6687),a(9730),a(35466)),v=a(93841);const P=(0,i.default)(s.Button).withConfig({displayName:"videoOptimization__OptimizeButton",componentId:"sc-1dz2s9g-0"})(["margin-top:4px;"]);function A(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{resource:t}=e;if(!t)return!1;const{isOptimized:a,height:n=0,width:r=0}=t;if("video"!==e.type||a)return!1;const o=n*r,i=o>d.MEDIA_VIDEO_DIMENSIONS_THRESHOLD.WIDTH*d.MEDIA_VIDEO_DIMENSIONS_THRESHOLD.HEIGHT;return i}const k={},L="cancelled",N="uploaded",x="uploading";function O(e,t){switch(t.type){case L:return{...e,[t.element.resource.id]:L};case N:return{...e,[t.element.resource.id]:N};case x:return{...e,[t.element.resource.id]:x};default:throw new Error}}const BulkVideoOptimization=()=>{const e=(0,v.useIsChecklistMounted)(),[t,a]=(0,l.useReducer)(O,k),i=(0,m.default)((e=>{let{state:t}=e;return t?.pages})),{optimizeVideo:s,isNewResourceTranscoding:d,isCurrentResourceTranscoding:p,canTranscodeResource:M}=(0,f.default)((e=>{let{actions:{optimizeVideo:t},state:{isNewResourceTranscoding:a,canTranscodeResource:n,isCurrentResourceTranscoding:r}}=e;return{optimizeVideo:t,isNewResourceTranscoding:a,canTranscodeResource:n,isCurrentResourceTranscoding:r}})),R=(0,l.useMemo)((()=>(0,C.filterStoryElements)(i,A)),[i]).filter(((e,t,a)=>a.findIndex((t=>t.resource.id===e.resource.id))===t)),B=(0,I.default)((e=>{let{setHighlights:t}=e;return t})),D=(0,l.useCallback)((async e=>{if(M(e.resource)&&t[e.resource.id]!==x){a({type:x,element:e});try{await s({resource:e.resource})}catch(t){return void a({type:L,element:e})}a({type:N,element:e})}}),[M,s,t]),H=(0,l.useCallback)((()=>{const e=R.filter((e=>{let{resource:t}=e;return!d(t?.id)&&!p(t?.id)}));return new Promise((t=>{e.map((e=>async()=>{await D(e)})).reduce(((e,t)=>e.then(t)),Promise.resolve()).then(t)}))}),[d,p,D,R]),U=(0,l.useCallback)((async()=>{await H()}),[H]),Y=(0,l.useCallback)((e=>async()=>{B({pageId:e.pageId,elementId:e.id}),await D(e)}),[D,B]),{footer:F,title:G}=g.PRIORITY_COPY.videoNotOptimized,j=(0,l.useMemo)((()=>Object.values(t).filter((e=>e===x))),[t]),z=(0,l.useMemo)((()=>j.length>0||R.some((e=>d(e.resource.id)||p(e.resource.id)))),[j,R,d,p]),V=R.length>0;(0,w.useRegisterCheck)("VideoOptimization",V);let W=1===R.length?(0,r.__)("Optimize video","web-stories"):(0,r.__)("Optimize all videos","web-stories");if(z){const e=j.length+R.filter((e=>d(e.resource.id)||p(e.resource.id))).length;W=(0,o.default)(
/* translators: 1: number of videos currently transcoding. 2: total number of videos in list. */
(0,r._n)("Optimizing %1$d of %2$d","Optimizing %1$d of %2$d",e,"web-stories"),e,R.length)}return V&&e&&n.createElement(T.default,{cta:n.createElement(P,{type:u.BUTTON_TYPES.SECONDARY,size:u.BUTTON_SIZES.SMALL,onClick:U,disabled:z},W),title:G,cardType:R.length>1?S.CARD_TYPE.MULTIPLE_ISSUE:S.CARD_TYPE.SINGLE_ISSUE,footer:n.createElement(y.DefaultFooterText,null,F),thumbnails:R.map((e=>n.createElement(E.default,{key:e.resource.id,onClick:Y(e),isLoading:d(e.resource.id)||p(e.resource.id),type:h.THUMBNAIL_TYPES.VIDEO,displayBackground:n.createElement(_.LayerThumbnail,{page:e}),"aria-label":(0,r.__)("Go to offending video","web-stories"),isError:t[e.resource.id]===L},n.createElement(c.Tooltip,{title:t[e.resource.id]===x||d(e.resource.id)||p(e.resource.id)?(0,r.__)("Video optimization in progress","web-stories"):(0,r.__)("Optimize","web-stories")},n.createElement(b.StyledVideoOptimizationIcon,null)))))})},VideoOptimization=()=>{const{isTranscodingEnabled:e}=(0,p.default)();return e?n.createElement(BulkVideoOptimization,null):null}},84082:(e,t,a)=>{a.d(t,{ACCESSIBILITY_COPY:()=>x,ASPECT_RATIO_LEFT:()=>m,ASPECT_RATIO_RIGHT:()=>p,CATEGORY_LABELS:()=>N,CHECKLIST_TITLE:()=>k,DESIGN_COPY:()=>O,FEATURED_MEDIA_RESOURCE_MIN_HEIGHT:()=>v,FEATURED_MEDIA_RESOURCE_MIN_WIDTH:()=>w,ISSUE_TYPES:()=>L,MAX_LINKS_PER_PAGE:()=>y,MAX_PAGE_CHARACTER_COUNT:()=>h,MAX_STORY_PAGES:()=>_,MAX_STORY_TITLE_LENGTH_CHARS:()=>b,MAX_VIDEO_LENGTH_SECONDS:()=>T,MIN_FONT_SIZE:()=>f,MIN_STORY_CHARACTER_COUNT:()=>g,MIN_STORY_PAGES:()=>E,MIN_VIDEO_HEIGHT:()=>C,MIN_VIDEO_WIDTH:()=>I,PANEL_EXPANSION_BY_CHECKPOINT:()=>D,PANEL_VISIBILITY_BY_STATE:()=>B,POPUP_ID:()=>A,PPC_CHECKPOINT_STATE:()=>R,PRIORITY_COPY:()=>M,PUBLISHER_LOGO_DIMENSION:()=>P,THUMBNAIL_COUNT_FOR_OVERFLOW:()=>d,THUMBNAIL_MAX:()=>c});var n=a(67294),r=a(58167),o=a(65197),i=a(2667),l=a(26613),s=a(21931),u=a(71314);const c=4,d=3,m=3,p=4,f=12,g=100,h=200,E=4,_=30,b=70,T=60,S=Math.floor(1),y=3,C=480,I=852,w=640,v=853,P=96,A="checklist_companion",k=(0,r.__)("Checklist","web-stories"),L={ACCESSIBILITY:"accessibility",DESIGN:"design",PRIORITY:"priority"},N={[L.ACCESSIBILITY]:(0,r.__)("Accessibility","web-stories"),[L.DESIGN]:(0,r.__)("Design","web-stories"),[L.PRIORITY]:(0,r.__)("Priority","web-stories")},x={fontSizeTooSmall:{title:(0,o.default)(
/* translators: %d: minimum font size. */
(0,r.__)("Increase font size to %s or above","web-stories"),12),footer:(0,o.default)(
/* translators: %d: minimum font size. */
(0,r.__)("Ensure legibility by selecting text size %d or greater","web-stories"),12)},imagesMissingAltText:{title:(0,r.__)("Add assistive text to images","web-stories"),footer:(0,r.__)("Optimize accessibility and indexability with meaningful text to better assist users.","web-stories")},linkTappableRegionTooBig:{title:(0,r.__)("Reduce link size","web-stories"),footer:(0,r.__)("Elements with links must not cover most of the page. Decrease the size of elements with links.","web-stories")},linkTappableRegionTooSmall:{title:(0,o.default)(
/* translators: %s: minimum tappable region size width x minimum tappable region size height. */
(0,r.__)("Increase tap area size to at least %s","web-stories"),"48x48px"),footer:(0,r.__)("Optimize accessibility and indexability with meaningful text to better assist users","web-stories")},lowContrast:{title:(0,r.__)("Increase contrast between text and background color","web-stories"),footer:(0,r.__)("Ensure legibility of text and ease of reading by increasing color contrast","web-stories"),textPanel:(0,r.__)("This color or font size combination may be hard for some people to read.","web-stories"),backgroundPanel:(0,r.__)("This background color may make some text hard to read.","web-stories"),warningIcon:(0,r.__)("Low Warning","web-stories")},videoMissingCaptions:{title:(0,r.__)("Add video captions","web-stories"),footer:(0,r.__)("Keep the audience engaged even when they can't listen to the audio","web-stories")},videoMissingTitle:{title:(0,r.__)("Add video description","web-stories"),footer:(0,r.__)("Improves indexability and accessibility (for videos without captions)","web-stories")}},O={storyTooShort:{title:(0,o.default)(
/* translators: %d: maximum number of pages. */
(0,r._n)("Make Web Story at least %d page","Make Web Story at least %d pages",4,"web-stories"),4),footer:(0,o.default)(
/* translators: 1: minimum number of pages. 2: maximum number of pages. */
(0,r.__)("It is recommended to have between %1$d and %2$d pages in your story","web-stories"),4,30)},storyTooLong:{title:(0,o.default)(
/* translators: %d: minimum number of pages. */
(0,r._n)("Make Web Story fewer than %d page","Make Web Story fewer than %d pages",30,"web-stories"),30),footer:(0,o.default)(
/* translators: 1: minimum number of pages. 2: maximum number of pages. */
(0,r.__)("It is recommended to have between %1$d and %2$d pages in your story","web-stories"),4,30)},tooLittlePageText:{title:(0,r.__)("Add more text to page","web-stories"),footer:(0,o.default)(
/* translators: %d: minimum number of story characters. */
(0,r._n)("Include at least %d character","Include at least %d characters",100,"web-stories"),100)},tooMuchPageText:{title:(0,r.__)("Reduce text amount on page","web-stories"),footer:n.createElement(n.Fragment,null,n.createElement("li",null,(0,o.default)(
/* translators: %d: maximum number of story characters. */
(0,r._n)("Include no more than %d character","Include no more than %d characters",200,"web-stories"),200)),n.createElement("li",null,(0,r.__)("Use a page attachment breaking up the text into multiple screens; or","web-stories")),n.createElement("li",null,(0,o.default)(
/* translators: %s: maximum percentage of characters, depending on number of pages. */
(0,r.__)("Keep the total number of text-heavy pages under %s of total number of story pages","web-stories"),"10%")))},tooManyLinksOnPage:{title:(0,o.default)(
/* translators: %s: maximum number of links per page. */
(0,r.__)("Avoid including more than %s links per page","web-stories"),3),footer:(0,o.default)(
/* translators: %s: maximum number of links per page. */
(0,r.__)("Avoid having more than %s links on one page","web-stories"),3)},imageResolutionTooLow:{title:(0,r.__)("Increase image resolution","web-stories"),footer:n.createElement(n.Fragment,null,n.createElement("li",null,(0,r.__)("Use larger resolution (2x or 3x) images for best appearance on screens with high pixel density","web-stories")),n.createElement("li",null,(0,o.default)(
/* translators: %s: minimum image size width x minimum image size height. */
(0,r.__)("For full-screen images, use a resolution of at least %s","web-stories"),"828x1792px")))},videoFrameRateTooLow:{title:(0,o.default)(
/* translators: %d: minimum number of frames per second for video. */
(0,r.__)("Increase video frame rate to at least %d fps","web-stories"),24),footer:(0,o.default)(
/* translators: %d: minimum number of frames per second for video. */
(0,r._n)("Ensure your video has a minimum of %d frame per second","Ensure your video has a minimum of %d frames per second",24,"web-stories"),24)},videoResolutionTooLow:{title:(0,r.__)("Increase video resolution","web-stories"),footer:(0,o.default)(
/* translators: 1: minimum video resolution. 2: minimum video width x minimum video height in pixels. */
(0,r.__)("Consider using a minimum resolution of %1$s (%2$s) to represent portrait videos","web-stories"),"480p","852x480px")},videoTooLong:{title:(0,o.default)(
/* translators: %d: maximum video length in minutes. */
(0,r._n)("Split videos into segments of %d minute or less","Split videos into segments of %d minutes or less",S,"web-stories"),S),footer:(0,r.__)("Shorter videos help readers navigate stories","web-stories")}},M={storyMissingDescription:{title:(0,r.__)("Add Web Story description","web-stories"),footer:(0,r.__)("Incorporate a brief description for better user experience","web-stories")},storyMissingTitle:{title:(0,r.__)("Add Web Story title","web-stories"),footer:n.createElement(n.Fragment,null,n.createElement("li",null,(0,o.default)(
/* translators: %d: maximum story title length in words. */
(0,r._n)("Keep under %d word","Keep under %d words",10,"web-stories"),10)),n.createElement("li",null,(0,o.default)(
/* translators: %d: maximum story title length in characters. */
(0,r._n)("Don't exceed %d character","Don't exceed %d characters",70,"web-stories"),70)))},storyMissingPoster:{title:(0,r.__)("Add poster image","web-stories"),footer:n.createElement(n.Fragment,null,n.createElement("li",null,(0,r.__)("Use as a representation of the story","web-stories")),n.createElement("li",null,(0,r.__)("Avoid images with embedded text","web-stories")),n.createElement("li",null,(0,o.default)(
/* translators: %s: image dimensions.  */
(0,r.__)("Use an image that's at least %s","web-stories"),"640x853px")),n.createElement("li",null,(0,o.default)(
/* translators: %s: aspect ratio.  */
(0,r.__)("Maintain a %s aspect ratio","web-stories"),"3:4")))},videoMissingPoster:{title:(0,r.__)("Add poster image to every video","web-stories"),footer:(0,r.__)("Ensure a better experience by displaying a poster while users wait for the video to load","web-stories")},storyTitleTooLong:{title:(0,o.default)(
/* translators: %d: maximum number of story characters. */
(0,r._n)("Shorten title to fewer than %d character","Shorten title to fewer than %d characters",70,"web-stories"),70),footer:(0,o.default)(
/* translators: %d: maximum number of story characters. */
(0,r._n)("Limit story title to %d character or less","Limit story title to %d characters or less",70,"web-stories"),70)},logoTooSmall:{title:(0,o.default)(
/* translators: %s: image dimensions. */
(0,r.__)("Increase size of publisher logo to at least %s","web-stories"),"96x96px"),footer:n.createElement(n.Fragment,null,n.createElement("li",null,(0,o.default)(
/* translators: %s: image dimensions. */
(0,r.__)("Use an image that's at least %s","web-stories"),"96x96px")),n.createElement("li",null,(0,o.default)(
/* translators: %s: aspect ratio.  */
(0,r.__)("Maintain a %s aspect ratio","web-stories"),"1x1px")))},noPublisherLogo:{title:(0,r.__)("Add a publisher logo to your story","web-stories"),footer:n.createElement(n.Fragment,null,n.createElement("li",null,(0,o.default)(
/* translators: %s: image dimensions. */
(0,r.__)("Use an image that's at least %s","web-stories"),"96x96px")),n.createElement("li",null,(0,o.default)(
/* translators: %s: aspect ratio.  */
(0,r.__)("Maintain a %s aspect ratio","web-stories"),"1x1px")))},storyPosterSize:{title:(0,o.default)(
/* translators: %s: image dimensions.  */
(0,r.__)("Correct poster image aspect ratio to %s","web-stories"),"640x853px"),footer:n.createElement(n.Fragment,null,n.createElement("li",null,(0,o.default)(
/* translators: %s: image dimensions.  */
(0,r.__)("Use an image that's at least %s","web-stories"),"640x853px")),n.createElement("li",null,(0,o.default)(
/* translators: %s: aspect ratio.  */
(0,r.__)("Maintain a %s aspect ratio","web-stories"),"3:4")))},videoNotOptimized:{title:(0,r.__)("Optimize videos","web-stories"),footer:(0,o.default)(
/* translators: %s: video resolution (720p) */
(0,r.__)("Videos larger than %s can cause slower loading and higher bandwidth costs.","web-stories"),"720p")},storyMissingPublisherName:{title:(0,r.__)("Add Site Title","web-stories")},ampValidation:{title:(0,r.__)("Compatibility","web-stories"),footer:n.createElement(i.default,{mapping:{a:n.createElement(s.Link,{href:(0,r.__)("https://wp.stories.google/docs/","web-stories"),rel:"noreferrer",target:"_blank",onClick:e=>(0,l.trackClick)(e,"click_checklist_amp_test"),size:u.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.X_SMALL})}},(0,r.__)("Your story contains errors that can affect eligibility to appear on Google. Please see <a>our FAQ</a> for more information.","web-stories"))}},R={UNAVAILABLE:"unavailable",ONLY_RECOMMENDED:"recommended",ALL:"all"},B={[R.UNAVAILABLE]:[],[R.ONLY_RECOMMENDED]:[L.ACCESSIBILITY,L.DESIGN],[R.ALL]:Object.values(L)},D={[R.UNAVAILABLE]:null,[R.ONLY_RECOMMENDED]:L.DESIGN,[R.ALL]:L.PRIORITY}},35466:(e,t,a)=>{a.d(t,{ChecklistCategoryProvider:()=>ChecklistCategoryProvider,ChecklistCountProvider:()=>ChecklistCountProvider,useCategoryCount:()=>d,useHasChecklist:()=>m,useIsChecklistEmpty:()=>c,useRegisterCheck:()=>u});var n=a(67294),r=a(35343),o=a(84082);const i=(0,r.createContext)(null),l=(0,r.createContext)(null),s={[o.ISSUE_TYPES.PRIORITY]:{},[o.ISSUE_TYPES.DESIGN]:{},[o.ISSUE_TYPES.ACCESSIBILITY]:{}};function ChecklistCountProvider(e){let{hasChecklist:t,children:a}=e;const o=(0,r.useState)({...s,hasChecklist:t});return n.createElement(i.Provider,{value:o},a)}function ChecklistCategoryProvider(e){let{children:t,category:a}=e;const o=(0,r.useContext)(i)?.[1];if(!o)throw new Error("Cannot use `ChecklistCategoryProvider` outside of `ChecklistCountProvider`");const s=(0,r.useCallback)((e=>o((t=>({...t,[a]:{...t[a],...e}})))),[a,o]);return n.createElement(l.Provider,{value:s},t)}function u(e,t){const a=(0,r.useContext)(l);if(!a)throw new Error("Cannot use `useRegisterCheck` outside of `ChecklistCategoryProvider`");(0,r.useEffect)((()=>a({[e]:t})),[e,a,t])}function c(){const e=(0,r.useContext)(i)?.[0];if(!e)throw new Error("Cannot use `useIsChecklistEmpty` outside of `ChecklistCountProvider`");return Object.values(e).map((e=>Object.values(e))).flatMap((e=>e)).filter((e=>e)).length>0}function d(e){const t=(0,r.useContext)(i)?.[0];if(!t)throw new Error("Cannot use `useCategoryCount` outside of `ChecklistCountProvider`");return Object.values(t[e]||{}).filter((e=>e)).length}function m(){const e=(0,r.useContext)(i)?.[0];if(!e)throw new Error("Cannot use `useHasChecklist` outside of `ChecklistCountProvider`");const{hasChecklist:t}=e;return t}},93841:(e,t,a)=>{a.d(t,{useIsChecklistMounted:()=>r});a(67294),a(35343),a(26613),a(52601);var n=a(55394);function r(){return(0,n.useChecklist)((e=>{let{state:t}=e;return t.isChecklistMounted}))}},96382:(e,t,a)=>{a.d(t,{PanelText:()=>c,StyledTablistPanel:()=>u,getTabPanelMaxHeight:()=>s});var n=a(58804),r=a(58286),o=a(71314),i=a(72267),l=(a(28249),a(44993),a(36422));const s=e=>{if(e)return`100vh - ${l.NAVIGATION_HEIGHT+60*e+l.DISTANCE_FROM_TOP+l.DISTANCE_FROM_BOTTOM}px`},u=(0,n.default)(i.default).withConfig({displayName:"styles__StyledTablistPanel",componentId:"sc-1rujego-0"})(["height:",";visibility:",";button{display:",";}"],(e=>{let{badgeCount:t}=e;return 0===t?0:"auto"}),(e=>{let{badgeCount:t}=e;return 0===t?"hidden":"visible"}),(e=>{let{badgeCount:t}=e;return 0===t?"none":"auto"})),c=(0,n.default)(r.Text).attrs({size:o.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.SMALL}).withConfig({displayName:"styles__PanelText",componentId:"sc-1rujego-1"})(["color:",";"],(e=>{let{theme:t}=e;return t.colors.fg.secondary}))},67339:(e,t,a)=>{a.d(t,{Toggle:()=>Toggle});var n=a(67294),r=a(35343),o=a(58804),i=a(58167),l=a(65197),s=a(27699),u=a(59042),c=a(35466),d=a(72063),m=a(84082),p=a(98047);const f=(0,o.default)(s.default).withConfig({displayName:"toggle__MainIcon",componentId:"sc-1kcse2p-0"})(["height:32px;width:auto;display:block;"]),g=(0,o.default)(u.ToggleButton).withConfig({displayName:"toggle__StyledToggleButton",componentId:"sc-1kcse2p-1"})(["display:block;background-color:",";"],(e=>{let{theme:t}=e;return t.colors.bg.primary}));function Toggle(e){let{isOpen:t=!1,popupId:a="",onClick:o=p.noop}=e;const s=(0,c.useCategoryCount)(m.ISSUE_TYPES.PRIORITY),{checkpoint:u}=(0,d.useCheckpoint)((e=>{let{state:{checkpoint:t}}=e;return{checkpoint:t}})),h=(0,r.useMemo)((()=>u===m.PPC_CHECKPOINT_STATE.ALL?s:0),[u,s]);return n.createElement(g,{"aria-owns":a,onClick:o,isOpen:t,MainIcon:f,label:(0,i.__)("Checklist","web-stories"),"aria-label":h>0?(0,l.default)(
/* translators: %s:  number of unaddressed issues. */
(0,i._n)("Checklist: %s unaddressed issue","Checklist: %s unaddressed issues",h,"web-stories"),h):(0,i.__)("Checklist","web-stories"),notificationCount:h})}},99690:(e,t,a)=>{function n(e,t){return(e||[]).flatMap((e=>(e?.elements||[]).map((t=>({...t,pageId:e.id}))))).filter(t)}a.d(t,{filterStoryElements:()=>n})},99236:(e,t,a)=>{function n(e,t){return(e||[]).filter(t)}a.d(t,{filterStoryPages:()=>n})},44978:(e,t,a)=>{function n(e){return""===(e.featuredMedia?.url?.trim()||"")}a.d(t,{hasNoFeaturedMedia:()=>n})},11209:(e,t,a)=>{a.d(t,{default:()=>ChecklistCard});var n=a(67294),r=a(28633),o=a(71314),i=a(88858),l=a(58965);var s=a(89353);function u(){return u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},u.apply(this,arguments)}const ChecklistCard=e=>{let{cardType:t=l.CARD_TYPE.SINGLE_ISSUE,className:a,title:c,titleProps:d,footer:m,cta:p,thumbnails:f}=e,g=0;f&&(g=Array.isArray(f)?f.length:1);const h=(e=>{let{cardType:t,thumbnailCount:a,hasCta:n}=e;return t===l.CARD_TYPE.SINGLE_ISSUE?a>0?l.GRID_VARIANT.SINGLE_WITH_THUMBNAIL:l.GRID_VARIANT.SINGLE:t===l.CARD_TYPE.MULTIPLE_ISSUE&&a?n?a<=4?l.GRID_VARIANT.MULTIPLE_WITH_THUMBNAIL_WITH_CTA:l.GRID_VARIANT.MULTIPLE_WITH_THUMBNAIL_WITH_CTA_OVERFLOW:a<=4?l.GRID_VARIANT.MULTIPLE_WITH_THUMBNAIL:l.GRID_VARIANT.MULTIPLE_WITH_THUMBNAIL_OVERFLOW:l.GRID_VARIANT.DEFAULT})({cardType:t,thumbnailCount:g,hasCta:Boolean(p)});return n.createElement(s.Wrapper,{className:a},n.createElement(s.Container,{gridVariant:h},n.createElement(s.Title,u({as:d?.onClick?"button":"div"},d),n.createElement(r.Headline,{size:o.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.XXX_SMALL,as:"h2"},c)),n.createElement(i.default,null,f),n.createElement(s.Cta,null,p),n.createElement(s.Footer,null,m)))}},58965:(e,t,a)=>{a.d(t,{CARD_TYPE:()=>n,GRID_TEMPLATE_AREA:()=>o,GRID_VARIANT:()=>r,MAX_THUMBNAILS_DISPLAYED:()=>i});const n={SINGLE_ISSUE:"single_issue",MULTIPLE_ISSUE:"multiple_issue"},r={SINGLE_WITH_THUMBNAIL:"single_with_thumbnail",SINGLE:"single",DEFAULT:"single",MULTIPLE_WITH_THUMBNAIL:"multiple_with_thumbnail",MULTIPLE_WITH_THUMBNAIL_WITH_CTA:"multiple_with_thumbnail_with_cta",MULTIPLE_WITH_THUMBNAIL_OVERFLOW:" multiple_with_thumbnail_overflow"},o={[r.SINGLE]:"'title title title title' 'cta cta cta thumbnail' 'footer footer footer footer'",[r.SINGLE_WITH_THUMBNAIL]:"'title title title thumbnail' 'cta cta cta thumbnail' 'footer footer footer footer'",[r.MULTIPLE_WITH_THUMBNAIL]:"'title title title title' 'thumbnail thumbnail thumbnail thumbnail' 'footer footer footer footer'",[r.MULTIPLE_WITH_THUMBNAIL_WITH_CTA]:"'title title title title' 'thumbnail thumbnail thumbnail thumbnail' 'cta cta cta cta' 'footer footer footer footer'",[r.MULTIPLE_WITH_THUMBNAIL_WITH_CTA_OVERFLOW]:"'title title title title' 'thumbnail thumbnail thumbnail thumbnail' 'cta cta cta cta' 'footer footer footer footer'",[r.MULTIPLE_WITH_THUMBNAIL_OVERFLOW]:"'title title title title' 'thumbnail thumbnail thumbnail thumbnail' 'footer footer footer footer'"},i=3},8236:(e,t,a)=>{a.d(t,{DefaultFooterText:()=>DefaultFooterText});var n=a(67294),r=a(58286),o=a(71314);function i(){return i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},i.apply(this,arguments)}const DefaultFooterText=e=>{let{children:t,...a}=e;return n.createElement(r.Text,i({size:o.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.X_SMALL},a),t)}},89353:(e,t,a)=>{a.r(t),a.d(t,{CardListWrapper:()=>y,CheckboxCtaContainer:()=>b,CheckboxCtaLabel:()=>_,Container:()=>g,Cta:()=>E,Footer:()=>S,StyledOverflowThumbnail:()=>T,StyledVideoOptimizationIcon:()=>C,Title:()=>h,Wrapper:()=>f});var n=a(45697),r=a.n(n),o=a(58804),i=a(83506),l=a(58286),s=a(71314),u=a(7192),c=(a(44993),a(89574),a(67294),a(50014),a(72077)),d=(a(46345),a(35343),a(54e3),a(28377),a(40823),a(55537),a(84296),a(17166),a(40169),a(89703),a(19040),a(89157),a(29184),a(73393),a(26613),a(70746),a(60211),a(13851),a(76129),a(11606),a(37890),a(30738),a(50067),a(28410),a(24763),a(21303),a(34639),a(93909),a(39751),a(9219),a(79074),a(12221),a(41657),a(249),a(32696),a(63594),a(16243),a(77850),a(697),a(65290),a(80951),a(73071),a(7377),a(55376),a(24355),a(62313),a(83859),a(58965)),m=a(36422);const{focusableOutlineCSS:p}=i,f=o.default.div.withConfig({displayName:"styles__Wrapper",componentId:"sc-1nhlyv8-0"})(["width:","px;display:flex;border-radius:4px;background:",";margin:8px 0;"],m.CARD_WIDTH,(e=>{let{theme:t}=e;return t.colors.bg.secondary})),g=o.default.div.withConfig({displayName:"styles__Container",componentId:"sc-1nhlyv8-1"})(["width:240px;display:grid;margin:16px;grid-gap:8px;grid-template-columns:52px 52px 52px 52px;",""],(e=>{let{gridVariant:t}=e;return(0,o.css)(["grid-template-areas:",";"],d.GRID_TEMPLATE_AREA[t])}));g.propTypes={gridVariant:r().oneOf(Object.values(d.GRID_VARIANT))};const h=o.default.div.withConfig({displayName:"styles__Title",componentId:"sc-1nhlyv8-2"})(["grid-area:title;&:is(button){display:flex;outline:none;margin:0;padding:0;background-color:transparent;border:none;text-align:left;cursor:pointer;border-radius:",";",";}"],(e=>{let{theme:t}=e;return t.borders.radius.small}),(e=>{let{theme:t}=e;return p(t.colors.border.focus,t.colors.bg.secondary)})),E=o.default.div.withConfig({displayName:"styles__Cta",componentId:"sc-1nhlyv8-3"})(["grid-area:cta;margin:0;"]),_=(0,o.default)(l.Text).attrs({forwardedAs:"label",size:s.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.SMALL}).withConfig({displayName:"styles__CheckboxCtaLabel",componentId:"sc-1nhlyv8-4"})(["color:",";"],(e=>{let{theme:t}=e;return t.colors.fg.linkNormal})),b=o.default.div.withConfig({displayName:"styles__CheckboxCtaContainer",componentId:"sc-1nhlyv8-5"})(["display:flex;align-items:center;margin:14px 0 6px;label{margin:0 8px;}"]),T=(0,o.default)(c.default).withConfig({displayName:"styles__StyledOverflowThumbnail",componentId:"sc-1nhlyv8-6"})(["width:52px;cursor:pointer;"]),S=o.default.div.withConfig({displayName:"styles__Footer",componentId:"sc-1nhlyv8-7"})(["grid-area:footer;padding-top:8px;border-top:1px solid ",";& > *{color:",";}"],(e=>{let{theme:t}=e;return t.colors.divider.primary}),(e=>{let{theme:t}=e;return t.colors.fg.secondary})),y=o.default.div.withConfig({displayName:"styles__CardListWrapper",componentId:"sc-1nhlyv8-8"})(["margin-left:16px;li{color:",";}"],(e=>{let{theme:t}=e;return t.colors.fg.secondary})),C=(0,o.default)(u.default).withConfig({displayName:"styles__StyledVideoOptimizationIcon",componentId:"sc-1nhlyv8-9"})(["rect{color:",";}path{color:",";}"],(e=>{let{theme:t}=e;return t.colors.opacity.black64}),(e=>{let{theme:t}=e;return t.colors.fg.primary}))},65744:(e,t,a)=>{a.d(t,{default:()=>Dialog});var n=a(67294),r=a(35343),o=a(58804),i=a(90949),l=a(77904),s=a(74350),u=a(21275),c=a(36683);function d(){return d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},d.apply(this,arguments)}const Dialog=e=>{let{onClose:t,onSecondary:a,onPrimary:m,primaryText:p,secondaryText:f,primaryRest:g,secondaryRest:h,actions:E,children:_,...b}=e;const T=(0,r.useMemo)((()=>p&&n.createElement(i.Button,d({type:l.BUTTON_TYPES.PRIMARY,size:l.BUTTON_SIZES.SMALL,onClick:()=>m?.()},g),p)),[p,g,m]),S=(0,r.useMemo)((()=>f&&n.createElement(i.Button,d({type:l.BUTTON_TYPES.TERTIARY,size:l.BUTTON_SIZES.SMALL,onClick:()=>a?.()||t()},h),f)),[f,h,a,t]);return n.createElement(o.ThemeProvider,{theme:{...s.theme,colors:u.light}},n.createElement(c.Dialog,d({onClose:t},b,{actions:E||n.createElement(n.Fragment,null,S,T)}),_))}},86807:(e,t,a)=>{a.d(t,{default:()=>DirectionAware});var n=a(67294),r=a(58804),o=a(14194),i=(a(55537),a(84296),a(35343),a(17166),a(40169),a(89703),a(54e3),a(28377),a(97506));a(40823),a(19040),a(89157),a(29184),a(73393),a(26613),a(70746),a(60211),a(13851),a(46345),a(76129),a(11606),a(37890),a(30738),a(50067),a(28410),a(24763),a(21303),a(34639),a(93909),a(39751),a(9219),a(79074),a(12221),a(41657),a(249),a(32696),a(63594),a(16243),a(77850),a(697),a(65290),a(80951),a(73071),a(7377),a(55376),a(24355),a(62313),a(83859);Object.defineProperty(o.default,"name",{value:"stylisRTLPlugin"});const l=[o.default],s=[];function DirectionAware(e){let{children:t}=e;const{isRTL:a}=(0,i.default)();return n.createElement(r.StyleSheetManager,{stylisPlugins:a?l:s},t)}},50869:(e,t,a)=>{a.d(t,{default:()=>c});var n=a(67294),r=a(35343),o=a(58167),i=a(36779),l=(a(55537),a(84296),a(17166),a(40169),a(89703),a(54e3),a(28377),a(40823),a(19040),a(89157),a(29184)),s=(a(73393),a(28951));a(26613),a(70746),a(60211),a(13851),a(46345),a(76129),a(11606),a(37890),a(30738),a(50067),a(28410),a(24763),a(21303),a(34639),a(93909),a(39751),a(9219),a(79074),a(12221),a(41657),a(249),a(32696),a(63594),a(16243),a(77850),a(697),a(65290),a(80951),a(73071),a(7377),a(55376),a(24355),a(62313),a(83859);function u(){return u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},u.apply(this,arguments)}const c=(0,r.forwardRef)((function FontPicker(e,t){let{zIndex:a,onChange:c,currentValue:d,highlightStylesOverride:m,showDropdownLabel:p,listStyleOverrides:f,containerStyleOverrides:g,className:h,tabIndex:E}=e;const{fonts:_=[],recentFonts:b=[],curatedFonts:T=[],customFonts:S=[],ensureMenuFontsLoaded:y,ensureCustomFontsLoaded:C,getFontsBySearch:I,getCustomFonts:w,getCuratedFonts:v}=(0,s.default)((e=>{let{actions:t,state:a}=e;return{getFontsBySearch:t.getFontsBySearch,ensureMenuFontsLoaded:t.ensureMenuFontsLoaded,ensureCustomFontsLoaded:t.ensureCustomFontsLoaded,getCuratedFonts:t.getCuratedFonts,getCustomFonts:t.getCustomFonts,recentFonts:a.recentFonts,curatedFonts:a.curatedFonts,fonts:a.fonts,customFonts:a.customFonts}}));(0,r.useEffect)((()=>{w(),v()}),[w,v]);const P=(0,r.useMemo)((()=>{const e=new Map;return _.forEach((t=>{e.set(t.id,t)})),S?.forEach((t=>{e.set(t.id,t)})),e}),[_,S]),A=(0,r.useCallback)((e=>{e.length&&(y(e.filter((e=>"fonts.google.com"===P.get(e)?.service))),C(e.filter((e=>"custom"===P.get(e)?.service))))}),[P,C,y]),k=(0,r.useCallback)(((e,t)=>{let{option:a,...r}=e;return n.createElement(i.default.Option,u({ref:t},r,{fontFamily:"fonts.google.com"===a.service?`'${a.name}::MENU'`:a.name}),d===a.id&&n.createElement(i.default.Selected,{"aria-label":(0,o.__)("Selected","web-stories")}),a.name)}),[d]),L=(0,r.useMemo)((()=>[...S?.length?[{label:(0,o.__)("Your fonts","web-stories"),options:S}]:[],...b?.length?[{label:(0,o.__)("Recently used","web-stories"),options:b}]:[]]),[S,b]);return n.createElement(i.default.DropDown,{ref:t,zIndex:a,tabIndex:E,highlightStylesOverride:m,"data-testid":"font",title:(0,o.__)("Available font families","web-stories"),dropdownButtonLabel:(0,o.__)("Font family","web-stories"),options:_,primaryOptions:T,primaryLabel:(0,o.__)("Recommended","web-stories"),priorityOptionGroups:L,searchResultsLabel:(0,o.__)("Search results","web-stories"),selectedId:l.MULTIPLE_VALUE===d?"":d,placeholder:l.MULTIPLE_VALUE===d?l.MULTIPLE_DISPLAY_VALUE:d,hasSearch:!0,getOptionsByQuery:I,onChange:c,onObserve:A,renderer:(0,r.forwardRef)(k),disabled:!_?.length,dropDownLabel:p?(0,o.__)("Font","web-stories"):null,listStyleOverrides:f,containerStyleOverrides:g,className:h})}))},47299:(e,t,a)=>{a.d(t,{default:()=>DatePicker});var n=a(67294),r=a(35343),o=a(58804),i=a(58167),l=a(2825);const s=o.default.div.withConfig({displayName:"calendarWrapper__CalendarWrapper",componentId:"sc-u1av1j-0"})(["min-height:236px;.react-calendar{width:350px;max-width:100%;background:white;border:1px solid #a0a096;font-family:Arial,Helvetica,sans-serif;line-height:1.125em;}.react-calendar--doubleView{width:700px;}.react-calendar--doubleView .react-calendar__viewContainer{display:flex;margin:-0.5em;}.react-calendar--doubleView .react-calendar__viewContainer > *{width:50%;margin:0.5em;}.react-calendar,.react-calendar *,.react-calendar *:before,.react-calendar *:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;}.react-calendar button{margin:0;border:0;outline:none;}.react-calendar button:enabled:hover{cursor:pointer;}.react-calendar__navigation{display:flex;height:44px;margin-bottom:1em;}.react-calendar__navigation button{min-width:44px;background:none;}.react-calendar__navigation button:disabled{background-color:#f0f0f0;}.react-calendar__navigation button:enabled:hover,.react-calendar__navigation button:enabled:focus{background-color:#e6e6e6;}.react-calendar__month-view__weekdays{text-align:center;text-transform:uppercase;font-weight:bold;font-size:0.75em;}.react-calendar__month-view__weekdays__weekday{padding:0.5em;}.react-calendar__month-view__weekNumbers .react-calendar__tile{display:flex;align-items:center;justify-content:center;font-size:0.75em;font-weight:bold;}.react-calendar__month-view__days__day--weekend{color:#d10000;}.react-calendar__month-view__days__day--neighboringMonth{color:#757575;}.react-calendar__year-view .react-calendar__tile,.react-calendar__decade-view .react-calendar__tile,.react-calendar__century-view .react-calendar__tile{padding:2em 0.5em;}.react-calendar__tile{max-width:100%;padding:10px 6.6667px;background:none;text-align:center;line-height:16px;}.react-calendar__tile:disabled{background-color:#f0f0f0;}.react-calendar__tile:enabled:hover,.react-calendar__tile:enabled:focus{background-color:#e6e6e6;}.react-calendar__tile--now{background:#ffff76;}.react-calendar__tile--now:enabled:hover,.react-calendar__tile--now:enabled:focus{background:#ffffa9;}.react-calendar__tile--hasActive{background:#76baff;}.react-calendar__tile--hasActive:enabled:hover,.react-calendar__tile--hasActive:enabled:focus{background:#a9d4ff;}.react-calendar__tile--active{background:#006edc;color:white;}.react-calendar__tile--active:enabled:hover,.react-calendar__tile--active:enabled:focus{background:#1087ff;}.react-calendar--selectRange .react-calendar__tile--hover{background-color:#e6e6e6;}"]),u=(0,r.lazy)((()=>a.e(2392).then(a.bind(a,73)))),c=o.default.div.withConfig({displayName:"datePicker__FallbackCalendar",componentId:"sc-9qun1q-0"})(["height:256px;width:350px;display:flex;align-items:center;justify-content:center;"]);function DatePicker(e){let{currentDate:t,onChange:a,onViewChange:o}=e;const d=(0,r.useRef)(),m=(0,r.useMemo)((()=>new Date(t)),[t]),p=(0,r.useCallback)((e=>{e.setHours(m.getHours()),e.setMinutes(m.getMinutes()),a(e.toISOString(),!0)}),[m,a]),f=(0,r.useCallback)((function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(d.current){const t=[...d.current.querySelectorAll(".react-calendar__navigation button")];t[0].tabIndex="0",t.shift();for(const e of t)e.tabIndex="-1";const a=[...d.current.querySelectorAll(".react-calendar__viewContainer button")];let n=!1;for(const t of a)t.classList.contains("react-calendar__tile--now")?(t.tabIndex="0",e&&t.focus(),n=!0):t.tabIndex="-1";n||(a[0].tabIndex="0",a[0].focus())}}),[d]);return(0,r.useEffect)((()=>{const e=setTimeout((()=>{f()}));return()=>{clearTimeout(e)}}),[f]),n.createElement(r.Suspense,{fallback:n.createElement(c,null,n.createElement(l.default,null))},n.createElement(s,{ref:d},n.createElement(u,{value:m,onChange:p,onViewChange:o,onActiveStartDateChange:()=>f(!0),nextAriaLabel:(0,i._x)("Next","This label can apply to next month, year and/or decade","web-stories"),prevAriaLabel:(0,i._x)("Previous","This label can apply to previous month, year and/or decade","web-stories"),next2AriaLabel:(0,i._x)("Jump forward","This label can apply to month, year and/or decade","web-stories"),prev2AriaLabel:(0,i._x)("Jump backwards","This label can apply to month, year and/or decade","web-stories")})))}},11912:(e,t,a)=>{a.d(t,{default:()=>TimePicker});var n=a(67294),r=a(58804),o=a(58167),i=a(35343),l=a(92790),s=a(58286),u=a(38421),c=a(71314),d=a(31271);const m=r.default.div.withConfig({displayName:"timeZone__Wrapper",componentId:"sc-1n80l1r-0"})(["white-space:nowrap;"]),p=(0,r.default)(s.Text).withConfig({displayName:"timeZone__StyledText",componentId:"sc-1n80l1r-1"})(["color:",";line-height:30px;"],(e=>{let{theme:t}=e;return t.colors.fg.disable}));function TimeZone(e){let{date:t}=e;const{timezone:a,gmtOffset:r}=(0,l.getSettings)(),i=(new Date).getTimezoneOffset()/60*-1;if(Number(r)===i)return null;const{timeZone:s}=(0,l.getOptions)(),f=a?.length?(0,l.format)(t,"T"):`UTC${s}`,g="UTC"===f?(0,o.__)("Coordinated Universal Time","web-stories"):a;return n.createElement(m,null,n.createElement(d.default,{hasTail:!0,title:g,placement:u.PLACEMENT.TOP},n.createElement(p,{forwardedAs:"span",size:c.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.X_SMALL},f)))}const f=r.default.div.withConfig({displayName:"timePicker__TimeWrapper",componentId:"sc-14og2kb-0"})(["margin-bottom:1em;padding:0 20px;"]),g=r.default.fieldset.withConfig({displayName:"timePicker__Fieldset",componentId:"sc-14og2kb-1"})(["margin-top:0.5em;position:relative;"]),h=r.default.legend.withConfig({displayName:"timePicker__Legend",componentId:"sc-14og2kb-2"})(["position:absolute;top:-999em;left:-999em;"]),E=r.default.div.withConfig({displayName:"timePicker__InputRow",componentId:"sc-14og2kb-3"})(["display:flex;"]),_=(0,r.css)(["min-height:30px;box-shadow:0 0 0 transparent;transition:box-shadow 0.1s linear;border-radius:4px;border:1px solid #006edc;height:28px;vertical-align:middle;background-color:",";color:#32373c;"],(e=>{let{theme:t}=e;return t.colors.standard.white})),b=r.default.input.withConfig({displayName:"timePicker__NumberInput",componentId:"sc-14og2kb-4"})([""," padding:0;margin-right:4px;text-align:center;width:50%;max-width:50px;::-webkit-inner-spin-button,::-webkit-outer-spin-button{margin:0;appearance:none;}"],_),T=r.default.span.withConfig({displayName:"timePicker__TimeSeparator",componentId:"sc-14og2kb-5"})(["padding:0 3px 0 0;color:#555d66;"]),S=r.default.button.withConfig({displayName:"timePicker__Button",componentId:"sc-14og2kb-6"})(["display:inline-flex;text-decoration:none;font-size:13px;margin:0;border:0;cursor:pointer;transition:box-shadow 0.1s linear;padding:0 10px;line-height:2;height:30px;border-radius:3px;white-space:nowrap;border-width:1px;border-style:solid;color:#006edc;border-color:#006edc;background:#f3f5f6;&:focus{outline:2px solid transparent;background:#f3f5f6;color:rgb(0,93,140);border-color:",";box-shadow:0 0 0 1px ",";text-decoration:none;}",""],(e=>{let{theme:t}=e;return t.colors.fg.linkHover}),(e=>{let{theme:t}=e;return t.colors.fg.linkHover}),(e=>{let{isToggled:t}=e;return t&&"\n  background: #edeff0;\n  border-color: #8f98a1;\n  box-shadow: inset 0 2px 5px -3px #555d66;\n  "})),y=r.default.div.withConfig({displayName:"timePicker__InputGroup",componentId:"sc-14og2kb-7"})(["flex-basis:100%;"]),C=(0,r.default)(S).withConfig({displayName:"timePicker__AMButton",componentId:"sc-14og2kb-8"})(["margin-right:-1px;border-radius:3px 0 0 3px;"]),I=(0,r.default)(S).withConfig({displayName:"timePicker__PMButton",componentId:"sc-14og2kb-9"})(["margin-left:-1px;border-radius:0 3px 3px 0;"]);function TimePicker(e){let{onChange:t,is12Hour:a,localData:r,setLocalData:l}=e;const s=e=>t=>{l({...r,[e]:parseInt(t.target.value)})},u=()=>a?12:23,c=()=>a?1:0,d=e=>{const{am:t}=r;return a?"AM"===t?e%12:(e%12+12)%24:e},m=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};l({...r,...a,date:e}),t(e.toISOString())},p=e=>()=>{const{am:t,date:a,hours:n}=r;if(t===e)return;const o=a;"PM"===e?o.setHours((n%12+12)%24):o.setHours(n%12),m(o,{am:e})},_=(0,i.useRef)();(0,i.useEffect)((()=>{_.current.focus()}),[]);const S="AM"===r.am,w="PM"===r.am;return n.createElement(f,null,n.createElement(g,null,n.createElement(h,null,(0,o.__)("Time","web-stories")),n.createElement(E,null,n.createElement(y,null,n.createElement(b,{ref:_,"aria-label":(0,o.__)("Hours","web-stories"),type:"number",step:1,min:c(),max:u(),value:parseInt(r.hours),onChange:s("hours"),onBlur:()=>{const{hours:e,date:t}=r,a=parseInt(e);if(!(isNaN(a)||a<c()||a>u())&&t.getHours()!==d(e)){const a=t;a.setHours(d(e)),m(a)}}}),n.createElement(T,null,":"),n.createElement(b,{"aria-label":(0,o.__)("Minutes","web-stories"),type:"number",min:0,max:59,value:parseInt(r.minutes),onChange:s("minutes"),onBlur:()=>{const{minutes:e,date:t}=r,a=parseInt(e);if(!(isNaN(a)||a<0||a>59)&&t.getMinutes()!==e){const a=t;a.setMinutes(e),m(a)}}})),a&&n.createElement(y,null,n.createElement(C,{"aria-pressed":S,type:"button",isToggled:S,onClick:p("AM")},(0,o.__)("AM","web-stories")),n.createElement(I,{"aria-pressed":w,type:"button",isToggled:w,tabIndex:"-1",onClick:p("PM")},(0,o.__)("PM","web-stories"))),n.createElement(TimeZone,{date:r?.date}))))}},13618:(e,t,a)=>{a.d(t,{default:()=>MediaUploadButton});var n=a(67294),r=a(27227),o=a(35343),i=a(97775),l=a(58167),s=a(65197),u=a(94955),c=(a(55537),a(84296),a(17166),a(40169),a(89703),a(54e3),a(28377),a(97506)),d=(a(40823),a(19040),a(89157),a(29184),a(73393),a(26613),a(70746),a(60211),a(13851),a(46345),a(76129),a(11606),a(37890),a(30738),a(50067),a(28410),a(24763),a(21303),a(34639),a(93909),a(39751),a(9219),a(79074)),m=(a(12221),a(41657),a(249),a(32696),a(88476)),p=a(49599);a(63594),a(16243),a(77850),a(697),a(65290),a(80951),a(73071),a(7377),a(55376),a(24355),a(62313),a(83859);function MediaUploadButton(e){let{onInsert:t,renderButton:a,buttonInsertText:f}=e;const{allowedMimeTypes:{image:g,vector:h,video:E},MediaUpload:_}=(0,c.default)(),b=(0,o.useMemo)((()=>[...g,...h,...E]),[g,h,E]),T=(0,o.useMemo)((()=>b.map((e=>(0,i.getExtensionsFromMimeType)(e))).flat()),[b]),{canTranscodeResource:S,resetWithFetch:y,postProcessingResource:C,optimizeVideo:I,optimizeGif:w}=(0,m.default)((e=>{let{state:{canTranscodeResource:t},actions:{resetWithFetch:a,postProcessingResource:n,optimizeVideo:r,optimizeGif:o}}=e;return{canTranscodeResource:t,resetWithFetch:a,postProcessingResource:n,optimizeVideo:r,optimizeGif:o}})),{isTranscodingEnabled:v}=(0,d.default)(),{showSnackbar:P}=(0,r.useSnackbar)(),A=(0,o.useMemo)((()=>v?[...p.TRANSCODABLE_MIME_TYPES,...g,...h,...E]:[...g,...h,...E]),[g,h,E,v]),k=(0,o.useMemo)((()=>p.TRANSCODABLE_MIME_TYPES.filter((e=>!E.includes(e)))),[E]);let L=(0,l.__)("No file types are currently supported.","web-stories");T.length&&(L=(0,s.default)(
/* translators: %s: list of allowed file types. */
(0,l.__)("Please choose only %s to insert into page.","web-stories"),(0,u.default)(T)));const N=(0,o.useCallback)((e=>{try{v&&S(e)&&(k.includes(e.mimeType)&&I({resource:e}),"image/gif"===e.mimeType&&w({resource:e})),t(e),C(e)}catch(e){P({message:e.message,dismissible:!0})}}),[v,S,t,w,I,C,P,k]);return n.createElement(_,{onSelect:N,onSelectErrorMessage:L,onClose:y,type:A,render:a,buttonInsertText:f})}},12706:(e,t,a)=>{a.d(t,{default:()=>o});var n=a(35343),r=a(8684);function o(e){const t=(0,n.useCallback)((t=>{const a=e.current;if(!a)return;const n=Array.from(a.querySelectorAll('input[type="radio"]')),r=n.indexOf(document.activeElement);if(-1===r)return;const o=r+t;o<0||o>=n.length||(n[o].focus(),n[o].click())}),[e]),a=(0,n.useCallback)((()=>t(-1)),[t]);(0,r.useKeyDownEffect)(e,["up","left"],a,[a]);const o=(0,n.useCallback)((()=>t(1)),[t]);(0,r.useKeyDownEffect)(e,["down","right"],o,[o])}},43304:(e,t,a)=>{a.d(t,{ACTIONS:()=>s,deepEquals:()=>l,default:()=>u});var n=a(61342),r=a(7328);function o(e){return e.replace(/( +)/g," ").trim()}function i(e){const t=new Map;return e.forEach((e=>{t.set((0,r.default)(e),e)})),[...t.values()]}function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.length===t.length&&e.every((e=>t.includes(e)))}const s={UPDATE_VALUE:"updateValue",SUBMIT_VALUE:"submitValue",REMOVE_TAG:"removeTag",RESET_OFFSET:"resetOffset",RESET_VALUE:"resetValue",INCREMENT_OFFSET:"incrementOffset",DECREMENT_OFFSET:"decrementOffset",UPDATE_TAGS:"updateTags"};function u(e,t){switch(t.type){case s.UPDATE_VALUE:{const a=t.payload.split(",");if(a.length<=1)return{...e,value:t.payload};const n=a.slice(0,-1).map(o).filter((e=>e.length)),r=a[a.length-1];return function(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((t=>e.includes(t)))}(n,e.tags)?{...e,value:r}:{...e,value:r,tagBuffer:i([...e.tags.slice(0,e.tags.length-e.offset),...n,...e.tags.slice(e.tags.length-e.offset)])}}case s.SUBMIT_VALUE:{const a=o(t?.payload||e.value);return""===a||e.tags.includes(a)?{...e,value:""}:{...e,value:"",tagBuffer:i([...e.tags.slice(0,e.tags.length-e.offset),a,...e.tags.slice(e.tags.length-e.offset)])}}case s.REMOVE_TAG:{const a="string"==typeof t.payload?e.tags.findIndex((e=>e===t.payload)):e.tags.length-1-e.offset;return a<0?e:{...e,tagBuffer:[...e.tags.slice(0,a),...e.tags.slice(a+1,e.tags.length)]}}case s.INCREMENT_OFFSET:return{...e,offset:(0,n.clamp)(e.offset+1,{MIN:0,MAX:e.tags.length})};case s.DECREMENT_OFFSET:return{...e,offset:(0,n.clamp)(e.offset-1,{MIN:0,MAX:e.tags.length})};case s.RESET_OFFSET:return{...e,offset:0};case s.RESET_VALUE:return{...e,value:""};case s.UPDATE_TAGS:{const a=e.tags.map((e=>[(0,r.default)(e),e])),n=t.payload.map((e=>[(0,r.default)(e),e]));if(l(a.map((e=>{let[t]=e;return t})),n.map((e=>{let[t]=e;return t}))))return e;const o=a.filter((e=>{let[t]=e;return n.map((e=>{let[t]=e;return t})).includes(t)})).map((e=>{let[,t]=e;return t})),i=n.filter((e=>{let[t]=e;return!a.map((e=>{let[t]=e;return t})).includes(t)})).map((e=>{let[,t]=e;return t}));return{...e,tags:[...o,...i],tagBuffer:null}}default:return e}}},56453:(e,t,a)=>{a.d(t,{default:()=>i});var n=a(35343),r=a(27646);function o(e){return(0,n.useContextSelector)(r.default,e??n.identity)}function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;const a=o((e=>e.registerPresubmitHandler));(0,n.useEffect)((()=>a(e)),[a].concat(t||[]))}},16852:(e,t,a)=>{a.d(t,{MAX_HEIGHT_DEFAULT:()=>p,PANEL_COLLAPSED_THRESHOLD:()=>m,default:()=>Panel});var n=a(67294),r=a(58804),o=a(44586),i=a(35343),l=a(26613),s=a(58945),u=(a(89157),a(29184),a(70746),a(60211),a(13851),a(46345),a(76129),a(11606),a(54e3),a(28377),a(40823),a(40169),a(89703),a(37890),a(30738),a(50067),a(28410),a(24763),a(21303),a(34639),a(84401)),c=a(36791);function d(){return d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},d.apply(this,arguments)}const m=10,p=999999999,f=r.default.section.withConfig({displayName:"panel__Wrapper",componentId:"sc-1vyy7rt-0"})(["display:flex;flex-direction:column;position:relative;border-bottom:1px solid ",";",""],(e=>{let{theme:t}=e;return t.colors.divider.tertiary}),(e=>{let{noBorder:t}=e;return t&&"border-bottom: none;"}));function Panel(e){let{name:t,children:a,resizable:r=!1,showDragHandle:m,showFocusStyles:g,canCollapse:h=!0,collapsedByDefault:E=!0,initialHeight:_=null,maxHeight:b=p,ariaLabel:T=null,ariaHidden:S=!1,isPersistable:y=!0,...C}=e;const I=0===b?p:b,{selectedElementIds:w}=(0,u.default)((e=>{let{state:{selectedElementIds:t}}=e;return{selectedElementIds:t}})),v=(0,i.useMemo)((()=>y?s.default.getItemByKey(`${s.LOCAL_STORAGE_PREFIX.PANEL}:${t}`):null),[t,y]),[P,A]=(0,i.useState)((()=>!!y&&(v?.isCollapsed??E))),[k,L]=(0,i.useState)(Math.min(v?.expandToHeight,I)||_),[N,x]=(0,i.useState)(Math.min(v?.height,I)||_),[O,M]=(0,i.useState)(!1),[R,B]=(0,i.useState)(!1),D=(0,i.useCallback)((e=>{x(Math.min(e,I))}),[I]),H=(0,i.useCallback)((e=>{L(Math.min(e,I))}),[I]),U=(0,i.useCallback)((()=>M(!0)),[]),Y=(0,i.useCallback)((()=>{h&&(A(!0),B(!0),r&&D(0),(0,l.trackEvent)("panel_toggled",{name:t,status:"collapsed"}))}),[r,h,t,D]),F=(0,i.useCallback)((function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];A(!1),B(!0),e&&r&&D(k),(0,l.trackEvent)("panel_toggled",{name:t,status:"expanded"})}),[r,k,t,D]);(0,i.useEffect)((()=>{y||F(!0)}),[F,y,w]),(0,i.useEffect)((()=>{r&&N<=10&&!P&&Y()}),[Y,N,r,P]),(0,i.useEffect)((()=>{R||v||!r||(D(_),H(_))}),[R,_,r,v,t,H,D]),(0,i.useEffect)((()=>{I<N&&D(I),I<k&&H(I)}),[k,N,I,D,H]),(0,i.useEffect)((()=>{y&&R&&s.default.setItemByKey(`${s.LOCAL_STORAGE_PREFIX.PANEL}:${t}`,{height:N,isCollapsed:P,expandToHeight:k})}),[t,P,N,k,R,y]);const G=(0,i.useCallback)((e=>{r&&(B(!0),D(Math.min(e(N),I)),P&&e(N)>10&&F(!1))}),[F,N,P,I,r,D,B]),j=(0,i.useCallback)((()=>{B(!1),P&&F(!0)}),[F,P]),z=`panel-${t}-${(0,o.default)()}`,V=`panel-title-${t}-${(0,o.default)()}`,W={state:{height:N,resizable:r,showDragHandle:m,showFocusStyles:g,isCollapsed:P,panelContentId:z,panelTitleId:V,panelTitleReadable:`panel-title-${t}`,ariaHidden:S},actions:{setHeight:G,setExpandToHeight:H,collapse:Y,expand:F,resetHeight:j,confirmTitle:U}},X=c.default.Provider,$=(0,i.useMemo)((()=>O?{"aria-labelledby":V}:{"aria-label":T}),[O,V,T]);return n.createElement(f,d({},$,{"aria-hidden":S},C),n.createElement(X,{value:W},a))}},42854:(e,t,a)=>{a.d(t,{default:()=>SimplePanel});var n=a(67294),r=a(16852),o=a(12983),i=a(52284);function l(){return l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},l.apply(this,arguments)}function SimplePanel(e){let{children:t,name:a,ariaLabel:s,title:u,className:c,...d}=e;return n.createElement(r.default,l({name:a},d),n.createElement(o.default,l({ariaLabel:s??("string"==typeof u?u:"")},d),u),n.createElement(i.default,{className:c},t))}},54806:(e,t,a)=>{a.d(t,{default:()=>BackgroundAudioPanelContent});var n=a(67294),r=a(58804),o=a(90949),i=a(77904),l=a(44477),s=a(16087),u=a(65197),c=a(58167),d=a(94955),m=a(35343),p=a(97775),f=a(44586),g=(a(46345),a(55537),a(84296),a(17166),a(40169),a(89703),a(54e3),a(28377),a(97506)),h=(a(40823),a(19040),a(89157),a(29184),a(73393),a(26613),a(70746),a(60211),a(13851),a(76129),a(11606),a(37890),a(30738),a(50067),a(28410),a(24763),a(21303),a(34639),a(93909),a(39751),a(9219),a(79074),a(12221),a(41657),a(249),a(32696),a(63594),a(16243),a(77850),a(697),a(65290),a(80951),a(73071),a(7377),a(55376),a(24355),a(62313),a(83859),a(36363)),E=(a(46123),a(93206),a(18800),a(40238),a(57346),a(8897)),_=(a(92056),a(42009),a(27646),a(91935),a(63632),a(73978),a(39737),a(47011),a(71314)),b=a(56782),T=a(33836),S=a(207),y=a(31271),C=a(28841);const I=(0,r.default)(o.Button).withConfig({displayName:"audioPlayer__StyledButton",componentId:"sc-cot87i-0"})(["",";"],(e=>{let{theme:t}=e;return s.focusableOutlineCSS(t.colors.border.focus,t.colors.bg.secondary)})),w=r.default.div.withConfig({displayName:"audioPlayer__Wrapper",componentId:"sc-cot87i-1"})((e=>{let{theme:t}=e;return(0,r.css)(["position:relative;min-width:40px;width:100%;height:36px;display:flex;align-items:center;justify-content:space-between;color:",";",";"],t.colors.fg.primary,S.expandPresetStyles({preset:{...t.typography.presets.paragraph[_.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.SMALL]},theme:t}))})),v=r.default.audio.withConfig({displayName:"audioPlayer__Audio",componentId:"sc-cot87i-2"})(["display:none;"]);function AudioPlayer(e){let{title:t,src:a,mimeType:r,tracks:o=[],audioId:l,loop:s}=e;const[u,d]=(0,m.useState)(!1),p=(0,m.useRef)(),{getProxiedUrl:f}=(0,C.default)(),g=(0,m.useCallback)((()=>{const e=p.current;e&&(u?e.pause():e.play().catch((()=>{})))}),[u]);(0,m.useEffect)((()=>{const e=p.current;if(!e)return;const t=()=>d(!0),a=()=>d(!1),n=()=>{e.currentTime=0,d(!1)};return e.addEventListener("play",t),e.addEventListener("pause",a),e.addEventListener("ended",n),()=>{e.removeEventListener("play",t),e.removeEventListener("pause",a),e.removeEventListener("ended",n)}}),[p]);const E=(0,c.__)(u?"Pause":"Play","web-stories"),_=o.map((e=>{const t=f(e,e?.track);return{...e,track:t}}));return n.createElement(w,null,n.createElement(v,{crossOrigin:"anonymous",loop:s,ref:p,id:l},n.createElement("source",{src:a,type:r}),_&&_.map(((e,t)=>{let{srclang:a,label:r,track:o,id:i}=e;return n.createElement("track",{srcLang:a,label:r,kind:"metadata",src:o,key:i,default:0===t})}))),n.createElement("div",null,t),n.createElement(y.default,{hasTail:!0,title:E,popupZIndexOverride:h.Z_INDEX_STORY_DETAILS},n.createElement(I,{type:i.BUTTON_TYPES.TERTIARY,size:i.BUTTON_SIZES.SMALL,variant:i.BUTTON_VARIANTS.SQUARE,"aria-label":E,onClick:g},u?n.createElement(b.default,null):n.createElement(T.default,null))))}var P=a(5306),A=a(94438);const k=(0,r.default)(o.Button).withConfig({displayName:"backgroundAudioPanelContent__StyledButton",componentId:"sc-lth4t7-0"})(["",";"],(e=>{let{theme:t}=e;return s.focusableOutlineCSS(t.colors.border.focus,t.colors.bg.secondary)})),L=(0,r.default)(k).withConfig({displayName:"backgroundAudioPanelContent__UploadButton",componentId:"sc-lth4t7-1"})(["padding:12px 8px;"]);function BackgroundAudioPanelContent(e){let{backgroundAudio:t,updateBackgroundAudio:a,showCaptions:r=!1,showLoopControl:o=!1,audioId:s}=e;const{allowedMimeTypes:{audio:_},capabilities:{hasUploadMediaAction:b},MediaUpload:T}=(0,g.default)(),S=(0,m.useMemo)((()=>_.map((e=>(0,p.getExtensionsFromMimeType)(e))).flat()),[_]),{resource:C,tracks:I=[],loop:w=!0}=t||{},v=(0,u.default)(
/* translators: %s: list of allowed file types. */
(0,c.__)("Please choose only %s to insert into page.","web-stories"),(0,d.default)(S)),N=(0,m.useCallback)((e=>{const t={resource:{src:e.src,id:e.id,mimeType:e.mimeType,length:e.length,lengthFormatted:e.lengthFormatted}};r&&(t.tracks=[]),o&&(t.loop=!0),a(t)}),[r,o,a]),x=(0,m.useCallback)((e=>{a({...t,tracks:e})}),[t,a]),O=(0,m.useCallback)((e=>{a({...t,loop:e.target.checked})}),[t,a]),M=(0,m.useCallback)((e=>{let t=[];if(e){const a=I.findIndex((t=>{let{id:a}=t;return a===e}));t=[...I.slice(0,a),...I.slice(a+1)]}x(t)}),[I,x]),R=(0,m.useCallback)((e=>{let{src:t="",id:a,needsProxy:n=!1}=e;const r={track:t,trackId:a,trackName:t.split("/").pop(),id:(0,f.default)(),kind:"captions",srclang:"",label:"",needsProxy:n};x([...I,r])}),[I,x]),B=(0,m.useCallback)((e=>n.createElement(L,{onClick:e,type:i.BUTTON_TYPES.SECONDARY,size:i.BUTTON_SIZES.SMALL,variant:i.BUTTON_VARIANTS.RECTANGLE},(0,c.__)("Upload an audio file","web-stories"))),[]),D=(0,c.__)("Upload audio captions","web-stories"),H=(0,m.useCallback)((e=>n.createElement(L,{onClick:e,type:i.BUTTON_TYPES.SECONDARY,size:i.BUTTON_SIZES.SMALL,variant:i.BUTTON_VARIANTS.RECTANGLE},D)),[D]);return n.createElement(n.Fragment,null,!C?.src&&b&&n.createElement(E.default,{expand:!0},n.createElement(T,{onSelect:N,onSelectErrorMessage:v,type:_,title:(0,c.__)("Upload an audio file","web-stories"),buttonInsertText:(0,c.__)("Select audio file","web-stories"),render:B})),C?.src&&n.createElement(n.Fragment,null,n.createElement(E.default,null,n.createElement(AudioPlayer,{title:C?.src.substring(C?.src.lastIndexOf("/")+1),src:C?.src,mimeType:C?.mimeType,tracks:I,audioId:s,loop:w}),n.createElement(y.default,{hasTail:!0,title:(0,c.__)("Remove file","web-stories"),popupZIndexOverride:h.Z_INDEX_STORY_DETAILS},n.createElement(k,{"aria-label":(0,c.__)("Remove file","web-stories"),type:i.BUTTON_TYPES.TERTIARY,size:i.BUTTON_SIZES.SMALL,variant:i.BUTTON_VARIANTS.SQUARE,onClick:()=>a(null)},n.createElement(l.default,null)))),r&&n.createElement(P.default,{captionText:D,tracks:I||[],handleChangeTrack:R,handleRemoveTrack:M,renderUploadButton:H}),o&&C?.length&&n.createElement(E.default,{spaceBetween:!1},n.createElement(A.default,{loop:w,onChange:O}))))}},5306:(e,t,a)=>{a.d(t,{default:()=>CaptionsPanelContent});var n=a(67294),r=a(58804),o=a(78955),i=a(90949),l=a(77904),s=a(44477),u=a(16087),c=a(58167),d=a(35343),m=a(97775),p=a(1745),f=(a(46123),a(93206),a(18800),a(40238),a(57346),a(55537),a(84296),a(17166),a(40169),a(89703),a(54e3),a(28377),a(97506)),g=(a(40823),a(19040),a(89157),a(29184)),h=(a(73393),a(26613)),E=(a(70746),a(60211),a(13851),a(46345),a(76129),a(11606),a(37890),a(30738),a(50067),a(28410),a(24763),a(21303),a(34639),a(93909),a(39751),a(9219),a(79074),a(12221),a(41657),a(249),a(32696),a(63594),a(16243),a(77850),a(697),a(65290),a(80951),a(73071),a(7377),a(55376),a(24355),a(62313),a(83859),a(8897)),_=(a(92056),a(42009),a(27646),a(91935),a(63632),a(73978),a(39737),a(47011),a(31271)),b=a(64428),T=a(65197),S=a(94955),y=a(50907),C=a(65744),I=a(91662),w=a(47390),v=a(28841);const P=r.default.form.withConfig({displayName:"hotlinkModal__InputWrapper",componentId:"sc-bvssi1-0"})(["margin:16px 4px;width:470px;height:100px;"]);function HotlinkModal(e){let{isOpen:t,onClose:a,onSelect:r,allowedFileTypes:i=[],title:l}=e;const[s,u]=(0,d.useState)(!1),[m,p]=(0,d.useState)(""),[f,g]=(0,d.useState)(!1),E=(0,d.useRef)(null),{actions:{getHotlinkInfo:_}}=(0,w.default)(),{checkResourceAccess:b}=(0,v.default)(),A=f||!m||s,k=(0,c.__)(s?"Inserting":"Insert","web-stories");let L=(0,c.__)("No file types are currently supported.","web-stories");i.length&&(L=(0,T.default)(
/* translators: %s is a list of allowed file extensions. */
(0,c.__)("You can insert %s.","web-stories"),(0,S.default)(i))),(0,d.useLayoutEffect)((()=>{const e=setTimeout((()=>{t&&E.current&&E.current.focus()}));return()=>clearTimeout(e)}),[t,E]);const N=(0,d.useCallback)((()=>{if(m?.length>0){const e=(0,y.withProtocol)(m);p(e),(0,I.isValidUrlForHotlinking)(e)||g((0,c.__)("Invalid link.","web-stories"))}}),[m]),x=(0,d.useCallback)((e=>{f&&g(null),p(e)}),[p,f]),O=(0,d.useCallback)((async()=>{if(m)if((0,I.isValidUrlForHotlinking)(m)){u(!0);try{const e=await _(m),t=await b(m);(0,h.trackEvent)("hotlink_file",{event_label:m,file_size:e.fileSize,file_type:e.mimeType,needs_proxy:t}),r({src:m,needsProxy:t})}catch(e){(0,h.trackError)("hotlink_file",e?.message),g((0,I.getErrorMessage)(e.code,L))}finally{u(!1)}}else g((0,c.__)("Invalid link.","web-stories"))}),[L,r,m,_,g,b]),M=(0,d.useCallback)((e=>{e.preventDefault(),A||O()}),[A,O]);return n.createElement(C.default,{onClose:()=>{a(),p(""),g(!1),u(!1)},isOpen:t,title:l,onPrimary:()=>O(),primaryText:k,secondaryText:(0,c.__)("Cancel","web-stories"),primaryRest:{disabled:A}},n.createElement(P,{onSubmit:M},n.createElement(o.Input,{ref:E,onChange:e=>{let{target:{value:t}}=e;return x(t)},value:m,hint:f?.length?f:L,hasError:Boolean(f?.length),onBlur:N,label:(0,c.__)("URL","web-stories"),type:"url",required:!0})))}const A=r.default.div.withConfig({displayName:"captionsPanelContent__InputRow",componentId:"sc-17hyw65-0"})(["display:flex;flex-grow:1;margin-right:8px;"]),k=(0,r.default)(E.default).withConfig({displayName:"captionsPanelContent__ButtonRow",componentId:"sc-17hyw65-1"})(["gap:12px;"]),L=(0,r.default)(o.Input).withConfig({displayName:"captionsPanelContent__StyledFileInput",componentId:"sc-17hyw65-2"})((e=>{let{$isIndeterminate:t,theme:a}=e;return(0,r.css)(["",";",";"],b.focusStyle,!t&&(0,r.css)(["* > input:disabled{color:",";}"],a.colors.fg.primary))})),N=(0,r.default)(i.Button).withConfig({displayName:"captionsPanelContent__StyledButton",componentId:"sc-17hyw65-3"})(["",";"],(e=>{let{theme:t}=e;return u.focusableOutlineCSS(t.colors.border.focus,t.colors.bg.secondary)})),x=(0,r.default)(i.Button).withConfig({displayName:"captionsPanelContent__HotlinkButton",componentId:"sc-17hyw65-4"})(["padding:12px 8px;"]);function CaptionsPanelContent(e){let{isIndeterminate:t=!1,tracks:a=[],captionText:r=(0,c.__)("Upload a file","web-stories"),handleChangeTrack:o,handleRemoveTrack:i,renderUploadButton:u,clearFileText:h=(0,c.__)("Remove file","web-stories")}=e;const{allowedMimeTypes:{caption:b=[]},capabilities:{hasUploadMediaAction:T},MediaUpload:S}=(0,f.default)(),[y,C]=(0,d.useState)(!1),I=(0,p.useFeature)("captionHotlinking"),w=(0,d.useMemo)((()=>b.map((e=>(0,m.getExtensionsFromMimeType)(e))).flat()),[b]);return b?.length?n.createElement(n.Fragment,null,t&&n.createElement(E.default,null,n.createElement(L,{value:g.MULTIPLE_DISPLAY_VALUE,disabled:!0,"aria-label":(0,c.__)("Filename","web-stories"),onChange:()=>i(),$isIndeterminate:t})),a.map((e=>{let{id:t,trackName:a}=e;return n.createElement(E.default,{key:`row-filename-${t}`},n.createElement(A,null,n.createElement(L,{value:a,"aria-label":(0,c.__)("Filename","web-stories"),onChange:()=>i(t),disabled:!0})),n.createElement(_.default,{hasTail:!0,title:h},n.createElement(N,{"aria-label":h,type:l.BUTTON_TYPES.TERTIARY,size:l.BUTTON_SIZES.SMALL,variant:l.BUTTON_VARIANTS.SQUARE,onClick:()=>i(t)},n.createElement(s.default,null))))})),!a.length&&!t&&n.createElement(k,{spaceBetween:!1},T&&n.createElement(S,{onSelect:o,onSelectErrorMessage:(0,c.__)("Please choose a VTT file to use as caption.","web-stories"),type:b,title:r,buttonInsertText:(0,c.__)("Select caption","web-stories"),render:u}),I&&n.createElement(n.Fragment,null,n.createElement(x,{variant:l.BUTTON_VARIANTS.RECTANGLE,type:l.BUTTON_TYPES.SECONDARY,size:l.BUTTON_SIZES.SMALL,onClick:()=>C(!0)},(0,c.__)("Link to file","web-stories")),n.createElement(HotlinkModal,{title:(0,c.__)("Insert external captions","web-stories"),isOpen:y,onSelect:e=>{o(e),C(!1)},onClose:()=>C(!1),allowedFileTypes:w})))):null}},5053:(e,t,a)=>{a.d(t,{default:()=>r});var n=a(65426);function r(e,t,a){const r={},o=e.map((e=>e[t]||a));return Object.keys(a).forEach((e=>{r[e]=(0,n.default)(o,e)})),r}},65426:(e,t,a)=>{a.d(t,{default:()=>r});a(89157);var n=a(29184);function r(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;const r="function"==typeof t?t:e=>e[t],i=o(r(e[0]),a),l=e.every((e=>o(r(e),a)===i));return l?i:n.MULTIPLE_VALUE}function o(e,t){return void 0===e?t:e}},94438:(e,t,a)=>{a.d(t,{default:()=>LoopPanelContent});var n=a(67294),r=a(44586),o=a(58167),i=a(2161),l=a(19977),s=a(58286),u=a(71314),c=a(58804),d=a(35343);function m(){return m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},m.apply(this,arguments)}const p=(0,c.default)(i.Checkbox).withConfig({displayName:"loopPanelContent__StyledCheckbox",componentId:"sc-lp7bl3-0"})(["",""],(e=>{let{theme:t}=e;return`\n    input[type='checkbox']&.${l.FOCUS_VISIBLE_SELECTOR} ~ div, input[type='checkbox']:focus ~ div {\n      box-shadow: 0px 0px 0 2px ${t.colors.bg.secondary}, 0px 0px 0 4px ${t.colors.border.focus} !important;\n    }\n  `})),f=c.default.div.withConfig({displayName:"loopPanelContent__Wrapper",componentId:"sc-lp7bl3-1"})(["display:flex;gap:12px;"]);function LoopPanelContent(e){let{loop:t,className:a="",onChange:i,...l}=e;const c=(0,d.useInitializedValue)((()=>`cb-${(0,r.default)()}`));return n.createElement(f,{className:a},n.createElement(p,m({id:c,checked:t,onChange:i},l)),n.createElement("label",{htmlFor:c},n.createElement(s.Text,{as:"span",size:u.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.SMALL},(0,o.__)("Loop","web-stories"))))}},64428:(e,t,a)=>{a.d(t,{focusStyle:()=>o,inputContainerStyleOverride:()=>i});var n=a(58804),r=a(16087);const o=(0,n.css)(["",";"],(e=>{let{theme:t}=e;return r.focusableOutlineCSS(t.colors.border.focus,t.colors.bg.secondary)})),i=(0,n.css)([":focus-within{",";}"],(e=>{let{theme:t}=e;return r.focusCSS(t.colors.border.focus,t.colors.bg.secondary)}))},63214:(e,t,a)=>{a.d(t,{default:()=>l});var n=a(35343),r=a(72920),o=a(31393),i=(a(89157),a(29184));function l(e,t){return(0,n.useMemo)((()=>{const a=e.map((e=>e[t]));if(0===a.length)return null;if(1===a.length)return a[0];const n={};return a.forEach((e=>{const t=(0,r.default)((0,o.default)(e));t in n||(n[t]=e)})),1===Object.keys(n).length?Object.values(n)[0]:i.MULTIPLE_VALUE}),[e,t])}},29059:(e,t,a)=>{a.d(t,{default:()=>o});var n=a(35343),r=a(5053);function o(e,t,a){const o=(0,r.default)(e,t,a),i=Object.keys(a).map((e=>o[e]));return(0,n.useMemo)((()=>o),i)}},24035:(e,t,a)=>{a.d(t,{default:()=>n});var n=(0,a(35343).createContext)({state:{},actions:{},tabs:{},refs:{}})},35185:(e,t,a)=>{a.d(t,{PANEL_STATES:()=>n});const n={NORMAL:"normal",DANGER:"danger"}},80439:(e,t,a)=>{a.d(t,{LayerThumbnail:()=>LayerThumbnail});var n=a(67294),r=a(46345),o=a(28841),i=(a(55537),a(84296),a(35343),a(17166),a(40169),a(89703),a(54e3),a(28377),a(40823),a(19040),a(89157),a(29184),a(73393),a(26613),a(70746),a(60211),a(13851),a(76129),a(11606),a(37890),a(30738),a(50067),a(28410),a(24763),a(21303),a(34639),a(84401));a(93909),a(39751),a(9219),a(79074),a(12221),a(41657),a(249),a(32696),a(63594),a(16243),a(77850),a(697),a(65290),a(80951),a(73071),a(7377),a(55376),a(24355),a(62313),a(83859);const LayerThumbnail=e=>{let{page:t}=e;const{LayerIcon:a}=(0,r.getDefinitionForType)(t?.type),{getProxiedUrl:l}=(0,o.default)(),{isDefaultBackground:s}=t,u={element:t,getProxiedUrl:l,currentPageBackgroundColor:(0,i.default)((e=>{let{state:t}=e;return!s||t.currentPage?.backgroundColor}))};return"video"===t?.type&&(u.showVideoPreviewAsBackup=!0),n.createElement(a,u)}},89574:(e,t,a)=>{a.d(t,{DEFAULT_LOADING_MESSAGE:()=>s,THUMBNAIL_DIMENSIONS:()=>r,THUMBNAIL_SCRIM_CLASSNAME:()=>i,THUMBNAIL_SHOW_ON_HOVER_FOCUS:()=>l,THUMBNAIL_TYPES:()=>o});var n=a(58167);const r={WIDTH:52,HEIGHT:78,NESTED_ICON:32,THUMBNAIL_SHAPE:36},o={VIDEO:"VIDEO",IMAGE:"IMAGE",TEXT:"TEXT",SHAPE:"SHAPE",PAGE:"PAGE"},i="thumbnail-scrim",l="thumbnail-show-hover-focus",s=(0,n.__)("Loading","web-stories")},50014:(e,t,a)=>{a.d(t,{Background:()=>s,Container:()=>l,NestedIconContainer:()=>u,Scrim:()=>c});var n=a(45697),r=a.n(n),o=a(58804),i=a(89574);const l=o.default.button.withConfig({displayName:"styles__Container",componentId:"sc-jiqsnn-0"})((e=>{let{theme:t,$isError:a,$isOverflow:n}=e;return(0,o.css)(["position:relative;display:flex;align-items:center;justify-content:center;width:","px;height:","px;padding:0;outline:none;border:none;border-radius:",";background-color:",";cursor:pointer;.","{display:none;}&:hover{.","{display:flex;}}"," &:focus,&:focus-within{.","{display:flex;}.","{background-color:",";border:1px solid ",";}}"],i.THUMBNAIL_DIMENSIONS.WIDTH,i.THUMBNAIL_DIMENSIONS.HEIGHT,t.borders.radius.small,n?t.colors.interactiveBg.secondaryNormal:"transparent",i.THUMBNAIL_SHOW_ON_HOVER_FOCUS,i.THUMBNAIL_SHOW_ON_HOVER_FOCUS,a&&(0,o.css)([".","{border:1px solid ",";background-color:",";}&:hover .","{background-color:",";}"],i.THUMBNAIL_SCRIM_CLASSNAME,t.colors.border.negativeNormal,t.colors.opacity.black24,i.THUMBNAIL_SCRIM_CLASSNAME,t.colors.opacity.black24),i.THUMBNAIL_SHOW_ON_HOVER_FOCUS,i.THUMBNAIL_SCRIM_CLASSNAME,t.colors.opacity.black64,t.colors.border[a?"negativeNormal":"focus"])}));l.propTypes={$isError:r().bool};const s=o.default.div.withConfig({displayName:"styles__Background",componentId:"sc-jiqsnn-1"})((e=>{let{theme:t,$isShape:a,$isPage:n}=e;return(0,o.css)(["width:100%;height:100%;display:flex;border-radius:",";& > img,& > video{width:100%;height:100%;object-fit:cover;border-radius:",";}& > div{display:flex;height:100%;margin:0 auto;align-items:center;justify-content:center;align-self:center;color:",";}"," ",""],t.borders.radius.small,t.borders.radius.small,t.colors.fg.primary,a&&(0,o.css)(["& > div{width:","px;height:","px;& > div{width:100%;height:100%;}}"],i.THUMBNAIL_DIMENSIONS.THUMBNAIL_SHAPE,i.THUMBNAIL_DIMENSIONS.THUMBNAIL_SHAPE),n&&(0,o.css)([".pagePreviewOverrides{border-color:none;&::after{content:none;border:none;}}& > div > div{width:100%;}"]))}));s.propTypes={$isPage:r().bool,$isShape:r().bool};const u=o.default.div.withConfig({displayName:"styles__NestedIconContainer",componentId:"sc-jiqsnn-2"})((e=>{let{theme:t,$isError:a}=e;return(0,o.css)(["display:flex;position:absolute;top:0;width:100%;height:100%;align-items:center;justify-content:center;z-index:5;& > div{margin:auto;width:","px;}svg{width:100%;height:auto;","}"],i.THUMBNAIL_DIMENSIONS.NESTED_ICON,a&&(0,o.css)(["color:",";"],t.colors.fg.negative))}));u.propTypes={$isError:r().bool};const c=o.default.div.withConfig({displayName:"styles__Scrim",componentId:"sc-jiqsnn-3"})((e=>{let{theme:t,$showDefaultBackground:a}=e;return(0,o.css)(["position:absolute;box-sizing:border-box;top:0;width:100%;height:100%;border:1px solid transparent;border-radius:",";z-index:2;",";&:hover{background-color:",";}"],t.borders.radius.small,a&&(0,o.css)(["background-color:",";"],t.colors.opacity.black24),t.colors.opacity.black64)}));c.propTypes={$showDefaultBackground:r().bool}},50097:(e,t,a)=>{a.d(t,{default:()=>Thumbnail});var n=a(67294),r=a(34690),o=a(20341),i=a(89574),l=a(50014);function s(){return s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},s.apply(this,arguments)}const u=[i.THUMBNAIL_TYPES.SHAPE,i.THUMBNAIL_TYPES.TEXT],Thumbnail=e=>{let{displayBackground:t,isError:a,onClick:c,type:d,isLoading:m,loadingMessage:p=i.DEFAULT_LOADING_MESSAGE,children:f,...g}=e;return n.createElement(l.Container,s({as:c?"button":"div",onClick:c,$isError:a},g),m&&n.createElement(r.LoadingBar,{loadingMessage:p}),!a&&!m&&f&&n.createElement(l.NestedIconContainer,{className:i.THUMBNAIL_SHOW_ON_HOVER_FOCUS},f),a&&n.createElement(l.NestedIconContainer,{$isError:a},n.createElement(o.default,null)),n.createElement(l.Scrim,{$showDefaultBackground:u.indexOf(d)>-1,className:i.THUMBNAIL_SCRIM_CLASSNAME}),n.createElement(l.Background,{$isShape:d===i.THUMBNAIL_TYPES.SHAPE,$isPage:d===i.THUMBNAIL_TYPES.PAGE},t))}},59042:(e,t,a)=>{a.d(t,{ToggleButton:()=>b});var n=a(67294),r=a(45697),o=a.n(r),i=a(58804),l=a(90949),s=a(207),u=a(71314),c=a(58286),d=a(55859),m=a(38421),p=a(77904),f=a(35343);function g(){return g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},g.apply(this,arguments)}const h=(0,i.default)(l.Button).withConfig({displayName:"toggleButton__Button",componentId:"sc-1de7s10-0"})(["height:36px;width:","px;display:inline-block;border:1px solid ",";padding:2px 0;color:",";"," ",""],(e=>{let{isSquare:t}=e;return t?36:58}),(e=>{let{theme:t}=e;return t.colors.border.defaultNormal}),(e=>{let{theme:t}=e;return t.colors.fg.primary}),(e=>{let{isOpen:t,theme:a}=e;return t&&(0,i.css)(["border-color:",";background-color:",";"],a.colors.bg.secondary,a.colors.bg.secondary)}),(e=>{let{hasText:t,theme:a}=e;return t&&(0,i.css)(["padding:2px 0 2px 8px;width:auto;",";span{padding-left:6px;}"],s.expandPresetStyles({preset:{...a.typography.presets.paragraph[u.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.SMALL]},theme:a}))}));h.propTypes={hasText:o().bool,isOpen:o().bool};const E=i.default.div.withConfig({displayName:"toggleButton__Wrapper",componentId:"sc-1de7s10-1"})(["width:100%;height:100%;display:flex;justify-content:space-around;align-items:center;"]),_=(0,i.default)(c.Text).attrs({as:"span"}).withConfig({displayName:"toggleButton__NotificationCount",componentId:"sc-1de7s10-2"})(["margin:-2px 0 -2px;padding-right:6px;line-height:20px;color:",";"],(e=>{let{theme:t}=e;return t.colors.violet[20]})),b=(0,f.forwardRef)(((e,t)=>{let{copy:a,isOpen:r=!1,notificationCount:o=0,MainIcon:i,label:l,shortcut:s,popupZIndexOverride:u,...c}=e;const f=o>0;return n.createElement(d.Tooltip,{hasTail:!0,title:l,placement:m.PLACEMENT.TOP,shortcut:s,popupZIndexOverride:u},n.createElement(h,g({ref:t,"aria-haspopup":!0,"aria-pressed":r,"aria-expanded":r,hasText:Boolean(a),isOpen:r,isSquare:!f,type:p.BUTTON_TYPES.TERTIARY,variant:p.BUTTON_VARIANTS.RECTANGLE,size:p.BUTTON_SIZES.MEDIUM},c),n.createElement(E,null,i&&n.createElement(i,null),a,f&&n.createElement(_,null,o))))}));b.displayName="ToggleButton"},31271:(e,t,a)=>{a.d(t,{default:()=>Tooltip});var n=a(67294),r=a(38421),o=a(55859),i=(a(28377),a(97506));function l(){return l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},l.apply(this,arguments)}function Tooltip(e){let{placement:t=r.PLACEMENT.BOTTOM,...a}=e;const{isRTL:s}=(0,i.default)(),u=s?r.RTL_PLACEMENT[t]:t;return n.createElement(o.Tooltip,l({placement:u},a))}},46208:(e,t,a)=>{a.r(t),a.d(t,{ACCESSIBILITY_COPY:()=>Ie.ACCESSIBILITY_COPY,APIContext:()=>Q.default,APIProvider:()=>q.default,BackgroundAudioPanel:()=>BackgroundAudioPanel,CARD_TYPE:()=>ve.CARD_TYPE,CHECKLIST_PRIORITY_COPY:()=>Ie.PRIORITY_COPY,Checklist:()=>ye.Checklist,ChecklistCard:()=>Qa.default,ChecklistCardStyles:()=>we,ChecklistCategoryProvider:()=>Se.ChecklistCategoryProvider,ChecklistCheckpointProvider:()=>Te.ChecklistCheckpointProvider,ChecklistCountProvider:()=>Se.ChecklistCountProvider,ChecklistIcon:()=>ChecklistIcon,ChecklistProvider:()=>Za.default,CheckpointContext:()=>Te.CheckpointContext,Color:()=>Qe.default,ConfigContext:()=>b.default,ConfigProvider:()=>_.default,CurrentUserContext:()=>me.default,CurrentUserProvider:()=>Cn.default,DateTime:()=>it.default,DefaultCtaButton:()=>DefaultCtaButton,DefaultFooterText:()=>Ja.DefaultFooterText,Dialog:()=>r.default,EditorConfigProvider:()=>_.default,ElementLinkTappableRegionTooBig:()=>ElementLinkTappableRegionTooBig,ElementLinkTappableRegionTooSmall:()=>ElementLinkTappableRegionTooSmall,ExcerptPanel:()=>ExcerptPanel,FilterToggle:()=>Je.default,FlipControls:()=>ja.default,FontContext:()=>se.default,FontPicker:()=>yn.default,GRID_TEMPLATE_AREA:()=>ve.GRID_TEMPLATE_AREA,GRID_VARIANT:()=>ve.GRID_VARIANT,GlobalStyle:()=>Pn.GlobalStyle,HeaderTitle:()=>HeaderTitle,HierarchicalInput:()=>ct.default,ImageElementMissingAlt:()=>ImageElementMissingAlt,ImageElementResolution:()=>ImageElementResolution,InterfaceSkeleton:()=>An.default,LinkIcon:()=>et.default,LinkInput:()=>tt.default,LinkRelations:()=>za.default,MAX_HEIGHT_DEFAULT:()=>dt.MAX_HEIGHT_DEFAULT,MAX_THUMBNAILS_DISPLAYED:()=>ve.MAX_THUMBNAILS_DISPLAYED,Media:()=>at.default,MediaUploadButton:()=>Fa.default,PPC_CHECKPOINT_STATE:()=>Ie.PPC_CHECKPOINT_STATE,PageAdvancementPanel:()=>PageAdvancementPanel,PageBackgroundTextLowContrast:()=>PageBackgroundTextLowContrast,PageTooLittleText:()=>PageTooLittleText,PageTooManyLinks:()=>PageTooManyLinks,PageTooMuchText:()=>PageTooMuchText,Panel:()=>dt.default,PanelContent:()=>ft.default,PanelTitle:()=>pt.default,PreviewButton:()=>PreviewButton,PreviewErrorBoundary:()=>PreviewErrorBoundary,PreviewPage:()=>E,PublishButton:()=>PublishButton,PublisherLogoMissing:()=>PublisherLogoMissing,PublisherLogoSize:()=>PublisherLogoSize,RadioGroup:()=>st.default,RedoButton:()=>Redo,Required:()=>lt.default,Row:()=>nt.default,STORY_EVENTS:()=>K.STORY_EVENTS,Select:()=>ut.default,SidebarContext:()=>kn.default,SimplePanel:()=>gt.default,SlugPanel:()=>SlugPanel,StoryAmpValidationErrors:()=>StoryAmpValidationErrors,StoryContext:()=>X.default,StoryEditor:()=>o.default,StoryMissingExcerpt:()=>StoryMissingExcerpt,StoryMissingTitle:()=>StoryMissingTitle,StoryPagesCount:()=>StoryPagesCount,StoryPosterAttached:()=>StoryPosterAttached,StoryPosterSize:()=>StoryPosterSize,StoryPropTypes:()=>ce.StoryPropTypes,StoryProvider:()=>W.default,StoryTitleLength:()=>StoryTitleLength,Switch:()=>rt.default,SwitchToDraftButton:()=>SwitchToDraftButton,TaxonomiesPanel:()=>TaxonomiesPanel,TextArea:()=>ot.default,TextElementFontSizeTooSmall:()=>TextElementFontSizeTooSmall,Tooltip:()=>oe.default,UndoButton:()=>Undo,UpdateButton:()=>UpdateButton,VideoElementLength:()=>VideoElementLength,VideoElementMissingCaptions:()=>VideoElementMissingCaptions,VideoElementMissingDescription:()=>VideoElementMissingDescription,VideoElementMissingPoster:()=>VideoElementMissingPoster,VideoElementResolution:()=>VideoElementResolution,VideoOptimization:()=>ke.default,focusStyle:()=>ra.focusStyle,getCommonObjectValue:()=>Wa.default,getCommonValue:()=>Va.default,getInUseFontsForPages:()=>Ln.getInUseFontsForPages,getPagesWithFailedContrast:()=>un.getPagesWithFailedContrast,getStoryPropsToSave:()=>wn.default,highlightStates:()=>Ce.default,highlightStyles:()=>ht.styles,makeFlatOptionTree:()=>Pa.makeFlatOptionTree,panelContext:()=>mt.default,storyReducers:()=>n,theme:()=>Le.theme,useAPI:()=>J.default,useCategoryCount:()=>Se.useCategoryCount,useChecklist:()=>Ka.useChecklist,useCheckpoint:()=>Te.useCheckpoint,useCommonColorValue:()=>Xa.default,useCommonObjectValue:()=>$a.default,useConfig:()=>T.default,useCurrentUser:()=>In.default,useHasChecklist:()=>Se.useHasChecklist,useHighlights:()=>Et.default,useIsChecklistEmpty:()=>Se.useIsChecklistEmpty,useIsChecklistMounted:()=>nn.useIsChecklistMounted,useIsUploadingToStory:()=>Ee.default,useLoadFontFiles:()=>vn.default,usePresubmitHandler:()=>Ga.default,useRefreshPostEditURL:()=>be.default,useRegisterCheck:()=>Se.useRegisterCheck,useSidebar:()=>Ze.default,useStory:()=>$.default,useStoryTriggerListener:()=>Z.useStoryTriggerListener,useStoryTriggers:()=>Z.useStoryTriggers,useStoryTriggersDispatch:()=>Z.useStoryTriggersDispatch});var n={};a.r(n),a.d(n,{addAnimations:()=>j.default,addElements:()=>w.default,addPage:()=>S.default,arrangeElement:()=>N.default,arrangePage:()=>I.default,combineElements:()=>x.default,copySelectedElement:()=>M.default,deleteElements:()=>v.default,deleteElementsByResourceId:()=>k.default,deletePage:()=>y.default,duplicateElementsById:()=>O.default,restore:()=>z.default,selectElement:()=>H.default,setBackgroundElement:()=>L.default,setCurrentPage:()=>B.default,setSelectedElements:()=>D.default,toggleElement:()=>Y.default,toggleLayer:()=>F.default,unselectElement:()=>U.default,updateAnimationState:()=>G.default,updateElements:()=>P.default,updateElementsByFontFamily:()=>R.default,updateElementsByResourceId:()=>A.default,updatePage:()=>C.default,updateStory:()=>V.default});var r=a(65744),o=a(66099),i=a(67294),l=a(45697),s=a.n(l),u=a(35343),c=a(58804),d=a(31393),m=a(70746),p=(a(65314),a(87930));const f=c.default.div.withConfig({displayName:"previewPage__FullBleedPreviewWrapper",componentId:"sc-1r5t7dq-0"})(["height:",";width:100%;overflow:hidden;position:relative;display:flex;align-items:center;background-color:white;",";"],(e=>{let{pageSize:t}=e;return`${t.containerHeight}px`}),(e=>{let{background:t}=e;return(0,d.default)(t)})),g=c.default.div.withConfig({displayName:"previewPage__PreviewSafeZone",componentId:"sc-1r5t7dq-1"})(["width:100%;height:",";overflow:visible;position:absolute;margin:0;"],(e=>{let{pageSize:t}=e;return`${t.height}px`}));function PreviewPageAnimationController(e){let{animationState:t}=e;const a=(0,m.useStoryAnimationContext)((e=>{let{actions:t}=e;return t.WAAPIAnimationMethods}));return(0,u.useEffect)((()=>{switch(t){case m.STORY_ANIMATION_STATE.PLAYING:return a.play(),()=>{};case m.STORY_ANIMATION_STATE.RESET:return a.reset(),()=>{};case m.STORY_ANIMATION_STATE.SCRUBBING:case m.STORY_ANIMATION_STATE.PAUSED:return a.pause(),()=>{};default:return()=>{}}}),[t,a]),(0,u.useEffect)((()=>()=>a.reset()),[a]),null}const h=(0,u.memo)((0,u.forwardRef)((function PreviewPageDisplay(e,t){let{page:a,pageSize:n}=e;return i.createElement(f,{ref:t,pageSize:n,background:a.backgroundColor},i.createElement(g,{pageSize:n},i.createElement(p.default,{page:a})))}))),E=(0,u.forwardRef)((function PreviewPage(e,t){let{page:a,pageSize:n,animationState:r=m.STORY_ANIMATION_STATE.RESET,onAnimationComplete:o}=e;return i.createElement(c.StyleSheetManager,{stylisPlugins:[]},i.createElement(m.StoryAnimation.Provider,{animations:a.animations,elements:a.elements,onWAAPIFinish:o},i.createElement(h,{ref:t,page:a,pageSize:n}),i.createElement(PreviewPageAnimationController,{animationState:r})))}));PreviewPageAnimationController.propTypes={animationState:s().oneOf(Object.values(m.STORY_ANIMATION_STATE))};class PreviewErrorBoundary extends u.Component{state={hasError:!1};static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,t){console.error(e,t)}render(){return this.state.hasError?i.createElement("div",null):this.props.children}}var _=a(52054),b=a(28377),T=a(97506),S=a(21377),y=a(29093),C=a(8494),I=a(6707),w=a(54850),v=a(80612),P=a(19941),A=a(71470),k=a(57549),L=a(44459),N=a(60702),x=a(54234),O=a(7481),M=a(47186),R=a(84476),B=a(81550),D=a(62109),H=a(6986),U=a(81278),Y=a(2775),F=a(35443),G=a(55240),j=a(90694),z=a(56169),V=a(1473),W=a(93902),X=a(76129),$=a(84401),Z=a(97472),K=(a(24763),a(21303),a(34639),a(79254)),q=a(2380),Q=a(40823),J=a(47390),ee=a(90949),te=a(77904),ae=a(9124),ne=a(39360),re=a(58167),oe=a(31271),ie=(a(55537),a(84296),a(17166),a(40169),a(2399)),le=(a(54e3),a(19040)),se=(a(89157),a(29184),a(73393)),ue=a(26613),ce=(a(60211),a(13851),a(46345)),de=(a(11606),a(37890),a(30738),a(50067),a(28410)),me=(a(93909),a(39751),a(9219),a(79074),a(12221),a(41657),a(249),a(32696),a(63594),a(16243),a(77850),a(697),a(65290),a(80951),a(73071),a(7377));a(55376),a(24355),a(62313),a(83859);function pe(){return pe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},pe.apply(this,arguments)}function HistoryButton(e){let{title:t,shortcut:a,children:n,...r}=e;return i.createElement(oe.default,{title:t,shortcut:a,hasTail:!0},i.createElement(ee.Button,pe({variant:te.BUTTON_VARIANTS.SQUARE,type:te.BUTTON_TYPES.QUATERNARY,size:te.BUTTON_SIZES.SMALL},r),n))}function Redo(){const{state:{canRedo:e},actions:{redo:t}}=(0,ie.default)(),{isRTL:a}=(0,T.default)(),n=(0,u.useCallback)((()=>t()),[t]);return i.createElement(HistoryButton,{title:(0,re.__)("Redo","web-stories"),shortcut:"shift+mod+z",disabled:!e,onClick:n,"aria-label":(0,re.__)("Redo Changes","web-stories")},a?i.createElement(ae.default,null):i.createElement(ne.default,null))}function Undo(){const{state:{canUndo:e},actions:{undo:t}}=(0,ie.default)(),{isRTL:a}=(0,T.default)(),n=(0,u.useCallback)((()=>t()),[t]);return i.createElement(HistoryButton,{title:(0,re.__)("Undo","web-stories"),shortcut:"mod+z",disabled:!e,onClick:n,"aria-label":(0,re.__)("Undo Changes","web-stories")},a?i.createElement(ne.default,null):i.createElement(ae.default,null))}var fe=a(7520),ge=(a(89703),a(58286)),he=a(71314);function PreviewErrorDialog(e){let{isOpen:t,onClose:a,onRetry:n}=e;return i.createElement(r.default,{isOpen:t,onClose:a,title:(0,re.__)("Open preview","web-stories"),secondaryText:(0,re.__)("Cancel","web-stories"),onPrimary:n,primaryText:(0,re.__)("Try again","web-stories")},i.createElement(ge.Text,{size:he.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.SMALL},(0,re.__)("The preview window failed to open.","web-stories")))}var Ee=a(37870);function PreviewButton(e){let{forceIsSaving:t=!1}=e;const{isSaving:a,previewLink:n,status:r,autoSave:o,saveStory:l}=(0,$.default)((e=>{let{state:{meta:{isSaving:t},story:{status:a,previewLink:n}},actions:{autoSave:r,saveStory:o}}=e;return{isSaving:t,status:a,previewLink:n,autoSave:r,saveStory:o}})),s=(0,Ee.default)(),[c,d]=(0,u.useState)(null),m="draft"===r||!r,p=e=>{const t=new URL(e);return t.hash="#development=1",t.toString()},f=(0,u.useCallback)((()=>{let e;(0,ue.trackEvent)("preview_story");try{if(e=window.open("about:blank","story-preview"),e){e.document.write("<!DOCTYPE html><html><head>"),e.document.write("<title>"),e.document.write((0,le.escapeHTML)((0,re.__)("Generating the preview","web-stories"))),e.document.write("</title>"),e.document.write("</head><body>"),e.document.write((0,le.escapeHTML)((0,re.__)("Please wait. Generating the preview","web-stories")));const t=p(n);e.document.write(`<script>\n            setTimeout(function() {\n              location.replace(${JSON.stringify(t)});\n            }, 5000);\n          <\/script>`)}}catch(e){}(m?l:o)().then((t=>{if(e&&!e.closed&&e.location.href){const a=p(t?.previewLink??n);e.location.replace(a)}})).catch((()=>d(n)))}),[o,m,n,l]),g=(0,u.useCallback)((e=>{d(null);const t=p(c);window.open(t,"story-preview"+Math.random()),e.preventDefault()}),[c]),h=(0,u.useCallback)((()=>d(null)),[]),E=(0,re.__)("Preview","web-stories");return i.createElement(i.Fragment,null,i.createElement(oe.default,{title:E,hasTail:!0},i.createElement(ee.Button,{variant:te.BUTTON_VARIANTS.SQUARE,type:te.BUTTON_TYPES.QUATERNARY,size:te.BUTTON_SIZES.SMALL,onClick:f,disabled:a||t||s,"aria-label":E},i.createElement(fe.default,null))),i.createElement(PreviewErrorDialog,{isOpen:Boolean(c),onClose:h,onRetry:g}))}var _e=a(92790),be=a(19675),Te=(a(52601),a(72063)),Se=a(35466),ye=a(79426),Ce=(a(37070),a(96426),a(60811)),Ie=(a(6687),a(9730),a(84082)),we=a(89353),ve=(a(88858),a(58965)),Pe=a(89574),Ae=(a(50014),a(52563)),ke=(a(88862),a(75671)),Le=a(74350),Ne=a(85059),xe=a(86807),Oe=a(28633),Me=a(53449);const Re="excerpt",Be="title",De="44px";var He=a(55859),Ue=a(36363),Ye=a(20341);const ChecklistIcon=e=>{let{checkpoint:t,...a}=e;return t===Ie.PPC_CHECKPOINT_STATE.ALL?i.createElement(Ye.default,a):null};function Fe(){return Fe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},Fe.apply(this,arguments)}const Ge=(0,c.default)(ee.Button).withConfig({displayName:"buttonWithChecklistWarning__Button",componentId:"sc-jm08jq-0"})(["padding:4px 6px;height:32px;svg{width:24px;height:auto;}"]),je=(0,u.forwardRef)((function InnerButton(e,t){let{text:a,checkpoint:n,hasHighPriorityIssues:r=!1,onClick:o,...l}=e;return i.createElement(Ge,Fe({ref:t,variant:te.BUTTON_VARIANTS.RECTANGLE,type:te.BUTTON_TYPES.PRIMARY,size:te.BUTTON_SIZES.SMALL,onClick:e=>{e.currentTarget.blur(),o?.(e)}},l),a,r&&i.createElement(ChecklistIcon,{checkpoint:n}))})),ze=(0,u.forwardRef)((function ButtonWithChecklistWarning(e,t){let{disabled:a,hasFutureDate:n,...r}=e;const o=(0,Ee.default)(),{isSaving:l,canPublish:s,status:c}=(0,$.default)((e=>{let{state:t}=e;return{isSaving:t.meta?.isSaving,status:t.story.status,canPublish:Boolean(t?.capabilities?.publish)}})),{checkpoint:d,hasHighPriorityIssues:m}=(0,Te.useCheckpoint)((e=>{let{state:{checkpoint:t,hasHighPriorityIssues:a}}=e;return{checkpoint:t,hasHighPriorityIssues:a}})),p={[Ie.PPC_CHECKPOINT_STATE.ALL]:m?(0,re.__)("Make updates before publishing to improve discoverability and performance on search engines","web-stories"):"",[Ie.PPC_CHECKPOINT_STATE.ONLY_RECOMMENDED]:(0,re.__)("Review checklist to improve performance before publishing","web-stories"),[Ie.PPC_CHECKPOINT_STATE.UNAVAILABLE]:""},f=(0,re.__)("Saving is disabled due to media currently being uploaded.","web-stories"),g=(0,re.__)("Submit your work for review, and an Editor will be able to approve it for you.","web-stories");let h=o?f:p[d];s||(h=g);const E=(0,u.useMemo)((()=>(0,re.__)(n&&"private"!==c?"Schedule":"Publish","web-stories")),[n,c]),_=s?E:(0,re.__)("Submit for review","web-stories");return i.createElement(He.Tooltip,{title:h,popupZIndexOverride:Ue.Z_INDEX_STORY_DETAILS,hasTail:!0},i.createElement(je,Fe({ref:t,text:_,disabled:a||l||o,checkpoint:d,hasHighPriorityIssues:m},r)))})),Ve=c.default.header.withConfig({displayName:"header___Header",componentId:"sc-yxsju1-0"})(["width:100%;height:",";display:flex;align-items:center;margin-bottom:",";background-color:",";border-top-left-radius:",";border-top-right-radius:",";"],De,"1px",(e=>{let{theme:t}=e;return t.colors.bg.secondary}),(e=>{let{theme:t}=e;return t.borders.radius.medium}),(e=>{let{theme:t}=e;return t.borders.radius.medium})),We=(0,c.default)(ee.Button).withConfig({displayName:"header__CloseButton",componentId:"sc-yxsju1-1"})(["margin:6px auto 5px 6px;"]),Xe=c.default.div.withConfig({displayName:"header__PublishButtonWrapper",componentId:"sc-yxsju1-2"})(["margin:6px 6px 5px auto;"]),Header=e=>{let{onClose:t,onPublish:a,publishButtonDisabled:n,hasFutureDate:r}=e;return i.createElement(Ve,null,i.createElement(We,{variant:te.BUTTON_VARIANTS.SQUARE,size:te.BUTTON_SIZES.SMALL,type:te.BUTTON_TYPES.TERTIARY,onClick:t,"aria-label":(0,re.__)("Close","web-stories")},i.createElement(Me.default,null)),i.createElement(Oe.Headline,{as:"h2",size:he.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.XXX_SMALL},(0,re.__)("Story Details","web-stories")),i.createElement(Xe,null,i.createElement(ze,{onClick:a,disabled:n,hasFutureDate:r})))};var $e=a(15339),Ze=a(1165),Ke=a(69609),qe=a(57639),Qe=a(46123),Je=a(93206),et=a(18800),tt=a(40238),at=a(57346),nt=a(8897),rt=a(92056),ot=a(42009),it=(a(27646),a(91935)),lt=a(63632),st=a(73978),ut=a(39737),ct=a(47011),dt=a(16852),mt=a(36791),pt=a(12983),ft=a(52284),gt=a(42854),ht=a(67651),Et=a(35917);const _t=(0,c.default)(ge.Text).withConfig({displayName:"excerpt__StyledText",componentId:"sc-t9wjp4-0"})(["color:",";margin-top:-4px;"],(e=>{let{theme:t}=e;return t.colors.fg.tertiary}));function ExcerptPanel(e){let{nameOverride:t}=e;const{excerpt:a,updateStory:n}=(0,$.default)((e=>{let{state:{story:{excerpt:t=""}},actions:{updateStory:a}}=e;return{excerpt:t,updateStory:a}})),r=(0,u.useCallback)((e=>{n({properties:{excerpt:e.target.value}})}),[n]),{highlight:o,resetHighlight:l,cancelHighlight:s}=(0,Et.default)((e=>({highlight:e[Ce.default.EXCERPT],resetHighlight:e.onFocusOut,cancelHighlight:e.cancelEffect})));return i.createElement(bt,{onAnimationEnd:()=>l(),name:t||"excerpt",title:(0,re.__)("Story Description","web-stories"),collapsedByDefault:!1,isPersistable:!o,$_css:o?.showEffect&&ht.styles.FLASH},i.createElement(nt.default,null,i.createElement(Tt,{ref:e=>{e&&o?.focus&&o?.showEffect&&(e.addEventListener("keydown",s,{once:!0}),e.focus())},value:a,onChange:r,placeholder:(0,re.__)("Write a description of the story","web-stories"),"aria-label":(0,re.__)("Story Description","web-stories"),maxLength:200,showCount:!0,rows:4,$_css2:o?.showEffect&&ht.styles.OUTLINE})),i.createElement(nt.default,null,i.createElement(_t,{size:he.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.X_SMALL},(0,re.__)("Stories with a description tend to do better on search and have a wider reach","web-stories"))))}var bt=(0,c.default)(gt.default).withConfig({displayName:"excerpt___StyledSimplePanel",componentId:"sc-t9wjp4-1"})(["",""],(e=>e.$_css)),Tt=(0,c.default)(ot.default).withConfig({displayName:"excerpt___StyledTextArea",componentId:"sc-t9wjp4-2"})(["",""],(e=>e.$_css2));const St=c.default.div.withConfig({displayName:"mainStoryInfo__FormSection",componentId:"sc-1f06m84-0"})(["padding:0 4px;&:first-of-type{margin:20px 0px 0px;}"]),yt=(0,c.default)(Ke.TextArea).withConfig({displayName:"mainStoryInfo___TextArea",componentId:"sc-1f06m84-1"})(["margin:8px 0 0;& > p{margin-bottom:-4px;}"]),MainStoryInfo=()=>{const e=(0,T.default)((e=>{let{storyId:t}=e;return t})),t=(0,$.default)((e=>{let{actions:t}=e;return t.updateStory})),a=(0,$.default)((e=>{let{state:{story:t}}=e;return{[Re]:t.excerpt,[Be]:t.title||""}})),n=(0,$.default)((e=>{let{state:{story:{slug:t}}}=e;return t})),r=(0,Ze.default)((e=>{let{data:t}=e;return t?.modalSidebarTab?.IsolatedStatusPanel})),[o,l]=(0,u.useState)(a),s=(0,u.useCallback)((a=>{(0,qe.updateSlug)({currentSlug:n,currentTitle:a,storyId:e,updateStory:t})}),[n,t,e]),c=(0,u.useCallback)((e=>{let{target:a}=e;const{value:n,name:r}=a;t({properties:{[r]:n}}),r===Be&&s(n)}),[s,t]),d=e=>{let{currentTarget:t}=e;l((e=>({...e,[t.name]:t.value})))};return i.createElement(i.Fragment,null,i.createElement(St,null,i.createElement(Oe.Headline,{as:"label",size:he.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.XX_SMALL,htmlFor:Be},(0,re.__)("Story Title","web-stories")),i.createElement(yt,{name:Be,id:"story-title",showCount:!0,value:o[Be],onChange:d,onBlur:c,"aria-label":(0,re.__)("Story Title","web-stories"),placeholder:(0,re.__)("Add title","web-stories")})),i.createElement(St,null,i.createElement(Oe.Headline,{as:"label",size:he.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.XX_SMALL,htmlFor:Re},(0,re.__)("Story Description","web-stories")),i.createElement(yt,{name:Re,id:"story-excerpt",showCount:!0,maxLength:200,value:o[Re],"aria-label":(0,re.__)("Story Description","web-stories"),placeholder:(0,re.__)("Write a description of the story","web-stories"),hint:(0,re.__)("Stories with a description tend to do better on search and have a wider reach","web-stories"),onChange:d,onBlur:c})),r&&i.createElement(r,null))};var Ct=a(1312),It=a(59426),wt=a(65197),vt=a(94955),Pt=a(97775),At=a(51517);const kt=c.default.div.withConfig({displayName:"storyPreview__PreviewWrapper",componentId:"sc-zk17py-0"})(["width:","px;height:","px;position:relative;margin-top:8px;"],(e=>{let{width:t}=e;return t}),(e=>{let{height:t}=e;return t}));kt.propTypes={width:s().number.isRequired,height:s().number.isRequired};const Lt=c.default.div.withConfig({displayName:"storyPreview__PreviewContainer",componentId:"sc-zk17py-1"})(["width:","px;height:","px;position:absolute;"],(e=>{let{width:t}=e;return t}),(e=>{let{height:t}=e;return t}));Lt.propTypes={width:s().number.isRequired,height:s().number.isRequired};const Nt=c.default.img.withConfig({displayName:"storyPreview__Image",componentId:"sc-zk17py-2"})(["height:100%;width:100%;display:block;aspect-ratio:",";object-fit:cover;border-radius:",";background:",";"],It.PAGE_RATIO,(e=>{let{theme:t}=e;return t.borders.radius.medium}),(e=>{let{theme:t}=e;return t.colors.interactiveBg.primaryNormal})),xt=c.default.div.withConfig({displayName:"storyPreview__EmptyPlaceholder",componentId:"sc-zk17py-3"})(["height:100%;border-radius:",";background:",";"],(e=>{let{theme:t}=e;return t.borders.radius.medium}),(e=>{let{theme:t}=e;return t.colors.interactiveBg.primaryNormal})),Ot=c.default.div.withConfig({displayName:"storyPreview__Gradient",componentId:"sc-zk17py-4"})(["position:absolute;bottom:0;height:67%;width:100%;border-radius:",";background:",";"],(e=>{let{theme:t}=e;return t.borders.radius.medium}),(e=>{let{theme:t}=e;return t.colors.gradient.posterOverlay})),Mt=c.default.div.withConfig({displayName:"storyPreview__ScrimWrapper",componentId:"sc-zk17py-5"})(["position:absolute;top:0;box-sizing:border-box;width:100%;height:100%;border-radius:",";background:",";padding:8px;"],(e=>{let{theme:t}=e;return t.borders.radius.medium}),(e=>{let{theme:t}=e;return t.colors.opacity.black3})),Rt=c.default.div.withConfig({displayName:"storyPreview__ScrimContainer",componentId:"sc-zk17py-6"})(["display:flex;height:100%;width:100%;flex-wrap:wrap;justify-content:space-between;"]),Bt=c.default.div.withConfig({displayName:"storyPreview__ScrimTop",componentId:"sc-zk17py-7"})(["display:grid;grid-template-columns:50% 50%;grid-template-rows:auto;grid-template-areas:'publisherLogo editButton';justify-content:inherit;width:100%;"]),Dt=c.default.img.withConfig({displayName:"storyPreview__PublisherLogo",componentId:"sc-zk17py-8"})(["grid-area:publisherLogo;height:24px;width:24px;border-radius:2px;box-shadow:0 0 8px rgba(0,0,0,0.08);"]),Ht=(0,c.default)(at.default).withConfig({displayName:"storyPreview__StyledMedia",componentId:"sc-zk17py-9"})(["grid-area:editButton;display:flex;flex-direction:row-reverse;"]),Ut=c.default.div.withConfig({displayName:"storyPreview__ScrimBottom",componentId:"sc-zk17py-10"})(["width:100%;margin:auto 0 0;align-self:flex-end;"]),Yt=(0,c.default)(Oe.Headline).attrs({as:"h3",size:he.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.X_SMALL}).withConfig({displayName:"storyPreview__Title",componentId:"sc-zk17py-11"})(["max-height:calc(1.2em * 3);display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;padding:0;margin:0 0 4px;overflow:hidden;text-overflow:ellipsis;color:",";"],(e=>{let{theme:t}=e;return t.colors.fg.primary})),Ft=(0,c.default)(ge.Text).attrs({forwardAs:"span",size:he.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.MEDIUM}).withConfig({displayName:"storyPreview__Publisher",componentId:"sc-zk17py-12"})(["display:block;margin:0;padding:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:",";"],(e=>{let{theme:t}=e;return t.colors.fg.secondary})),StoryPreview=()=>{const{title:e,featuredMedia:t,publisherLogo:a,updateStory:n}=(0,$.default)((e=>{let{state:{story:t},actions:a}=e;return{title:t?.title,featuredMedia:t?.featuredMedia||{},publisherLogo:t?.publisherLogo||{},updateStory:a.updateStory}})),{allowedImageMimeTypes:r,hasUploadMediaAction:o,publisher:l}=(0,T.default)((e=>{let{allowedMimeTypes:t,capabilities:a,metadata:n}=e;return{allowedImageMimeTypes:t?.image||At.STABLE_ARRAY,hasUploadMediaAction:a?.hasUploadMediaAction,publisher:n?.publisher}})),s=(0,u.useMemo)((()=>r.map((e=>(0,Pt.getExtensionsFromMimeType)(e))).flat()),[r]),c=Math.round(232/It.PAGE_RATIO),d=(0,u.useCallback)((e=>n({properties:{featuredMedia:{id:e.id,url:e.src,height:e.height,width:e.width}}})),[n]);let m=(0,re.__)("No file types are currently supported.","web-stories");return s.length&&(m=(0,wt.default)(
/* translators: %s: list of allowed file types. */
(0,re.__)("Please choose only %s as a poster.","web-stories"),(0,vt.default)(s))),i.createElement(i.Fragment,null,i.createElement(Oe.Headline,{as:"label",size:he.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.XX_SMALL},(0,re.__)("Cover Preview","web-stories")),i.createElement(kt,{width:232,height:c},i.createElement(Lt,{width:232,height:c},t?.url?i.createElement(Nt,{crossOrigin:"anonymous",src:t.url,width:t.width,height:t.height,alt:(0,re.__)("Preview image","web-stories"),"data-testid":"story_preview_featured_media"}):i.createElement(xt,null),i.createElement(Ot,null),i.createElement(Mt,null,i.createElement(Rt,null,i.createElement(Bt,null,a?.url?.length>0&&i.createElement(Dt,{crossOrigin:"anonymous",width:a.width,height:a.height,src:a.url,alt:(0,re.__)("Publisher Logo","web-stories"),"data-testid":"story_preview_logo"}),o&&i.createElement(Ht,{onChange:d,title:(0,re.__)("Select as poster image","web-stories"),buttonInsertText:(0,re.__)("Select as poster image","web-stories"),type:r,ariaLabel:(0,re.__)("Poster image","web-stories"),onChangeErrorText:m,imgProps:t,canUpload:o,variant:Ct.MEDIA_VARIANTS.NONE,cropParams:{width:640,height:853}})),i.createElement(Ut,null,e&&i.createElement(Yt,{"data-testid":"story_preview_title"},e),l&&i.createElement(Ft,{"data-testid":"story_preview_publisher"},l)))))))};var Gt=a(27699),jt=a(59042);const ChecklistButton=e=>{let{handleReviewChecklist:t}=e;const a=(0,Se.useCategoryCount)(Ie.ISSUE_TYPES.PRIORITY);return i.createElement(jt.ToggleButton,{MainIcon:Gt.default,label:(0,re.__)("Checklist","web-stories"),"aria-label":(0,re.__)("Checklist","web-stories"),popupZIndexOverride:Ue.Z_INDEX_STORY_DETAILS,onClick:t,notificationCount:a})},zt=c.default.div.withConfig({displayName:"content__Main",componentId:"sc-1d1lm9j-0"})(["display:grid;min-width:917px;width:100%;height:calc(100% - "," - ",");grid-template-columns:30.5% 34% 35.5%;grid-template-rows:auto;grid-template-areas:'preview mainPanel sidePanel' 'footer mainPanel sidePanel';"],"1px",De),Vt=c.default.div.withConfig({displayName:"content___StoryPreview",componentId:"sc-1d1lm9j-1"})(["grid-area:preview;margin:20px 18px 0 32px;"]),Wt=c.default.div.withConfig({displayName:"content___MainStoryInfo",componentId:"sc-1d1lm9j-2"})(["grid-area:mainPanel;display:flex;flex-direction:column;padding:0 16px;overflow-y:scroll;gap:34px;& > section{border:none;& > h2{padding-top:0;padding-bottom:2px;& > button{height:1em;}}}"]),Xt=c.default.div.attrs({role:"tabpanel"}).withConfig({displayName:"content__PanelContainer",componentId:"sc-1d1lm9j-3"})(["grid-area:sidePanel;height:100%;margin-left:18px;background-color:",";border-bottom-right-radius:",";overflow-y:scroll;",";"],(e=>{let{theme:t}=e;return t.colors.bg.secondary}),(e=>{let{theme:t}=e;return t.borders.radius.medium}),$e.scrollbarCSS),$t=c.default.div.withConfig({displayName:"content__Footer",componentId:"sc-1d1lm9j-4"})(["grid-area:footer;display:flex;align-items:flex-end;margin:0 18px 20px 32px;"]),Content=e=>{let{handleReviewChecklist:t}=e;const{DocumentPane:a,id:n}=(0,Ze.default)((e=>{let{data:t}=e;return t?.modalSidebarTab||{}})),r=(0,Se.useHasChecklist)();return i.createElement(zt,null,i.createElement(Vt,null,i.createElement(StoryPreview,null)),i.createElement(Wt,null,i.createElement(MainStoryInfo,null)),a&&i.createElement(Xt,{"aria-label":(0,re.__)("Story Settings","web-stories"),id:n},i.createElement(a,null)),r&&i.createElement($t,null,i.createElement(ChecklistButton,{handleReviewChecklist:t})))},Zt=c.default.div.withConfig({displayName:"publishModal__Container",componentId:"sc-16gvo2-0"})(["height:100%;color:",";background-color:",";border:",";border-radius:",";"],Le.theme.colors.fg.primary,Le.theme.colors.bg.primary,`1px solid ${Le.theme.colors.divider.primary}`,Le.theme.borders.radius.medium);function PublishModal(e){let{isOpen:t,onPublish:a,onClose:n,publishButtonDisabled:r,hasFutureDate:o}=e;const l=(0,Te.useCheckpoint)((e=>{let{actions:t}=e;return t.handleReviewChecklist}));(0,u.useEffect)((()=>{t&&(0,ue.trackEvent)("publish_modal")}),[t]);const s=(0,u.useCallback)((()=>{(0,ue.trackEvent)("review_prepublish_checklist"),n({focusPublishButton:!1}),l()}),[n,l]);return i.createElement(Ne.Modal,{isOpen:t,onClose:n,contentLabel:(0,re.__)("Story details","web-stories"),contentStyles:{display:"block",width:"71vw",minWidth:"917px",height:"66vh",minHeight:"580px",overflow:"hidden"},overlayStyles:{backgroundColor:Le.theme.colors.inverted.interactiveBg.modalScrim}},t&&i.createElement(xe.default,null,i.createElement(Zt,null,i.createElement(Header,{hasFutureDate:o,publishButtonDisabled:r,onClose:n,onPublish:a}),i.createElement(Content,{handleReviewChecklist:s}))))}function PublishButton(e){let{forceIsSaving:t}=e;const{date:a,storyId:n,saveStory:r,title:o,editLink:l,canPublish:s}=(0,$.default)((e=>{let{state:{story:{date:t,storyId:a,title:n,editLink:r},capabilities:o},actions:{saveStory:i}}=e;return{date:t,storyId:a,saveStory:i,title:n,editLink:r,canPublish:Boolean(o?.publish)}})),c=(0,Te.useCheckpoint)((e=>{let{actions:{showPriorityIssues:t}}=e;return t})),[d,m]=(0,u.useState)(!1),p=(0,u.useRef)(),f=(0,be.default)(n,l),g=(0,_e.isAfter)((0,_e.subMinutes)((0,_e.toDate)(a,(0,_e.getOptions)()),1),(0,_e.toDate)(new Date,(0,_e.getOptions)())),h=(0,u.useCallback)((()=>{let e="pending";s&&(e=g?"future":"publish"),(0,ue.trackEvent)("publish_story",{status:e,title_length:o.length}),m(!1),r({status:e}),f()}),[f,r,g,o,s]),E=(0,u.useCallback)((()=>{c(),m(!0)}),[c]),_=(0,u.useCallback)((function(){let{focusPublishButton:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m(!1),e&&p.current.focus()}),[]);return i.createElement(i.Fragment,null,i.createElement(ze,{ref:p,onClick:E,disabled:t,hasFutureDate:g}),i.createElement(PublishModal,{isOpen:d,onPublish:h,onClose:_,hasFutureDate:g,publishButtonDisabled:t}))}var Kt=a(37557);function SwitchToDraftButton(e){let{forceIsSaving:t=!1}=e;const{isSaving:a,saveStory:n}=(0,$.default)((e=>{let{state:{meta:{isSaving:t}},actions:{saveStory:a}}=e;return{isSaving:t,saveStory:a}})),r=(0,Ee.default)(),o=(0,u.useCallback)((()=>{n({status:"draft"})}),[n]),l=(0,re.__)("Switch to Draft","web-stories");return i.createElement(oe.default,{title:l,hasTail:!0},i.createElement(ee.Button,{variant:te.BUTTON_VARIANTS.SQUARE,type:te.BUTTON_TYPES.QUATERNARY,size:te.BUTTON_SIZES.SMALL,onClick:o,disabled:a||t||r,"aria-label":l},i.createElement(Kt.default,null)))}var qt=a(8684),Qt=a(25542);function PlainButton(e){let{text:t,onClick:a,disabled:n}=e;return i.createElement(oe.default,{title:t,hasTail:!0},i.createElement(ee.Button,{variant:te.BUTTON_VARIANTS.SQUARE,type:te.BUTTON_TYPES.QUATERNARY,size:te.BUTTON_SIZES.SMALL,onClick:a,disabled:n,"aria-label":t},i.createElement(Qt.default,null)))}function UpdateButton(e){let{hasUpdates:t=!1,forceIsSaving:a=!1}=e;const{isSaving:n,status:r,date:o,saveStory:l,canPublish:s}=(0,$.default)((e=>{let{state:{meta:{isSaving:t},story:{status:a,date:n},capabilities:r},actions:{saveStory:o}}=e;return{isSaving:t,status:a,date:n,saveStory:o,canPublish:Boolean(r?.publish)}})),u=n||a,c=(0,Ee.default)(),{state:{hasNewChanges:d}}=(0,ie.default)();(0,qt.useGlobalKeyDownEffect)({key:["mod+s"]},(e=>{e.preventDefault(),u||c||l()}),[l,u,c]);const m=!u&&!c&&(d||t),p="draft"===r||!r;if("pending"===r)return i.createElement(PlainButton,{text:(0,re.__)("Save as pending","web-stories"),disabled:!m,onClick:()=>l()});if(p)return i.createElement(PlainButton,{text:(0,re.__)("Save draft","web-stories"),disabled:!m,onClick:()=>l()});const f=(0,_e.isAfter)((0,_e.subMinutes)((0,_e.toDate)(o,(0,_e.getOptions)()),1),(0,_e.toDate)(new Date,(0,_e.getOptions)())),g=(0,re.__)(f&&"private"!==r?"Schedule":"Update","web-stories");return i.createElement(ze,{text:g,onClick:()=>l(),disabled:!m,isUploading:c,canPublish:s})}var Jt=a(207),ea=a(16087);const ta=c.default.input.withConfig({displayName:"title__Input",componentId:"sc-jcmnyx-0"})(["color:",";margin:0;"," background:",";border:none !important;text-align:start;min-width:60%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;border-radius:",";",";",""],(e=>{let{theme:t}=e;return`${t.colors.fg.primary} !important`}),Jt.expandTextPreset(((e,t)=>{let{paragraph:a}=e,{MEDIUM:n}=t;return a[n]})),(e=>{let{isHighlighted:t}=e;return!t&&"none !important"}),(e=>{let{theme:t}=e;return t.borders.radius.small}),ea.focusableOutlineCSS,(e=>{let{isHighlighted:t}=e;return t&&(0,c.css)([""," ",""],ht.styles.OUTLINE,ht.styles.FLASH)}));function HeaderTitle(){const{title:e,slug:t,updateStory:a}=(0,$.default)((e=>{let{state:{story:{title:t,slug:a}},actions:{updateStory:n}}=e;return{title:t,slug:a,updateStory:n}})),{highlight:n,resetHighlight:r,cancelHighlight:o}=(0,Et.default)((e=>({highlight:e[Ce.default.STORY_TITLE],resetHighlight:e.onFocusOut,cancelHighlight:e.cancelEffect}))),{storyId:l}=(0,T.default)(),s=(0,u.useCallback)((e=>a({properties:{title:e.target.value}})),[a]),c=(0,u.useCallback)((()=>{(0,qe.updateSlug)({currentSlug:t,currentTitle:e,storyId:l,updateStory:a})}),[t,l,e,a]);return"string"!=typeof e?null:i.createElement(ta,{ref:e=>{e&&n?.focus&&n?.showEffect&&(e.addEventListener("keydown",o,{once:!0}),e.focus())},value:e,type:"text",onBlur:c,onChange:s,placeholder:(0,re.__)("Add title","web-stories"),"aria-label":(0,re.__)("Story title","web-stories"),isHighlighted:n?.showEffect,onAnimationEnd:()=>r()})}var aa=a(17211),na=a(61342),ra=a(64428);const oa=c.default.div.withConfig({displayName:"pageAdvancement__SwitchRow",componentId:"sc-11tn322-0"})(["margin-bottom:16px;"]),ia=(0,c.default)(ge.Text).attrs({size:he.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.SMALL}).withConfig({displayName:"pageAdvancement__MutedText",componentId:"sc-11tn322-1"})(["color:",";"],(e=>{let{theme:t}=e;return t.colors.fg.secondary})),la={MIN:1,MAX:20};function PageAdvancementPanel(e){let{nameOverride:t}=e;const{autoAdvance:a,defaultPageDuration:n,updateStory:r}=(0,$.default)((e=>{let{state:{story:{autoAdvance:t=de.DEFAULT_AUTO_ADVANCE,defaultPageDuration:a=de.DEFAULT_PAGE_DURATION}},actions:{updateStory:n}}=e;return{autoAdvance:t,defaultPageDuration:a,updateStory:n}})),[o,l]=(0,u.useState)(n);(0,u.useEffect)((()=>{l(n)}),[n]);const s=(0,u.useCallback)(((e,t)=>{r({properties:{autoAdvance:t}}),(0,ue.trackEvent)("change_page_advancement",{status:t?"auto":"manual",duration:o})}),[r,o]),c=(0,u.useDebouncedCallback)((e=>{const t=(0,na.clamp)(e,la);e!==t&&l(t),n!==t&&(r({properties:{defaultPageDuration:t}}),(0,ue.trackEvent)("change_page_advancement",{status:a?"auto":"manual",duration:t}))}),800);(0,u.useEffect)((()=>{c(o)}),[o,c]);const d=(0,u.useCallback)(((e,t)=>l(t)),[]);return i.createElement(gt.default,{name:t||"pageAdvancement",title:(0,re.__)("Page Advancement","web-stories"),collapsedByDefault:!1},i.createElement(nt.default,null,i.createElement(ia,null,(0,re.__)("Control whether a story auto-advances between pages, or whether the reader has to manually tap to advance.","web-stories"))),i.createElement(oa,null,i.createElement(rt.default,{groupLabel:(0,re.__)("Page Advancement","web-stories"),name:"page-advancement-switch",value:a,onLabel:(0,re.__)("Auto","web-stories"),offLabel:(0,re.__)("Manual","web-stories"),onChange:s})),a&&i.createElement(nt.default,null,i.createElement(aa.NumericInput,{unit:` ${(0,re.__)("seconds","web-stories")}`,suffix:(0,re.__)("Duration","web-stories"),value:o,onChange:d,"aria-label":(0,re.__)("Default page duration in seconds","web-stories"),min:la.MIN,max:la.MAX,isFloat:!0,containerStyleOverride:ra.inputContainerStyleOverride})))}var sa=a(78955),ua=a(21931),ca=a(19977),da=a(7328),ma=a(2203);const pa={MIN:1,MAX:200},fa=(0,c.default)(nt.default).withConfig({displayName:"slug__PermalinkRow",componentId:"sc-12ylqoy-0"})(["margin-bottom:12px;input{color:",";:active,:focus,.","{color:",";}}"],(e=>{let{theme:t}=e;return t.colors.fg.tertiary}),ca.FOCUS_VISIBLE_SELECTOR,(e=>{let{theme:t}=e;return t.colors.fg.primary})),ga=c.default.div.withConfig({displayName:"slug__LinkContainer",componentId:"sc-12ylqoy-1"})(["margin-bottom:16px;"]);function SlugPanel(e){let{nameOverride:t}=e;const{slug:a,link:n,permalinkConfig:r,updateStory:o}=(0,$.default)((e=>{let{state:{story:{slug:t="",link:a,permalinkConfig:n}},actions:{updateStory:r}}=e;return{slug:t,link:a,permalinkConfig:n,updateStory:r}})),[l,s]=(0,u.useState)(a);(0,u.useEffect)((()=>{s(a)}),[a]);const c=(0,u.useCallback)((e=>{const t=e.slice(0,pa.MAX);o({properties:{slug:(0,da.default)(t)}})}),[o]),d=(0,u.useCallback)((e=>s((0,da.default)(e.target.value,!0))),[]),m=(0,u.useCallback)((e=>c(e.target.value)),[c]),p=l&&r&&(0,ma.default)(l.length,pa)?r.prefix+l+r.suffix:n;return i.createElement(gt.default,{name:t||"permalink",title:(0,re.__)("Permalink","web-stories"),collapsedByDefault:!1},r&&i.createElement(fa,null,i.createElement(sa.Input,{value:String(l),onChange:d,onBlur:m,placeholder:(0,re.__)("Enter slug","web-stories"),"aria-label":(0,re.__)("URL slug","web-stories"),minLength:pa.MIN,maxLength:pa.MAX,containerStyleOverride:ra.inputContainerStyleOverride})),i.createElement(ga,null,i.createElement(ua.Link,{rel:"noopener noreferrer",target:"_blank",href:n,size:he.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.SMALL},p)))}var ha=a(54806);const Ea=(0,c.default)(ge.Text).attrs({size:he.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.SMALL}).withConfig({displayName:"backgroundAudio__HelperText",componentId:"sc-1n4veap-0"})(["color:",";"],(e=>{let{theme:t}=e;return t.colors.fg.secondary}));function BackgroundAudioPanel(e){let{nameOverride:t}=e;const{capabilities:{hasUploadMediaAction:a}}=(0,T.default)(),{backgroundAudio:n,updateStory:r}=(0,$.default)((e=>{let{state:{story:{backgroundAudio:t}},actions:{updateStory:a}}=e;return{backgroundAudio:t,updateStory:a}})),o=(0,u.useCallback)((e=>{r({properties:{backgroundAudio:e}})}),[r]);return n||a?i.createElement(gt.default,{name:t||"backgroundAudio",title:(0,re.__)("Background Audio","web-stories"),collapsedByDefault:!0},i.createElement(nt.default,null,i.createElement(Ea,null,(0,re.__)("Select an audio file that plays throughout the story.","web-stories"))),i.createElement(ha.default,{backgroundAudio:n,updateBackgroundAudio:o})):null}var _a=a(37071);function ba(e){return(0,u.useContextSelector)(_a.default,e??u.identity)}var Ta=a(54531),Sa=a(75530),ya=a(44586);s().shape({capabilities:s().object,description:s().string,hierarchical:s().bool,labels:s().object,name:s().string.isRequired,restBase:s().string.isRequired,showCloud:s().bool,slug:s().string.isRequired,types:s().arrayOf(s().string),visibility:s().object});const Ca=(0,c.default)(Oe.Headline).attrs({as:"h3",size:he.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.XXX_SMALL}).withConfig({displayName:"shared__ContentHeading",componentId:"sc-1pfee07-0"})(["margin:4px 0 16px;font-weight:",";"],(e=>{let{theme:t}=e;return t.typography.weight.regular})),Ia=(0,c.default)(ee.Button).attrs({variant:te.BUTTON_VARIANTS.LINK}).withConfig({displayName:"shared__LinkButton",componentId:"sc-1pfee07-1"})([""," margin-bottom:16px;font-weight:500;"],Jt.expandTextPreset(((e,t)=>{let{link:a}=e,{X_SMALL:n}=t;return a[n]}))),wa=c.default.div.withConfig({displayName:"shared__SiblingBorder",componentId:"sc-1pfee07-2"})(["padding-left:16px;padding-right:16px;& + &{border-top:1px solid ",";padding-top:16px;padding-bottom:8px;}"],(e=>{let{theme:t}=e;return t.colors.divider.tertiary})),va={Heading:(0,c.default)(Ca).attrs({as:"h4"}).withConfig({displayName:"shared__Heading",componentId:"sc-1pfee07-3"})(["margin-bottom:4px;"]),Wrapper:c.default.div.withConfig({displayName:"shared__Wrapper",componentId:"sc-1pfee07-4"})(["padding:18px 0px;"]),List:c.default.ul.withConfig({displayName:"shared__List",componentId:"sc-1pfee07-5"})(["all:unset;cursor:pointer;"]),ListItem:c.default.li.withConfig({displayName:"shared__ListItem",componentId:"sc-1pfee07-6"})(["all:unset;"]),Word:(0,c.default)(Ia).withConfig({displayName:"shared__Word",componentId:"sc-1pfee07-7"})(["margin:0;display:revert;"])};var Pa=a(53897);const Aa="NO_PARENT_VALUE",ka=c.default.div.withConfig({displayName:"HierarchicalTermSelector__ContentArea",componentId:"sc-17x36f5-0"})(["label,* > label{",";color:",";}"],(e=>{let{theme:t}=e;return Jt.expandPresetStyles({preset:t.typography.presets.label[he.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.SMALL],theme:t})}),(e=>{let{theme:t}=e;return t.colors.fg.secondary})),La=c.default.form.withConfig({displayName:"HierarchicalTermSelector__AddNewCategoryForm",componentId:"sc-17x36f5-1"})(["margin:24px 0 16px;"]),Na=c.default.div.withConfig({displayName:"HierarchicalTermSelector__ButtonContainer",componentId:"sc-17x36f5-2"})(["display:flex;gap:8px;"]),xa=(0,c.default)(ge.Text).attrs({forwardedAs:"label",size:he.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.SMALL}).withConfig({displayName:"HierarchicalTermSelector__Label",componentId:"sc-17x36f5-3"})(["display:inline-block;margin:12px 0;"]),Oa=(0,c.default)(ee.Button).attrs({variant:te.BUTTON_VARIANTS.RECTANGLE,size:te.BUTTON_SIZES.SMALL,type:te.BUTTON_TYPES.SECONDARY}).withConfig({displayName:"HierarchicalTermSelector__AddNewCategoryButton",componentId:"sc-17x36f5-4"})(["margin-top:20px;"]);function HierarchicalTermSelector(e){let{noParentId:t=Aa,taxonomy:a,canCreateTerms:n}=e;const{createTerm:r,termCache:o,terms:l,setTerms:s}=ba((e=>{let{state:{termCache:t,terms:a},actions:{createTerm:n,setTerms:r}}=e;return{createTerm:n,setTerms:r,termCache:t,terms:a}})),c=(0,u.useMemo)((()=>o?.[a.restBase]?Object.values(o[a.restBase]).map((e=>({id:e.id,parent:e.parent,value:e.id,label:e.name,checked:l[a.restBase]?.includes(e.id),slug:e.slug}))):[]),[a,o,l]),[d,m]=(0,u.useState)(!1),[p,f]=(0,u.useState)(""),[g,h]=(0,u.useState)(t),E=(0,u.useMemo)(ya.default,[]),[_,b]=(0,u.useState)(!1),T=(0,u.useRef)(),S=(0,u.useRef)(),[y,C]=(0,u.useState)(!1),[I,w]=(0,u.useState)(""),v=(0,u.useCallback)((e=>w(e)),[]),P=(0,Ta.default)("assertive"),A=(0,u.useCallback)((()=>{f(""),h(t)}),[t]),k=(0,u.useCallback)(((e,t)=>{let{id:n,checked:r}=t;const o=c.find((e=>e.id===n));s(a,(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=e.findIndex((e=>e===o.id));return r&&-1===t?[...e,o.id]:!r&&t>-1?[...e.slice(0,t),...e.slice(t+1)]:e}))}),[c,s,a]),L=(0,u.useCallback)((()=>{m(!d),A(),b(!d),C(d)}),[A,d]),N=(0,u.useCallback)((e=>{f(e.target.value)}),[]),x=(0,u.useMemo)((()=>c.find((e=>e.id===g))?.slug),[g,c]),O=(0,u.useCallback)((e=>{e.preventDefault(),r(a,p,{id:g===t?0:g,slug:x},!0),P((0,wt.default)(
/* Translators: %s: Taxonomy label name. */
(0,re.__)("%s added.","web-stories"),a.labels.singular_name)),m(!1),A(),C(d)}),[r,P,p,t,A,g,d,a,x]),M=(0,u.useCallback)(((e,t)=>h(t)),[]);(0,u.useEffect)((()=>{const e=T.current;if(e){const t=e=>{"Enter"===e.key&&O(e)};return e.addEventListener("keypress",t),()=>{e.removeEventListener("keypress",t)}}return null}),[O,T]),(0,u.useEffect)((()=>{y&&S.current.focus()}),[y]);const R=(0,u.useMemo)((()=>(0,Pa.makeFlatOptionTree)(c,I)),[c,I]),B=(0,u.useMemo)((()=>[{value:Aa,label:(0,re.__)("None","web-stories")}].concat(R).map((e=>{let{$level:t,label:a,...n}=e;return{...n,label:`${Array.from({length:t},(()=>" ")).join("")} ${a}`}}))),[R]);return i.createElement(ka,null,i.createElement(Ca,null,a.labels.name),i.createElement(ct.default,{inputValue:I,onInputChange:v,label:a.labels.searchItems,options:R,onChange:k,noOptionsText:a.labels?.notFound}),n?i.createElement(i.Fragment,null,!d&&i.createElement(Ia,{ref:S,"aria-expanded":!1,onClick:L},a.labels.addNewItem),d?i.createElement(La,{ref:T,onSubmit:O},i.createElement(sa.Input,{autoFocus:!0,name:a.labels.newItemName,label:a.labels.newItemName,value:p,onChange:N,hasFocus:_}),i.createElement(xa,{htmlFor:E},a.labels.parentItem),i.createElement(Sa.DropDown,{id:E,ariaLabel:a.labels.parentItem,options:B,selectedValue:g,onMenuItemClick:M}),i.createElement(Na,null,i.createElement(Oa,{disabled:!p.length,type:"submit"},a.labels.addNewItem),i.createElement(Oa,{"aria-expanded":!0,onClick:L},(0,re.__)("Cancel","web-stories")))):null):null)}var Ma=a(24046),Ra=a(37137),Ba=a(53535);const Da={Input:Ma.default,Description:Ra.default,Label:Ba.default};var Ha=a(43304);function FlatTermSelector(e){let{taxonomy:t,canCreateTerms:a}=e;const[n,r]=(0,u.useState)([]),{createTerm:o,termCache:l,addSearchResultsToCache:s,terms:c=[],setTerms:d,addTermToSelection:m}=ba((e=>{let{state:{termCache:t,terms:a},actions:{createTerm:n,addSearchResultsToCache:r,setTerms:o,addTermToSelection:i}}=e;return{termCache:t,createTerm:n,addSearchResultsToCache:r,terms:a,setTerms:o,addTermToSelection:i}})),{undo:p}=(0,ie.default)((e=>{let{actions:{undo:t}}=e;return{undo:t}})),[f,g]=(0,u.useState)([]),h=(0,Ta.default)("assertive"),E=(0,u.useCallback)((e=>{const n=e.map((e=>[(0,da.default)(e),e])),r=n.map((e=>{let[t]=e;return t})).map((e=>l[t.restBase]?.[e])).filter((e=>e)).map((e=>e.id));(0,Ha.deepEquals)(c[t.restBase],r)||d(t,r),a&&n.filter((e=>{let[a]=e;return!l[t.restBase]?.[a]})).map((e=>{let[,t]=e;return t})).forEach((e=>o(t,e,null,!0)))}),[a,c,t,l,d,o]),_=(0,u.useDebouncedCallback)((async e=>{if(0===e.length)return void g([]);if(e.length<3)return;const a=await s(t,{search:e,per_page:20});g(a);const n=a.length,r=(0,wt.default)(
/* Translators: %d: Number of results. */
(0,re._n)("%d result found.","%d results found.","web-stories","web-stories"),n);h(r)}),300),b=(0,u.useMemo)((()=>(c[t.restBase]||[]).map((e=>Object.values(l[t.restBase]||{}).find((t=>t.id===e)))).filter((e=>void 0!==e)).map((e=>e.name))),[t,c,l]),T=(0,u.useCallback)((e=>l[t.restBase]?.[(0,da.default)(e)]?.name),[t,l]);return(0,u.useEffect)((()=>{!async function(){const e=await s(t,{orderby:"count",order:"desc",hide_empty:!0});r(e)}()}),[t,s]),i.createElement(i.Fragment,null,i.createElement(Ca,null,t.labels.name),i.createElement("div",{key:t.slug},i.createElement(Da.Label,{htmlFor:`${t.slug}-input`},t.labels.addNewItem),i.createElement(Da.Input,{id:`${t.slug}-input`,"aria-describedby":`${t.slug}-description`,name:t.slug,onTagsChange:E,onInputChange:_,tagDisplayTransformer:T,tokens:b,onUndo:p,suggestedTerms:f,suggestedTermsLabel:t?.labels?.itemsList}),i.createElement(Da.Description,{id:`${t.slug}-description`},t.labels.separateItemsWithCommas),n.length>0&&i.createElement(va.Wrapper,{"data-testid":`${t.slug}-most-used`},i.createElement(va.Heading,null,t.labels.mostUsed),i.createElement(va.List,null,n.map(((e,a)=>i.createElement(va.ListItem,{key:e.id},i.createElement(va.Word,{onClick:()=>{c[t.restBase]?.includes(e.id)||m(t,e)}},e.name,a<n.length-1&&
/* translators: delimiter used in a list */
(0,re.__)(",","web-stories")),a<n.length-1&&" ")))))))}function Ua(){return Ua=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},Ua.apply(this,arguments)}const Ya=(0,c.default)(gt.default).withConfig({displayName:"taxonomies__StyledSimplePanel",componentId:"sc-171mnp-0"})(["padding-left:0;padding-right:0;"]);function TaxonomiesPanel(e){let{nameOverride:t,...a}=e;const{capabilities:n}=(0,$.default)((e=>{let{state:{capabilities:t}}=e;return{capabilities:t}})),{taxonomies:r}=ba((e=>{let{state:{taxonomies:t}}=e;return{taxonomies:t}}));if(!r?.length)return null;const o=r.filter((e=>{const t=e?.visibility?.show_ui,a=Boolean(n[`assign-${e?.restBase}`]||n[`assign-${e?.slug}`]);return t&&a}));return 0===o.length?null:i.createElement(Ya,Ua({name:t||"taxonomies",title:(0,re.__)("Taxonomies","web-stories")},a),o.map((e=>{const t=Boolean(n[`create-${e?.restBase}`]||n[`create-${e?.slug}`]);return i.createElement(wa,{key:e.slug},e.hierarchical?i.createElement(HierarchicalTermSelector,{taxonomy:e,canCreateTerms:t}):i.createElement(FlatTermSelector,{taxonomy:e,canCreateTerms:t}))})))}var Fa=a(13618),Ga=a(56453),ja=a(97596),za=a(9170),Va=a(65426),Wa=a(5053),Xa=a(63214),$a=a(29059),Za=a(24807),Ka=a(55394),qa=a(96548),Qa=a(11209),Ja=a(8236),en=a(50097),tn=a(80439),an=a(99690),nn=a(93841);const ElementLinkTappableRegionTooBig=()=>{const e=(0,nn.useIsChecklistMounted)(),t=(0,$.default)((e=>{let{state:t}=e;return t?.pages})),a=(0,qa.default)((e=>{let{state:{pageWidth:t,pageHeight:a}}=e;return{width:t,height:a}})),n=(0,u.useMemo)((()=>a.height>0&&(0,an.filterStoryElements)(t,(e=>function(e,t){return!(!["text","image","shape","gif","video"].includes(e.type)||!e.link?.url?.length)&&e.width*e.height/(t.width*t.height)*100>80}(e,a)))),[t,a]),r=(0,Et.default)((e=>{let{setHighlights:t}=e;return t})),o=(0,u.useCallback)(((e,t)=>r({elementId:e,pageId:t})),[r]),l=n.length>0;(0,Se.useRegisterCheck)("ElementLinkTappableRegionTooBig",l);const{title:s,footer:c}=Ie.ACCESSIBILITY_COPY.linkTappableRegionTooBig,d=(n||[]).map((e=>i.createElement(en.default,{key:e.id,onClick:()=>o(e.id,e.pageId),type:Pe.THUMBNAIL_TYPES.TEXT,displayBackground:i.createElement(tn.LayerThumbnail,{page:e}),"aria-label":(0,re.__)("Go to offending link","web-stories")})));return l&&e&&i.createElement(Qa.default,{title:s,cardType:n.length>1?ve.CARD_TYPE.MULTIPLE_ISSUE:ve.CARD_TYPE.SINGLE_ISSUE,footer:i.createElement(Ja.DefaultFooterText,null,c),thumbnails:d})};function rn(e){return!(!["text","image","shape","gif","video"].includes(e.type)||!e.link?.url?.length)&&(e.width<48||e.height<48)}const ElementLinkTappableRegionTooSmall=()=>{const e=(0,nn.useIsChecklistMounted)(),t=(0,$.default)((e=>{let{state:t}=e;return t?.pages})),a=(0,u.useMemo)((()=>(0,an.filterStoryElements)(t,rn)),[t]),n=(0,Et.default)((e=>{let{setHighlights:t}=e;return t})),r=(0,u.useCallback)(((e,t)=>n({elementId:e,pageId:t})),[n]),o=a.map((e=>i.createElement(en.default,{key:e.id,onClick:()=>r(e.id,e.pageId),type:Pe.THUMBNAIL_TYPES.TEXT,displayBackground:i.createElement(tn.LayerThumbnail,{page:e}),"aria-label":(0,re.__)("Go to offending link","web-stories")}))),l=a.length>0;(0,Se.useRegisterCheck)("ElementLinkTappableRegionTooSmall",l);const{title:s,footer:c}=Ie.ACCESSIBILITY_COPY.linkTappableRegionTooSmall;return l&&e&&i.createElement(Qa.default,{title:s,cardType:a.length>1?ve.CARD_TYPE.MULTIPLE_ISSUE:ve.CARD_TYPE.SINGLE_ISSUE,footer:i.createElement(Ja.DefaultFooterText,null,c),thumbnails:o})};function on(e){return["gif","image"].includes(e.type)&&!e.alt?.length&&!e.resource?.alt?.length}const ImageElementMissingAlt=()=>{const e=(0,nn.useIsChecklistMounted)(),t=(0,$.default)((e=>{let{state:t}=e;return t?.pages})),a=(0,u.useMemo)((()=>(0,an.filterStoryElements)(t,on)),[t]),n=(0,Et.default)((e=>{let{setHighlights:t}=e;return t})),r=(0,u.useCallback)(((e,t)=>n({pageId:t,elementId:e,highlight:Ce.default.ASSISTIVE_TEXT})),[n]),{footer:o,title:l}=Ie.ACCESSIBILITY_COPY.imagesMissingAltText,s=a.length>0;(0,Se.useRegisterCheck)("ImageElementMissingAlt",s);const c=a.map((e=>i.createElement(en.default,{key:e.id,onClick:()=>r(e.id,e.pageId),type:Pe.THUMBNAIL_TYPES.IMAGE,displayBackground:i.createElement(tn.LayerThumbnail,{page:e}),"aria-label":(0,re.__)("Go to offending video","web-stories")})));return s&&e&&i.createElement(Qa.default,{title:l,cardType:a.length>1?ve.CARD_TYPE.MULTIPLE_ISSUE:ve.CARD_TYPE.SINGLE_ISSUE,footer:i.createElement(Ja.DefaultFooterText,null,o),thumbnails:c})};var ln=a(56446);function sn(e){if(!["image","gif"].includes(e.type))return!1;const t=(e.scale||100)/100;return e.resource?.height<e.height*t*2||e.resource?.width<e.width*t*2}const ImageElementResolution=()=>{const e=(0,nn.useIsChecklistMounted)(),t=(0,$.default)((e=>{let{state:t}=e;return t?.pages})),a=(0,u.useMemo)((()=>(0,an.filterStoryElements)(t,sn)),[t]),n=(0,Et.default)((e=>{let{setHighlights:t}=e;return t})),r=(0,u.useCallback)(((e,t)=>n({pageId:t,elementId:e})),[n]),{footer:o,title:l}=Ie.DESIGN_COPY.imageResolutionTooLow,s=a.length>0;(0,Se.useRegisterCheck)("ImageElementResolution",s);const c=a.map((e=>i.createElement(en.default,{key:e.id,onClick:()=>r(e.id,e.pageId),type:Pe.THUMBNAIL_TYPES.IMAGE,displayBackground:i.createElement(tn.LayerThumbnail,{page:e}),"aria-label":(0,re.__)("Go to offending image","web-stories")})));return s&&e&&i.createElement(Qa.default,{title:l,cardType:a.length>1?ve.CARD_TYPE.MULTIPLE_ISSUE:ve.CARD_TYPE.SINGLE_ISSUE,footer:i.createElement(we.CardListWrapper,null,i.createElement(ln.List,{size:he.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.X_SMALL},o)),thumbnails:c})},ThumbnailPagePreview=e=>{let{page:t}=e;return i.createElement(Ae.default,{page:t,width:Pe.THUMBNAIL_DIMENSIONS.WIDTH,height:Pe.THUMBNAIL_DIMENSIONS.HEIGHT,as:"div",help:"checklist",isActive:!0,className:"pagePreviewOverrides"})};var un=a(13688);const PageBackgroundTextLowContrast=()=>{const e=(0,nn.useIsChecklistMounted)(),[t,a]=(0,u.useState)([]),n=(0,$.default)((e=>{let{state:t}=e;return t?.pages})),r=(0,qa.default)((e=>{let{state:{pageWidth:t,pageHeight:a}}=e;return{width:t,height:a}}));(0,u.useEffect)((()=>{let e=!1;return(0,un.getPagesWithFailedContrast)(n,r).then((t=>{if(e)return;const n=t.map((e=>{let{page:t}=e;return t}));a(n)})).catch((()=>{})),()=>{e=!0}}),[n,r]);const o=(0,Et.default)((e=>{let{setHighlights:t}=e;return t})),l=(0,u.useCallback)((e=>o({pageId:e})),[o]),s=t.length>0;(0,Se.useRegisterCheck)("PageBackgroundTextLowContrast",s);const{title:c,footer:d}=Ie.ACCESSIBILITY_COPY.lowContrast;return s&&e?i.createElement(Qa.default,{title:c,cardType:t.length>1?ve.CARD_TYPE.MULTIPLE_ISSUE:ve.CARD_TYPE.SINGLE_ISSUE,footer:i.createElement(Ja.DefaultFooterText,null,d),thumbnails:t.map((e=>i.createElement(en.default,{key:e.id,onClick:()=>l(e.id),type:Pe.THUMBNAIL_TYPES.PAGE,displayBackground:i.createElement(ThumbnailPagePreview,{page:e}),"aria-label":(0,re.__)("Go to offending page","web-stories")})))}):null};function cn(e){let t=0;return e.elements.forEach((e=>{"text"===e.type&&(t+=(0,le.stripHTML)(e.content).length)})),t}var dn=a(99236);function mn(e){return cn(e)<Ie.MIN_STORY_CHARACTER_COUNT}const PageTooLittleText=()=>{const e=(0,nn.useIsChecklistMounted)(),t=(0,$.default)((e=>{let{state:t}=e;return t?.pages})),a=(0,u.useMemo)((()=>(0,dn.filterStoryPages)(t,mn)),[t]),n=(0,Et.default)((e=>{let{setHighlights:t}=e;return t})),r=(0,u.useCallback)((e=>n({pageId:e})),[n]),{footer:o,title:l}=Ie.DESIGN_COPY.tooLittlePageText,s=a.length>0;(0,Se.useRegisterCheck)("PageTooLittleText",s);const c=a.map((e=>i.createElement(en.default,{key:e.id,onClick:()=>r(e.id),type:Pe.THUMBNAIL_TYPES.PAGE,displayBackground:i.createElement(ThumbnailPagePreview,{page:e}),"aria-label":(0,re.__)("Go to offending page","web-stories")})));return s&&e?i.createElement(Qa.default,{title:l,cardType:a.length>1?ve.CARD_TYPE.MULTIPLE_ISSUE:ve.CARD_TYPE.SINGLE_ISSUE,footer:i.createElement(Ja.DefaultFooterText,null,o),thumbnails:c}):null};function pn(e){return e.elements.filter((e=>Boolean(e.link?.url?.length))).length>Ie.MAX_LINKS_PER_PAGE}const PageTooManyLinks=()=>{const e=(0,nn.useIsChecklistMounted)(),t=(0,$.default)((e=>{let{state:t}=e;return t?.pages})),a=(0,u.useMemo)((()=>(0,dn.filterStoryPages)(t,pn)),[t]),n=(0,Et.default)((e=>{let{setHighlights:t}=e;return t})),r=(0,u.useCallback)((e=>n({pageId:e})),[n]),{footer:o,title:l}=Ie.DESIGN_COPY.tooManyLinksOnPage,s=a.length>0;(0,Se.useRegisterCheck)("PageTooManyLinks",s);const c=a.map((e=>i.createElement(en.default,{key:e.id,onClick:()=>r(e.id),type:Pe.THUMBNAIL_TYPES.PAGE,displayBackground:i.createElement(ThumbnailPagePreview,{page:e}),"aria-label":(0,re.__)("Go to offending page","web-stories")})));return s&&e&&i.createElement(Qa.default,{title:l,cardType:a.length>1?ve.CARD_TYPE.MULTIPLE_ISSUE:ve.CARD_TYPE.SINGLE_ISSUE,footer:i.createElement(Ja.DefaultFooterText,null,o),thumbnails:c})};function pageTooMuchText_x(e){return cn(e)>Ie.MAX_PAGE_CHARACTER_COUNT}const PageTooMuchText=()=>{const e=(0,nn.useIsChecklistMounted)(),t=(0,$.default)((e=>{let{state:t}=e;return t?.pages})),a=(0,u.useMemo)((()=>(0,dn.filterStoryPages)(t,pageTooMuchText_x)),[t]),n=(0,Et.default)((e=>{let{setHighlights:t}=e;return t})),r=(0,u.useCallback)((e=>{let{pageId:t,elements:a}=e;return n({pageId:t,elements:a})}),[n]),{footer:o,title:l}=Ie.DESIGN_COPY.tooMuchPageText,s=a.length>0;(0,Se.useRegisterCheck)("PageTooMuchText",s);const c=a.map((e=>i.createElement(en.default,{key:e.id,onClick:()=>r({pageId:e.id,elements:e.elements.filter((e=>{let{type:t}=e;return"text"===t}))}),type:Pe.THUMBNAIL_TYPES.PAGE,displayBackground:i.createElement(ThumbnailPagePreview,{page:e}),"aria-label":(0,re.__)("Go to offending page","web-stories")})));return s&&e&&i.createElement(Qa.default,{title:l,cardType:a.length>1?ve.CARD_TYPE.MULTIPLE_ISSUE:ve.CARD_TYPE.SINGLE_ISSUE,footer:i.createElement(we.CardListWrapper,null,i.createElement(ln.List,{size:he.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.X_SMALL},o)),thumbnails:c})};const PublisherLogoMissing=()=>{const e=(0,nn.useIsChecklistMounted)(),t=(0,$.default)((e=>{let{state:t}=e;return t?.story?.publisherLogo})),a=(0,Et.default)((e=>{let{setHighlights:t}=e;return t})),n=(0,u.useCallback)((()=>a({highlight:Ce.default.PUBLISHER_LOGO})),[a]),r=!t?.id;(0,Se.useRegisterCheck)("PublisherLogoMissing",r);const{footer:o,title:l}=Ie.PRIORITY_COPY.noPublisherLogo;return r&&e&&i.createElement(Qa.default,{title:l,titleProps:{onClick:n},footer:i.createElement(we.CardListWrapper,null,i.createElement(ln.List,{size:he.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.X_SMALL},o))})};const PublisherLogoSize=()=>{const e=(0,nn.useIsChecklistMounted)(),t=(0,$.default)((e=>{let{state:t}=e;return t?.story?.publisherLogo})),a=(0,Et.default)((e=>{let{setHighlights:t}=e;return t})),n=(0,u.useCallback)((()=>a({highlight:Ce.default.PUBLISHER_LOGO})),[a]),r=(o=t,Boolean(o?.id)&&(o?.height<Ie.PUBLISHER_LOGO_DIMENSION||o?.width<Ie.PUBLISHER_LOGO_DIMENSION));var o;(0,Se.useRegisterCheck)("PublisherLogoSize",r);const{footer:l,title:s}=Ie.PRIORITY_COPY.logoTooSmall;return r&&e&&i.createElement(Qa.default,{title:s,titleProps:{onClick:n},footer:i.createElement(we.CardListWrapper,null,i.createElement(ln.List,{size:he.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.X_SMALL},l))})};const StoryAmpValidationErrors=()=>{const e=(0,u.useRef)(),{isSaving:t,link:a,status:n}=(0,$.default)((e=>{let{state:t}=e;return{isSaving:t.meta.isSaving,link:t.story.link,status:t.story.status}})),[r,o]=(0,u.useState)(!1);(0,u.useEffect)((()=>{let r=!0;return t||async function(e){let{link:t,status:a}=e;if(!t||!["publish","future"].includes(a))return!1;try{const e=await fetch(t),a=await e.text();await window.amp.validator.init();const n=window.amp.validator.validateString(a),{status:r,errors:o}=n;return"FAIL"===r&&o.filter((e=>{let{severity:t}=e;return"ERROR"===t})).filter((e=>{let{code:t,params:a}=e;return!("MISSING_URL"===t&&a?.[0].startsWith("poster")||"MISSING_URL"===t&&a?.[0].startsWith("publisher-logo")||"INVALID_URL_PROTOCOL"===t&&a?.[0].startsWith("src"))})).length>0}catch{return!1}}({link:a,status:n}).then((t=>{r&&(o(t),t&&!e?.current&&(e.current=!0))})),()=>{r=!1}}),[a,n,t]),(0,u.useEffect)((()=>{r&&e?.current&&(0,ue.trackEvent)("amp_validation_errors_found")}),[r]),(0,Se.useRegisterCheck)("StoryHasAmpErrors",r);const{footer:l,title:s}=Ie.PRIORITY_COPY.ampValidation;return r&&i.createElement(Qa.default,{title:s,footer:i.createElement(Ja.DefaultFooterText,null,l)})};const StoryMissingExcerpt=()=>{const e=(0,nn.useIsChecklistMounted)(),t=(0,$.default)((e=>{let{state:t}=e;return t?.story?.excerpt})),a=(0,Et.default)((e=>{let{setHighlights:t}=e;return t})),n=(0,u.useCallback)((()=>a({highlight:Ce.default.EXCERPT})),[a]),{title:r,footer:o}=Ie.PRIORITY_COPY.storyMissingDescription,l=!t?.length;return(0,Se.useRegisterCheck)("StoryMissingExcerpt",l),l&&e?i.createElement(Qa.default,{title:r,titleProps:{onClick:n},footer:i.createElement(Ja.DefaultFooterText,null,o)}):null};const StoryMissingTitle=()=>{const e=(0,nn.useIsChecklistMounted)(),t=(0,$.default)((e=>{let{state:t}=e;return t?.story?.title})),a=(0,Et.default)((e=>{let{setHighlights:t}=e;return t})),n=(0,u.useCallback)((()=>a({highlight:Ce.default.STORY_TITLE})),[a]),r="string"!=typeof(o=t)||""===o?.trim();var o;(0,Se.useRegisterCheck)("StoryMissingTitle",r);const{footer:l,title:s}=Ie.PRIORITY_COPY.storyMissingTitle;return r&&e?i.createElement(Qa.default,{title:s,titleProps:{onClick:n},footer:i.createElement(we.CardListWrapper,null,i.createElement(ln.List,{size:he.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.X_SMALL},l))}):null};const StoryPagesCount=()=>{const e=(0,nn.useIsChecklistMounted)(),t=(0,$.default)((e=>{let{state:t}=e;return t?.pages?.length})),{hasTooFewPages:a,hasTooManyPages:n}=(0,u.useMemo)((()=>{return{hasTooFewPages:(e=t)<Ie.MIN_STORY_PAGES,hasTooManyPages:e>Ie.MAX_STORY_PAGES};var e}),[t]),{storyTooShort:r,storyTooLong:o}=Ie.DESIGN_COPY,l=a&&r||n&&o||{},s=a||n;return(0,Se.useRegisterCheck)("StoryPagesCount",s),s&&e&&i.createElement(Qa.default,{title:l.title,footer:i.createElement(Ja.DefaultFooterText,null,l.title)})};var fn=a(44978);function StoryPosterAttached(){const e=(0,nn.useIsChecklistMounted)(),t=(0,$.default)((e=>{let{state:t}=e;return t?.story?.featuredMedia})),a=(0,Et.default)((e=>{let{setHighlights:t}=e;return t})),n=(0,u.useCallback)((()=>a({highlight:Ce.default.POSTER})),[a]),r=(0,u.useMemo)((()=>{return"string"!=typeof(e=t)?.url||(0,fn.hasNoFeaturedMedia)({featuredMedia:e});var e}),[t]);(0,Se.useRegisterCheck)("StoryPosterAttached",r);const{title:o,footer:l}=Ie.PRIORITY_COPY.storyMissingPoster;return r&&e?i.createElement(Qa.default,{title:o,titleProps:{onClick:n},footer:i.createElement(we.CardListWrapper,null,i.createElement(ln.List,{size:he.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.X_SMALL},l))}):null}const StoryPosterSize=()=>{const e=(0,nn.useIsChecklistMounted)(),t=(0,$.default)((e=>{let{state:t}=e;return t?.story?.featuredMedia})),a=(0,Et.default)((e=>{let{setHighlights:t}=e;return t})),n=(0,u.useCallback)((()=>a({highlight:Ce.default.POSTER})),[a]),{footer:r,title:o}=Ie.PRIORITY_COPY.storyPosterSize,l=(0,u.useMemo)((()=>{return e=t,!(0,fn.hasNoFeaturedMedia)({featuredMedia:e})&&(e?.height<Ie.FEATURED_MEDIA_RESOURCE_MIN_HEIGHT||e?.width<Ie.FEATURED_MEDIA_RESOURCE_MIN_WIDTH||!(Math.abs(e.width/e.height-Ie.ASPECT_RATIO_LEFT/Ie.ASPECT_RATIO_RIGHT)<=.001));var e}),[t]);return(0,Se.useRegisterCheck)("StoryPosterSize",l),l&&e&&i.createElement(Qa.default,{title:o,titleProps:{onClick:n},footer:i.createElement(we.CardListWrapper,null,i.createElement(ln.List,{size:he.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.X_SMALL},r))})};const StoryTitleLength=()=>{const e=(0,nn.useIsChecklistMounted)(),t=(0,$.default)((e=>{let{state:t}=e;return t?.story?.title})),a=(0,Et.default)((e=>{let{setHighlights:t}=e;return t})),n=(0,u.useCallback)((()=>a({highlight:Ce.default.STORY_TITLE})),[a]),r=t?.length>Ie.MAX_STORY_TITLE_LENGTH_CHARS;(0,Se.useRegisterCheck)("StoryTitleLength",r);const{title:o,footer:l}=Ie.PRIORITY_COPY.storyTitleTooLong;return r&&e&&i.createElement(Qa.default,{title:o,footer:i.createElement(Ja.DefaultFooterText,null,l),titleProps:{onClick:n}})};function gn(e){return"text"===e.type&&e.fontSize&&e.fontSize<Ie.MIN_FONT_SIZE}const TextElementFontSizeTooSmall=()=>{const e=(0,nn.useIsChecklistMounted)(),t=(0,$.default)((e=>{let{state:t}=e;return t?.pages})),a=(0,u.useMemo)((()=>(0,an.filterStoryElements)(t,gn)),[t]),n=(0,Et.default)((e=>{let{setHighlights:t}=e;return t})),r=(0,u.useCallback)(((e,t)=>n({elementId:e,pageId:t})),[n]),{footer:o,title:l}=Ie.ACCESSIBILITY_COPY.fontSizeTooSmall,s=a.length>0;(0,Se.useRegisterCheck)("TextElementFontSizeTooSmall",s);const c=a.map((e=>i.createElement(en.default,{key:e.id,onClick:()=>r(e.id,e.pageId),type:Pe.THUMBNAIL_TYPES.TEXT,displayBackground:i.createElement(tn.LayerThumbnail,{page:e}),"aria-label":(0,re.__)("Go to offending text element","web-stories")})));return s&&e&&i.createElement(Qa.default,{title:l,cardType:a.length>1?ve.CARD_TYPE.MULTIPLE_ISSUE:ve.CARD_TYPE.SINGLE_ISSUE,footer:i.createElement(Ja.DefaultFooterText,null,o),thumbnails:c})};function hn(){return hn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},hn.apply(this,arguments)}function VideoChecklistCard(e){let{elements:t,footer:a,onThumbnailClick:n,...r}=e;return i.createElement(Qa.default,hn({},r,{cardType:t.length>1?ve.CARD_TYPE.MULTIPLE_ISSUE:ve.CARD_TYPE.SINGLE_ISSUE,footer:i.createElement(Ja.DefaultFooterText,null,a),thumbnails:t.map((e=>i.createElement(en.default,{key:e.id,onClick:()=>n(e.id,e.pageId),type:Pe.THUMBNAIL_TYPES.VIDEO,displayBackground:i.createElement(tn.LayerThumbnail,{page:e}),"aria-label":(0,re.__)("Go to offending video","web-stories")})))}))}function En(e){return"video"===e.type&&e.resource?.length>Ie.MAX_VIDEO_LENGTH_SECONDS}const VideoElementLength=()=>{const e=(0,nn.useIsChecklistMounted)(),t=(0,$.default)((e=>{let{state:t}=e;return t?.pages})),a=(0,u.useMemo)((()=>(0,an.filterStoryElements)(t,En)),[t]),n=(0,Et.default)((e=>{let{setHighlights:t}=e;return t})),r=(0,u.useCallback)(((e,t)=>n({elementId:e,pageId:t})),[n]),{footer:o,title:l}=Ie.DESIGN_COPY.videoTooLong,s=a.length>0;return(0,Se.useRegisterCheck)("VideoElementLength",s),s&&e&&i.createElement(VideoChecklistCard,{title:l,elements:a,footer:o,onThumbnailClick:r})};function _n(e){return"video"===e.type&&!e?.resource?.isMuted&&!e.tracks?.length}const VideoElementMissingCaptions=()=>{const e=(0,nn.useIsChecklistMounted)(),t=(0,$.default)((e=>{let{state:t}=e;return t?.pages})),a=(0,u.useMemo)((()=>(0,an.filterStoryElements)(t,_n)),[t]),n=(0,Et.default)((e=>{let{setHighlights:t}=e;return t})),r=(0,u.useCallback)(((e,t)=>n({pageId:t,elementId:e,highlight:Ce.default.CAPTIONS})),[n]),{footer:o,title:l}=Ie.ACCESSIBILITY_COPY.videoMissingCaptions,s=a.length>0;return(0,Se.useRegisterCheck)("VideoElementMissingCaptions",s),s&&e&&i.createElement(VideoChecklistCard,{title:l,elements:a,footer:o,onThumbnailClick:r})};function bn(e){return"video"===e.type&&!e.alt?.length&&!e.resource?.alt?.length}const VideoElementMissingDescription=()=>{const e=(0,nn.useIsChecklistMounted)(),t=(0,$.default)((e=>{let{state:t}=e;return t?.pages})),a=(0,u.useMemo)((()=>(0,an.filterStoryElements)(t,bn)),[t]),n=(0,Et.default)((e=>{let{setHighlights:t}=e;return t})),r=(0,u.useCallback)(((e,t)=>n({pageId:t,elementId:e,highlight:Ce.default.ASSISTIVE_TEXT})),[n]),{footer:o,title:l}=Ie.ACCESSIBILITY_COPY.videoMissingTitle,s=a.length>0;return(0,Se.useRegisterCheck)("VideoElementMissingDescription",s),s&&e&&i.createElement(VideoChecklistCard,{title:l,elements:a,footer:o,onThumbnailClick:r})};function Tn(e){return"video"===e.type&&!e.resource?.poster&&!e.poster}const VideoElementMissingPoster=()=>{const e=(0,nn.useIsChecklistMounted)(),t=(0,$.default)((e=>{let{state:t}=e;return t?.pages})),a=(0,u.useMemo)((()=>(0,an.filterStoryElements)(t,Tn)),[t]),n=(0,Et.default)((e=>{let{setHighlights:t}=e;return t})),r=(0,u.useCallback)(((e,t)=>n({pageId:t,elementId:e,highlight:Ce.default.VIDEO_A11Y_POSTER})),[n]),{footer:o,title:l}=Ie.PRIORITY_COPY.videoMissingPoster,s=a.length>0;return(0,Se.useRegisterCheck)("VideoElementMissingPoster",s),s&&e&&i.createElement(VideoChecklistCard,{title:l,elements:a,footer:o,onThumbnailClick:r})};function Sn(e){return"video"===e.type&&(e.resource?.height<=Ie.MIN_VIDEO_HEIGHT&&e.resource?.width<=Ie.MIN_VIDEO_WIDTH)}const VideoElementResolution=()=>{const e=(0,nn.useIsChecklistMounted)(),t=(0,$.default)((e=>{let{state:t}=e;return t?.pages})),a=(0,u.useMemo)((()=>(0,an.filterStoryElements)(t,Sn)),[t]),n=(0,Et.default)((e=>{let{setHighlights:t}=e;return t})),r=(0,u.useCallback)(((e,t)=>n({elementId:e,pageId:t})),[n]),{footer:o,title:l}=Ie.DESIGN_COPY.videoResolutionTooLow,s=a.length>0;return(0,Se.useRegisterCheck)("VideoElementResolution",s),s&&e&&i.createElement(VideoChecklistCard,{title:l,elements:a,footer:o,onThumbnailClick:r})};var yn=a(50869);function defaultCtaButton_n(){return defaultCtaButton_n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},defaultCtaButton_n.apply(this,arguments)}const DefaultCtaButton=e=>{let{children:t,...a}=e;return i.createElement(ee.Button,defaultCtaButton_n({size:te.BUTTON_SIZES.SMALL,type:te.BUTTON_TYPES.SECONDARY},a),t)};var Cn=a(20653),In=a(94645),wn=a(83457),vn=a(46340),Pn=a(15890),An=a(45504),kn=a(24035),Ln=a(66782)},15890:(e,t,a)=>{a.d(t,{GlobalStyle:()=>i});var n=a(58804),r=a(74350),o=a(15339);a(35343);const i=(0,n.createGlobalStyle)(["ul#adminmenu a.wp-has-current-submenu::after{border-right-color:",";}.web-stories-content b,.web-stories-content strong{font-weight:bold;}body.edit-story #wpbody *{",";}"],r.theme.colors.bg.secondary,o.scrollbarCSS)},45743:(e,t,a)=>{a.d(t,{calculateLuminanceFromRGB:()=>r,calculateLuminanceFromStyleColor:()=>o,checkContrastFromLuminances:()=>i,getAccessibleTextColorsFromPixels:()=>s});var n=a(88862);function r(e){const{r:t,g:a,b:r,a:o=1}=e;return n.relativeLuminance({r:t/255,g:a/255,b:r/255,a:o})}function o(e){const t=n.str2rgba(e);return n.relativeLuminance(t)}function i(e,t,a){const r=n.contrast(e,t);return{ratio:r,WCAG_AA:n.aa(r,a)}}function l(e,t,a){return i(r({r:e[0],g:e[1],b:e[2]}),r({r:t[0],g:t[1],b:t[2]}),a)}function s(e,t){const a=[255,255,255,255],n=[0,0,0,255],r=[],o={r:255,g:255,b:255,a:1},i={r:0,g:0,b:0,a:1};for(let t=0;t<e.length;t+=4)r.push([e[t],e[t+1],e[t+2],e[t+3]]);const s=r.map((e=>l(n,e,t)));if(!s.some((e=>{let{WCAG_AA:t}=e;return!t})))return{color:i};const u=r.map((e=>l(a,e,t)));return u.some((e=>{let{WCAG_AA:t}=e;return!t}))?s.reduce(((e,t)=>e+t.ratio),0)<u.reduce(((e,t)=>e+t.ratio),0)?{color:i,backgroundColor:{...o,a:.7}}:{color:o,backgroundColor:{...i,a:.7}}:{color:o}}},40282:(e,t,a)=>{a.d(t,{default:()=>l});var n=a(26613),r=a(66093),o=a(69305);async function i(e){const{default:t}=await a.e(269).then(a.bind(a,80269));return new Promise(((a,o)=>{try{const n=(new t).getColor(e);a((0,r.default)(n))}catch(e){(0,n.trackError)("image_base_color",e.message),o(e)}}))}async function l(e){let t,a,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"auto";if(!e)throw new Error("No source to image");const s=(0,n.getTimeTracker)("load_get_base_color");try{a=await(0,o.default)({src:e,width:r,height:l}),t=await i(a)}catch(e){if("TypeError"!==e?.name)throw e;t="#ffffff"}finally{a?.remove(),s()}return t}},28841:(e,t,a)=>{a.d(t,{default:()=>o});var n=a(35343),r=(a(67294),a(54e3),a(28377),a(40823),a(47390));function o(){const{actions:{getProxyUrl:e}}=(0,r.default)(),t=(0,n.useCallback)((async e=>{let t=!1;if(!e)return t;try{await fetch(e,{method:"HEAD"})}catch(e){t=!0}return t}),[]);return{getProxiedUrl:(0,n.useCallback)(((t,a)=>{const{needsProxy:n}=t;return n&&a?e(a):a}),[e]),checkResourceAccess:t}}},37870:(e,t,a)=>{a.d(t,{default:()=>i});var n=a(35343),r=(a(55537),a(84296),a(17166),a(40169),a(89703),a(67294),a(54e3),a(28377),a(40823),a(19040),a(89157),a(29184),a(73393),a(26613),a(70746),a(60211),a(13851),a(46345),a(76129),a(11606),a(37890),a(30738),a(50067),a(28410),a(24763),a(21303),a(34639),a(84401)),o=(a(93909),a(39751),a(9219),a(79074),a(12221),a(41657),a(249),a(32696),a(88476));a(63594),a(16243),a(77850),a(697),a(65290),a(80951),a(73071),a(7377),a(55376),a(24355),a(62313),a(83859);function i(){const e=(0,r.default)((e=>{let{state:{pages:t=[]}}=e;return t.reduce(((e,t)=>(e.push(...t.elements.filter((e=>{let{type:t,isExternal:a}=e;return["image","video","gif"].includes(t)&&!a})).map((e=>{let{resource:t}=e;return t.id}))),e)),[])})),{isCurrentResourceUploading:t,isCurrentResourceProcessing:a}=(0,o.default)((e=>{let{state:{isCurrentResourceUploading:t,isCurrentResourceProcessing:a}}=e;return{isCurrentResourceUploading:t,isCurrentResourceProcessing:a}}));return(0,n.useMemo)((()=>Boolean(e?.some((e=>t(e)||a(e))))),[e,t,a])}},19675:(e,t,a)=>{a.d(t,{default:()=>i});var n=a(35343),r=a(65197),o=a(58167);function i(e,t){return(0,n.useCallback)((()=>{try{const a=new URL(t);a.hash=window.location.hash,window.history.replaceState({id:e},(0,r.default)(
/* translators: %d: current story id. */
(0,o.__)("Post %d","web-stories"),e),a.toString())}catch(e){}}),[e,t])}},79244:(e,t,a)=>{a.d(t,{default:()=>m});var n=a(35343),r=a(8684),o=(a(67294),a(28377),a(97506)),i=a(49711),l=a(73968);function s(e){const t=e.getBoundingClientRect();return{x:t.left+t.width/2,y:t.top+t.height/2}}function u(e,t,a){return a>0?(0,i.getNextEnabledElement)(e,t,a):(0,l.getNextEnabledSibling)(e,t)}function c(e,t){return(e?"ArrowRight"===t||"ArrowUp"===t||"PageUp"===t:"ArrowLeft"===t||"ArrowUp"===t||"PageUp"===t)?"previousSibling":"nextSibling"}function d(e,t,a){const n=s(e);let r=null,o=null,i=null;for(let d=u(e,t,a);d;d=u(d,t,a)){const e=s(d);if(Math.floor(e.y)===Math.floor(n.y))continue;if(r&&Math.floor(e.y)>Math.floor(o.y))break;const t=(l=n,c=e,Math.pow(l.x-c.x,2)+Math.pow(l.y-c.y,2));(!i||t<i)&&(i=t,o=e,r=d)}var l,c;return r}function m(e){let{ref:t}=e,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const{isRTL:s}=(0,o.default)(),m=(0,n.useCallback)((e=>{let{key:t,target:a}=e;const n=a,r=c(s,t),o=e=>{if(e){const t=l>0?(0,i.getAncestorByDepth)(e,l):e;n.tabIndex=-1,e.tabIndex=0,e.focus(),t.scrollIntoView("previousSibling"===r)}};if("ArrowLeft"===t||"ArrowRight"===t){const e=u(n,r,l);e&&o(e)}else if("ArrowUp"===t||"ArrowDown"===t){const e=d(n,r,l);e?(n.tabIndex=-1,e.tabIndex=0,e.focus()):o("ArrowUp"===t?l>0?(0,i.getFocusableChild)(n,l):n.parentNode.firstChild:l>0?(0,i.getFocusableChild)(n,l,"lastChild"):n.parentNode.lastChild)}else if("Home"===t)o(l>0?(0,i.getFocusableChild)(n,l):n.parentNode.firstChild);else if("End"===t)o(l>0?(0,i.getFocusableChild)(n,l,"lastChild"):n.parentNode.lastChild);else if("PageDown"===t||"PageUp"===t){let e=n;for(let t=0;u(e,r,l)&&t<5;e=u(e,r,l))t++;o(e)}}),[s,l]);(0,r.useKeyDownEffect)(t,{key:["up","down","left","right","pageup","pagedown","home","end"]},m,[t,m,...a])}},19040:(e,t,a)=>{a.d(t,{ensureFontLoaded:()=>i.default,escapeHTML:()=>o,loadInlineStylesheet:()=>l.loadInlineStylesheet,loadStylesheet:()=>l.loadStylesheet,stripHTML:()=>n.default});var n=a(71078);const r=document.createElement("div");function o(e){return r.textContent=e,r.innerHTML}var i=a(28727),l=a(63929)},74187:(e,t,a)=>{a.d(t,{getTemplateMetaData:()=>r});var n=a(59875);function r(){return Promise.all(n.TEMPLATE_NAMES.map((e=>function __variableDynamicImportRuntime0__(e){switch(e){case"./raw/12-hours-in-barcelona/metaData.js":return a.e(4666).then(a.bind(a,4666));case"./raw/a-day-in-the-life/metaData.js":return a.e(5102).then(a.bind(a,35102));case"./raw/ace-hotel-kyoto-review/metaData.js":return a.e(154).then(a.bind(a,70154));case"./raw/album-releases/metaData.js":return a.e(1655).then(a.bind(a,41655));case"./raw/all-about-cars/metaData.js":return a.e(6597).then(a.bind(a,26597));case"./raw/almodos-films/metaData.js":return a.e(3140).then(a.bind(a,13140));case"./raw/an-artists-legacy/metaData.js":return a.e(4748).then(a.bind(a,14748));case"./raw/art-books-gift-guide/metaData.js":return a.e(509).then(a.bind(a,70509));case"./raw/baking-bread-guide/metaData.js":return a.e(3999).then(a.bind(a,3999));case"./raw/beauty-quiz/metaData.js":return a.e(7496).then(a.bind(a,67496));case"./raw/belly-fat-workout/metaData.js":return a.e(8501).then(a.bind(a,98501));case"./raw/buying-art-on-the-internet/metaData.js":return a.e(9698).then(a.bind(a,19698));case"./raw/celebrity-life-story/metaData.js":return a.e(1852).then(a.bind(a,61852));case"./raw/celebrity-q-and-a/metaData.js":return a.e(3409).then(a.bind(a,3409));case"./raw/diy-home-office/metaData.js":return a.e(1699).then(a.bind(a,11699));case"./raw/doers-get-more-done/metaData.js":return a.e(680).then(a.bind(a,80680));case"./raw/elegant-travel-itinerary/metaData.js":return a.e(2045).then(a.bind(a,12045));case"./raw/experience-thailand/metaData.js":return a.e(2196).then(a.bind(a,42196));case"./raw/fashion-inspiration/metaData.js":return a.e(8643).then(a.bind(a,58643));case"./raw/fashion-on-the-go/metaData.js":return a.e(8864).then(a.bind(a,58864));case"./raw/fitness-apps-ranked/metaData.js":return a.e(9091).then(a.bind(a,29091));case"./raw/food-and-stuff/metaData.js":return a.e(1618).then(a.bind(a,51618));case"./raw/fresh-and-bright/metaData.js":return a.e(6281).then(a.bind(a,16281));case"./raw/google-music-studio-tour/metaData.js":return a.e(8791).then(a.bind(a,98791));case"./raw/hawaii-travel-packing-list/metaData.js":return a.e(998).then(a.bind(a,70998));case"./raw/honeymooning-in-italy/metaData.js":return a.e(8717).then(a.bind(a,18717));case"./raw/house-hunting/metaData.js":return a.e(9860).then(a.bind(a,89860));case"./raw/how-contact-tracing-works/metaData.js":return a.e(1323).then(a.bind(a,31323));case"./raw/how-video-calls-saved-the-day/metaData.js":return a.e(2853).then(a.bind(a,52853));case"./raw/indoor-garden-oasis/metaData.js":return a.e(9100).then(a.bind(a,49100));case"./raw/kitchen-makeover/metaData.js":return a.e(1637).then(a.bind(a,51637));case"./raw/kitchen-stories/metaData.js":return a.e(6938).then(a.bind(a,16938));case"./raw/laptop-buying-guide/metaData.js":return a.e(2060).then(a.bind(a,2060));case"./raw/los-angeles-city-guide/metaData.js":return a.e(3434).then(a.bind(a,73434));case"./raw/magazine-article/metaData.js":return a.e(5817).then(a.bind(a,65817));case"./raw/modernist-travel-guide/metaData.js":return a.e(2564).then(a.bind(a,92564));case"./raw/new-york-party-round-up/metaData.js":return a.e(3324).then(a.bind(a,23324));case"./raw/no-days-off/metaData.js":return a.e(6489).then(a.bind(a,96489));case"./raw/one-day-city-itinerary/metaData.js":return a.e(8895).then(a.bind(a,48895));case"./raw/pizzas-in-nyc/metaData.js":return a.e(4371).then(a.bind(a,54371));case"./raw/plant-based-dyes/metaData.js":return a.e(4771).then(a.bind(a,74771));case"./raw/pride-month-watchlist/metaData.js":return a.e(6411).then(a.bind(a,66411));case"./raw/rock-music-festival/metaData.js":return a.e(6841).then(a.bind(a,76841));case"./raw/sangria-artichoke/metaData.js":return a.e(6234).then(a.bind(a,86234));case"./raw/self-care-guide/metaData.js":return a.e(1897).then(a.bind(a,81897));case"./raw/series-best-of/metaData.js":return a.e(2793).then(a.bind(a,62793));case"./raw/simple-tech-tutorial/metaData.js":return a.e(1162).then(a.bind(a,91162));case"./raw/skin-care-at-home/metaData.js":return a.e(1722).then(a.bind(a,1722));case"./raw/sleep/metaData.js":return a.e(609).then(a.bind(a,70609));case"./raw/sports-quiz/metaData.js":return a.e(1137).then(a.bind(a,61137));case"./raw/street-style-on-the-go/metaData.js":return a.e(8637).then(a.bind(a,78637));case"./raw/summer-adventure-guide/metaData.js":return a.e(7172).then(a.bind(a,67172));case"./raw/summer-fashion-collection/metaData.js":return a.e(5606).then(a.bind(a,25606));case"./raw/sustainability-tips/metaData.js":return a.e(4772).then(a.bind(a,54772));case"./raw/technology-advice/metaData.js":return a.e(920).then(a.bind(a,50920));case"./raw/tips-for-throwing-an-outdoor-luau/metaData.js":return a.e(4911).then(a.bind(a,64911));case"./raw/tv-show-recap/metaData.js":return a.e(1776).then(a.bind(a,61776));case"./raw/ultimate-comparison/metaData.js":return a.e(9828).then(a.bind(a,89828));case"./raw/vintage-chairs-buying-guide/metaData.js":return a.e(8084).then(a.bind(a,18084));case"./raw/ways-to-eat-avocado/metaData.js":return a.e(8537).then(a.bind(a,28537));case"./raw/weekly-entertainment/metaData.js":return a.e(5341).then(a.bind(a,45341));default:return new Promise((function(t,a){("function"==typeof queueMicrotask?queueMicrotask:setTimeout)(a.bind(null,new Error("Unknown variable dynamic import: "+e)))}))}}(`./raw/${e}/metaData.js`).then((e=>e.default)))))}},54e3:(e,t,a)=>{a.r(t),a.d(t,{getAllTemplates:()=>l,getTemplateMetaData:()=>o.getTemplateMetaData});var n=a(47700),r=a(71135),o=a(74187);const i=(0,n.default)(r.default);async function l(e){let{cdnURL:t}=e;const a=await i(t),n={createdBy:"Google",modified:"2020-04-21"};return a.map(((e,t)=>({id:t+1,...n,...e})))}}}]);